#INFO: **** input file is /home/Yxwxwx/code/dmet/test/entropy/Cr2/dmet_siso.py ****
from pyscf import gto, scf, ao2mo, mcscf, fci, dmrgscf, lib

# from pyscf.csf_fci import csf_solver  # TODO:
from pyscf.mcscf import avas
from pyscf.tools import molden, fcidump
from pyscf.lib import logger, cho_solve
from pyscf.data import nist
import numpy as np
import scipy
from functools import reduce
import os
import tempfile
from liblan.utils.rdiis import tag_rdiis_
import h5py
from pyblock2._pyscf.ao2mo import integrals as itg
from pyblock2.driver.core import DMRGDriver, SymmetryTypes

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ""


def read_cas_info(fname):
    with open(fname, "r") as f1:
        ncasorb, ncaselec = [int(x) for x in f1.readline().split(" ")]
        casorbind = [int(x) for x in f1.readline().split(" ")]
        statelis = [int(x) for x in f1.readline().split(" ")]
    return ncasorb, ncaselec, casorbind, statelis


def sacasscf_dump_chk(solver, sav):
    # saving properties for SISO
    with h5py.File(sav, "w") as fh5:
        fh5["ncore"] = np.asarray(solver.ncore)
        fh5["ncas"] = np.asarray(solver.ncas)
        fh5["nelecas"] = np.asarray(solver.nelecas)
        fh5["mo_coeff"] = solver.mo_coeff
        fh5["rdm1"] = solver.make_rdm1()

        for i in range(len(solver.ci)):
            fh5["ci" + str(i)] = solver.ci[i]
        fh5["e_states"] = solver.e_states


def sacasscf_load_chk(solver, sav):
    with h5py.File(sav, "r") as fh5:
        solver.ncore = fh5["ncore"][()]
        solver.ncas = fh5["ncas"][()]
        solver.nelecas = fh5["nelecas"][:]

        solver.mo_coeff = fh5["mo_coeff"][:]
        rdm1 = fh5["rdm1"][:]
        solver.make_rdm1 = lambda *args: rdm1

        # solver.e_states = fh5["e_states"][:]
        # solver.ci = [fh5["ci" + str(i)][:] for i in range(len(solver.e_states))]
    return solver


def rohf_solve_imp(hcore, eris, nelec, spin, max_mem, dm0=None, verbose=logger.INFO):
    mol = gto.M()
    mol.verbose = verbose
    mol.incore_anyway = True
    mol.nelectron = nelec
    mol.spin = spin

    nao = hcore.shape[0]
    print("nao = ", nao)
    print("nelec = ", mol.nelec)

    mf = scf.rohf.ROHF(mol).x2c()
    mf.max_memory = max_mem
    mf.mo_energy = np.zeros((nao))
    mf.max_cycle = 1000
    mf.diis_space = 8
    mf.init_guess = "1e"
    mf.level_shift = 0.2

    mf.get_hcore = lambda *args: hcore
    mf.get_ovlp = lambda *args: np.eye(nao)
    mf._eri = ao2mo.restore(8, eris, nao)

    if dm0 is None:
        mf.kernel()
    else:
        if dm0.shape != hcore.shape:
            bath_size = hcore.shape[0] - dm0.shape[0]
            dm0 = scipy.linalg.block_diag(
                dm0, np.eye(bath_size) * (nelec - np.trace(dm0)) / bath_size
            )
        mf.kernel(dm0)
    return mf


def sacasscf_solve_imp(
    solver_base, mol, ncasorb, ncaselec, casorbind, statelis, avas=False
):
    solver = mcscf.CASSCF(solver_base, ncasorb, ncaselec)

    if avas:
        mo = casorbind
    else:
        mo = solver.sort_mo(casorbind)
    mcfs = []
    logger.info(solver, "Attempting SA-DMRGSCF with")
    for i in range(len(statelis)):
        if statelis[i] != 0:
            new_mcf = dmrgscf.DMRGCI(mol, maxM=1500, tol=1e-10)
            new_mcf.spin = i
            new_mcf.nroots = statelis[i]
            new_mcf.threads = 16
            new_mcf.memory = int(mol.max_memory / 1000)
            new_mcf.block_extra_keyword = [
                "real_density_matrix",
                "davidson_soft_max_iter 1600",
                "noreorder",
                "cutoff 1E-24",
            ]
            new_mcf.runtimeDir = lib.param.TMPDIR + "/%d" % i
            new_mcf.scratchDirectory = lib.param.TMPDIR + "/%d" % i
            mcfs.append(new_mcf)
            logger.info(
                solver, "%s states with spin multiplicity %s", statelis[i], i + 1
            )

    statetot = sum(statelis)
    mcscf.state_average_mix_(solver, mcfs, np.ones(statetot) / statetot)
    solver.run(mo, verbose=mol.verbose)
    return solver


def lowdin(s):
    """new basis is |mu> c^{lowdin}_{mu i}"""
    e, v = scipy.linalg.eigh(s)
    idx = e > 1e-15
    return np.dot(v[:, idx] / np.sqrt(e[idx]), v[:, idx].conj().T)


def caolo(s):
    return lowdin(s)


def cloao(s):
    return lowdin(s) @ s


def get_dmet_as_props(mf, imp_inds, lo_meth="lowdin", thres=1e-13):
    """
    Returns C(AO->AS), entropy loss, and orbital composition
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)
    env_inds = [x for x in range(s.shape[0]) if x not in imp_inds]

    if mf.mol.spin == 0:
        pass
    else:
        dma, dmb = mf.make_rdm1()

        ldma = reduce(np.dot, (cloao_mat, dma, cloao_mat.conj().T))
        ldmb = reduce(np.dot, (cloao_mat, dmb, cloao_mat.conj().T))

        ldma_env = ldma[env_inds, :][:, env_inds]
        ldmb_env = ldmb[env_inds, :][:, env_inds]

        nat_occa, nat_coeffa = np.linalg.eigh(ldma_env)
        nat_occb, nat_coeffb = np.linalg.eigh(ldmb_env)

        ldmr_env = ldma_env + ldmb_env
        nat_occr, nat_coeffr = np.linalg.eigh(ldmr_env)

        caoas = np.hstack([caolo_mat[:, imp_inds], caolo_mat[:, env_inds] @ nat_coeffr])

        nuu = np.sum([nat_occr < thres])
        ne = np.sum([(nat_occr >= thres) & (nat_occr <= 2 - thres)])
        nuo = np.sum([nat_occr > 2 - thres])

        asorbs = (nuu, ne, nuo)
        print("caoas.shape = ", caoas.shape)
        print("asorbs = ", asorbs)

        nat_occa = nat_occa[nat_occa > thres]
        nat_occb = nat_occb[nat_occb > thres]
        nat_occr = nat_occr[nat_occr > thres]

        ent = -np.sum(nat_occa * np.log(nat_occa)) - np.sum(nat_occb * np.log(nat_occb))
        entr = -2 * np.sum(nat_occr / 2 * np.log(nat_occr / 2))

        return caoas, entr - ent, asorbs


def get_dmet_imp_ldm(mf, imp_inds, lo_meth="lowdin"):
    """
    Returns better initial guess than '1e' for impurity
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)

    dma, dmb = mf.make_rdm1()

    ldm = reduce(np.dot, (cloao_mat, (dma + dmb), cloao_mat.conj().T))[imp_inds, :][
        :, imp_inds
    ]
    return ldm


def get_as_1e_ints(mf, caoas, asorbs):
    # hcore from mf
    hcore = mf.get_hcore()

    # HF J/K from env UO
    uos = hcore.shape[0] - asorbs[-1]
    dm_uo = caoas[:, uos:] @ caoas[:, uos:].conj().T * 2
    vj, vk = mf.get_jk(dm=dm_uo)

    fock = hcore + vj - 0.5 * vk

    nimp = hcore.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    asints1e = reduce(np.dot, (caoas[:, act_inds].conj().T, fock, caoas[:, act_inds]))
    return asints1e


def get_as_2e_ints(mf, caoas, asorbs):
    nimp = caoas.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    if mf._eri is not None:
        asints2e = ao2mo.full(mf._eri, caoas[:, act_inds])
    else:
        asints2e = ao2mo.full(mf.mol, caoas[:, act_inds])

    return asints2e


def get_bp_hso2e(mol, dm0):
    hso2e = mol.intor("int2e_p1vxp1", 3).reshape(3, mol.nao, mol.nao, mol.nao, mol.nao)
    vj = np.einsum("yijkl,lk->yij", hso2e, dm0, optimize=True)
    vk = np.einsum("yijkl,jk->yil", hso2e, dm0, optimize=True)
    vk += np.einsum("yijkl,li->ykj", hso2e, dm0, optimize=True)
    return vj, vk


def get_bp_hso2e_amfi(mol, dm0):
    """atomic-mean-field approximation"""
    ao_loc = mol.ao_loc_nr()
    nao = ao_loc[-1]
    vj = np.zeros((3, nao, nao))
    vk = np.zeros((3, nao, nao))
    import copy

    atom = copy.copy(mol)
    aoslice = mol.aoslice_by_atom(ao_loc)
    for ia in range(mol.natm):
        b0, b1, p0, p1 = aoslice[ia]
        atom._bas = mol._bas[b0:b1]
        vj1, vk1 = get_bp_hso2e(atom, dm0[p0:p1, p0:p1])
        vj[:, p0:p1, p0:p1] = vj1
        vk[:, p0:p1, p0:p1] = vk1
    return vj, vk


mol = gto.M(
    atom="""
  Cr  -1.35424450239280      0.00748246778796     -0.00087595645706 
  Cr   1.35423764131845      0.00747803055009     -0.00087750355078 
  O   -0.00000294430974     -0.13734660180713      1.46342333077295 
  O   -0.00000064383679      1.35420350893235     -0.59959802230353 
  O   -0.00000516089286     -1.18217624605433     -0.86562559483160 
  H   -0.00000065463206      0.52075486357441      2.16950923336362 
  H    0.00000446473449      1.64878725909317     -1.51878718478551 
  H   -0.00000926896581     -2.12530440890393     -0.66035454411104 
  N   -2.68346617865321     -1.45853826988486      0.70650005032200 
  C   -2.01822727274717     -2.52465540625361      1.50592497177303 
  C   -3.25911308583331     -2.04955652529081     -0.54278797058362 
  C   -3.74827281074952     -0.80152247456954      1.54881850901734 
  H   -1.56748557922213     -2.08271923805020      2.39129571316802 
  H   -1.24243826043958     -2.99862043316970      0.90648770606852 
  H   -2.74840997387176     -3.28356694917433      1.79607780436372 
  H   -2.46291984415168     -2.62337513441757     -1.02093781896581 
  H   -4.07044743926176     -2.74311239041734     -0.30244269679464 
  H   -4.65448299937734     -0.70680487372819      0.95372217138132 
  H   -3.99500774926338     -1.44490669699879      2.39456976728496 
  N   -2.69755450329625      1.34136962911627      0.91026422821942 
  N   -2.69230526823111      0.11718842081111     -1.61665366474216 
  C   -3.74849616889413     -0.94865197019848     -1.46353644818261 
  C   -3.27063403754831      0.54952804549553      2.04434124343513 
  N    2.68346715675698     -1.45854069314242      0.70650003406182 
  N    2.69754925024949      1.34136611134027      0.91026654207433 
  N    2.69230403104748      0.11718547928447     -1.61665262689138 
  C   -2.04437616396754      2.57225987860668      1.43663608392829 
  C   -3.76194284730143      1.73300596201565     -0.08408294061084 
  C   -2.03228717940052     -0.03618283988186     -2.94309134997238 
  C   -3.27725483448617      1.49033558111027     -1.50018850579138 
  H   -4.65645471974087     -0.48734410738601     -1.07991760798513 
  H   -3.99664215151405     -1.36168809799084     -2.44226987052617 
  H   -2.47549715669751      0.42734931293811      2.78234874695929
  H   -4.08755174458298      1.09782217898898      2.52290059499979 
  C    2.01823189480386     -2.52466013170271      1.50592432110894 
  C    3.25911692194754     -2.04955805616288     -0.54278693277931 
  C    3.74827350165531     -0.80152393465555      1.54881874867098 
  C    2.04437438874437      2.57225673960399      1.43664047370217 
  C    3.27063260709400      0.54952529364165      2.04434238389264 
  C    3.76193758070494      1.73300459398023     -0.08408076294943 
  C    2.03228955044192     -0.03618719210796     -2.94309210428304 
  C    3.27724995734855      1.49033424715459     -1.50018655506513 
  C    3.74849826690828     -0.94865216224951     -1.46353430216360 
  H   -1.59575047514265      3.12234814848417      0.61291937461478 
  H   -1.26826445350661      2.29664085726858      2.14911186944439 
  H   -2.78162146845096      3.19639860592609      1.94666596437982 
  H   -4.66409353100933      1.16248658840109      0.12799867351868 
  H   -4.01827672254151      2.78498397644774      0.04889460213876 
  H   -1.57918667365396     -1.02245710553356     -3.00817218975222 
  H   -1.25884477264019      0.72228568282228     -3.05436504943444 
  H   -2.76640836866444      0.09214024180044     -3.74175962042542 
  H   -2.48702512015610      2.19699107950093     -1.76109217570029 
  H   -4.09281437247312      1.62358792037224     -2.21722220410103 
  H    1.56748953447666     -2.08272559171093      2.39129530400812 
  H    1.24244410784823     -2.99862712397942      0.90648689200259 
  H    2.74841706997603     -3.28356963121360      1.79607623870542 
  H    2.46292569126273     -2.62337849835601     -1.02093792725634 
  H    4.07045302720973     -2.74311163538248     -0.30244048876426 
  H    4.65448346115229     -0.70680401028077      0.95372228032966 
  H    3.99501075900995     -1.44490851377397      2.39456915731191 
  H    1.59574566134859      3.12234477429960      0.61292534612400 
  H    1.26826627874473      2.29663922181641      2.14912084106002 
  H    2.78162298309563      3.19639495340303      1.94666639317082 
  H    2.47549786087627      0.42734489313183      2.78235173581885 
  H    4.08755032211489      1.09782125435258      2.52289983946985 
  H    4.66408898713428      1.16248602569396      0.12799994420443 
  H    4.01827034865908      2.78498276510688      0.04889794787615 
  H    1.57919077794174     -1.02246221135116     -3.00817477609090 
  H    1.25884680990156      0.72228058908288     -3.05436842804018 
  H    2.76641276635084      0.09213636615134     -3.74175868249209 
  H    2.48701845128170      2.19698799301717     -1.76108932637069 
  H    4.09280944357511      1.62358920085783     -2.21721985740965 
  H    4.65645441062758     -0.48734137231740     -1.07991321549768 
  H    3.99664791915730     -1.36168656486501     -2.44226768508526 
        """,
    basis={
        "default": "def2tzvp",
        "C": "6-31G*",
        "H": "6-31G*",
        "N": "6-31G*",
    },
    symmetry=0,
    spin=6,
    charge=+3,
    verbose=4,
    max_memory=200000,
)

mf = scf.rohf.ROHF(mol).x2c()
mf.max_cycle = 100
title = "Cr2O4"
imp_inds = mol.search_ao_label(["Cr *", "O *"])
mf.chkfile = title + "_rohf.chk"
mf.init_guess = "atom"
mf.level_shift = 0.2
if os.path.isfile(title + "_rohf.chk"):
    mf.init_guess = "chk"
    mf.level_shift = 0.0
mf = tag_rdiis_(mf=mf, imp_inds=imp_inds)
mf.kernel()


print("nao = ", mol.nao_nr())
print("nelec = ", mol.nelec)


print("imp_inds.shape", imp_inds.shape)

as_fname = title + "_as_chk.h5"
if not os.path.isfile(as_fname):
    # AS general info
    caoas, ent, asorbs = get_dmet_as_props(mf, imp_inds, thres=1e-13)
    # AS hcore + j/k
    as1e = get_as_1e_ints(mf, caoas, asorbs)
    # AS ERIs
    as2e = get_as_2e_ints(mf, caoas, asorbs)

    print(f"Entanglement S: {ent:.3f}")

    with h5py.File(as_fname, "w") as fh5:
        fh5["caoas"] = caoas
        fh5["ent"] = ent
        fh5["asorbs"] = asorbs
        fh5["1e"] = as1e
        fh5["2e"] = as2e
else:
    fh5 = h5py.File(as_fname, "r")
    caoas = fh5["caoas"][:]
    ent = fh5["ent"][()]
    asorbs = fh5["asorbs"][:]
    as1e = fh5["1e"][:]
    as2e = fh5["2e"][:]
    fh5.close()

nimp = caoas.shape[0] - np.sum(asorbs)
print("nimp = ", nimp)
act_inds = [
    *list(range(nimp)),
    *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
]

print("act_inds = ", act_inds)

nelec = int(mf.mol.nelectron - asorbs[-1] * 2)
ldm = get_dmet_imp_ldm(mf, imp_inds)
solver_base = rohf_solve_imp(as1e, as2e, nelec, mf.mol.spin, mf.max_memory, dm0=ldm)

with open(title + "_imp_rohf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver_base.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

# avas
# ao_labels = ["Co 3d"]
# ncasorb, ncaselec, casorbind = avas.avas(solver_base, ao_labels, canonicalize=False)

# ncasorb = 5
# ncaselec = 7
# casorbind = [40, 41, 55, 56, 57]  # F-style

caschk_fname = title + "_imp_cas_chk.h5"


if not os.path.isfile(caschk_fname):
    casinfo_fname = title + "_cas_info"
    if not os.path.isfile(casinfo_fname):
        print("Failed to read saved CAS briefings.")
        exit()
    ncasorb, ncaselec, casorbind, statelis = read_cas_info(casinfo_fname)

    solver = sacasscf_solve_imp(
        solver_base, mf.mol, ncasorb, ncaselec, casorbind, statelis=statelis
    )
    sacasscf_dump_chk(solver, caschk_fname)

else:
    solver = sacasscf_load_chk(lib.StreamObject(), caschk_fname)


with open(title + "_imp_casscf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

huge_casorbind = [
    73,
    78,
    79,
    100,
    101,
    102,
    107,
    108,
    109,
    130,
    131,
    132,
    133,
    134,
    135,
    136,
    137,
    138,
    139,
]
if len(huge_casorbind) != 19:
    exit()

mc = mcscf.CASSCF(solver_base, ncas=19, nelecas=24)
mc.mo_coeff = mc.sort_mo(huge_casorbind, solver.mo_coeff)

bond_dims = [250] * 4 + [500] * 4 + [2000]
noises = [1e-4] * 4 + [1e-5] * 4 + [0]
thrds = [1e-10] * 8
ncas = 19
n_elec = 24
spin = 6
ecore = mc.get_h1eff()[1]
h1e = mc.get_h1eff()[0]
g2e = mc.get_h2eff()
orb_sym = [0] * ncas
# ncas, n_elec, spin, ecore, h1e, g2e, orb_sym = itg.get_rhf_integrals(
#     mf, ncore=0, ncas=None, g2e_symm=8
# )
driver = DMRGDriver(
    scratch="./tmp",
    symm_type=SymmetryTypes.SZ,
    n_threads=32,
    stack_mem=int(200 * 1024**3),
)
driver.initialize_system(n_sites=ncas, n_elec=n_elec, spin=spin, orb_sym=orb_sym)

mpo = driver.get_qc_mpo(h1e=h1e, g2e=g2e, ecore=ecore, iprint=0)
ket = driver.get_random_mps(tag="GS", bond_dim=250, nroots=1)
energy = driver.dmrg(
    mpo, ket, n_sweeps=20, bond_dims=bond_dims, noises=noises, thrds=thrds, iprint=1
)
print("DMRG energy = %20.15f" % energy)

ordm1 = driver.get_orbital_entropies(ket, orb_type=1)
ordm2 = driver.get_orbital_entropies(ket, orb_type=2)
minfo = 0.5 * (ordm1[:, None] + ordm1[None, :] - ordm2) * (1 - np.identity(len(ordm1)))

with h5py.File("minfo_data.h5", "w") as f:
    f.create_dataset("minfo", data=minfo)
    f.create_dataset("ordm1", data=ordm1)
    f.create_dataset("ordm2", data=ordm2)

    # 可选：写入注释
    f.attrs["description"] = (
        "Mutual information matrix computed from 1-RDM and 2-RDM orbital entropies."
    )
    f.attrs["formula"] = (
        "minfo = 0.5 * (ordm1[:, None] + ordm1[None, :] - ordm2) * (1 - I)"
    )

print("已保存为 minfo_data.h5")

import matplotlib.pyplot as plt

if not os.path.exists("minfo_data.h5"):
    print("minfo_data.h5 not found. Please run the DMRG calculation first.")
    exit()

with h5py.File("minfo_data.h5", "r") as f:
    minfo = f["minfo"][:]
    # ordm1 = f["ordm1"][:]   # 可选
    # ordm2 = f["ordm2"][:]   # 可选

fig, ax = plt.subplots(figsize=(6, 6))  # 图像尺寸可调整
cax = ax.imshow(minfo, cmap="ocean_r")  # 使用你原来的颜色风格

# 添加 colorbar
cbar = fig.colorbar(cax, ax=ax, fraction=0.046, pad=0.04)
cbar.set_label("Mutual Information", fontsize=10)

# 设置坐标轴刻度为 1~N（从1开始）
n = minfo.shape[0]
ax.set_xticks(np.arange(n))
ax.set_yticks(np.arange(n))
ax.set_xticklabels(np.arange(1, n + 1))
ax.set_yticklabels(np.arange(1, n + 1))
ax.tick_params(length=0, labelsize=8)

# 添加细网格线
ax.set_xticks(np.arange(-0.5, n, 1), minor=True)
ax.set_yticks(np.arange(-0.5, n, 1), minor=True)
ax.grid(which="minor", color="gray", linestyle="-", linewidth=0.3)
ax.tick_params(which="minor", bottom=False, left=False)

# 保持正方形比例
ax.set_aspect("equal")

# 保存图片
plt.tight_layout()
plt.savefig("minfo_matrix_oceanr.png", dpi=600)
plt.close()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='cu09', release='5.15.0-133-generic', version='#144-Ubuntu SMP Fri Feb 7 20:47:38 UTC 2025', machine='x86_64')  Threads 32
Python 3.11.13 (main, Jun  5 2025, 13:12:00) [GCC 11.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Wed Jul 30 14:52:26 2025
PySCF version 2.9.0
PySCF path  /home/Yxwxwx/.conda/envs/pyscf_311/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 74
[INPUT] num. electrons = 264
[INPUT] charge = 3
[INPUT] spin (= nelec alpha-beta = 2S) = 6
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Cr    -1.354244502393   0.007482467788  -0.000875956457 AA   -2.559151215220   0.014139814855  -0.001655317801 Bohr   0.0
[INPUT]  2 Cr     1.354237641318   0.007478030550  -0.000877503551 AA    2.559138249669   0.014131429691  -0.001658241384 Bohr   0.0
[INPUT]  3 O     -0.000002944310  -0.137346601807   1.463423330773 AA   -0.000005563939  -0.259547461555   2.765469299460 Bohr   0.0
[INPUT]  4 O     -0.000000643837   1.354203508932  -0.599598022304 AA   -0.000001216675   2.559073748807  -1.133076046985 Bohr   0.0
[INPUT]  5 O     -0.000005160893  -1.182176246054  -0.865625594832 AA   -0.000009752674  -2.233989336009  -1.635795300645 Bohr   0.0
[INPUT]  6 H     -0.000000654632   0.520754863574   2.169509233364 AA   -0.000001237075   0.984084070191   4.099778275772 Bohr   0.0
[INPUT]  7 H      0.000004464734   1.648787259093  -1.518787184786 AA    0.000008437125   3.115756357358  -2.870091820744 Bohr   0.0
[INPUT]  8 H     -0.000009268966  -2.125304408904  -0.660354544111 AA   -0.000017515807  -4.016243264159  -1.247889233482 Bohr   0.0
[INPUT]  9 N     -2.683466178653  -1.458538269885   0.706500050322 AA   -5.071016142188  -2.756237872279   1.335091602100 Bohr   0.0
[INPUT] 10 C     -2.018227272747  -2.524655406254   1.505924971773 AA   -3.813896802620  -4.770907276722   2.845785760794 Bohr   0.0
[INPUT] 11 C     -3.259113085833  -2.049556525291  -0.542787970584 AA   -6.158831141211  -3.873100509615  -1.025720608112 Bohr   0.0
[INPUT] 12 C     -3.748272810750  -0.801522474570   1.548818509017 AA   -7.083209052470  -1.514657959620   2.926842798700 Bohr   0.0
[INPUT] 13 H     -1.567485579222  -2.082719238050   2.391295713168 AA   -2.962118448935  -3.935768954278   4.518893980734 Bohr   0.0
[INPUT] 14 H     -1.242438260440  -2.998620433170   0.906487706069 AA   -2.347868038912  -5.666571370215   1.713013499755 Bohr   0.0
[INPUT] 15 H     -2.748409973872  -3.283566949174   1.796077804364 AA   -5.193742128641  -6.205042245613   3.394095148658 Bohr   0.0
[INPUT] 16 H     -2.462919844152  -2.623375134418  -1.020937818966 AA   -4.654243972203  -4.957460526043  -1.929292868056 Bohr   0.0
[INPUT] 17 H     -4.070447439262  -2.743112390417  -0.302442696795 AA   -7.692030864642  -5.183731146790  -0.571533865317 Bohr   0.0
[INPUT] 18 H     -4.654482999377  -0.706804873728   0.953722171381 AA   -8.795698120267  -1.335667634854   1.802273702836 Bohr   0.0
[INPUT] 19 H     -3.995007749263  -1.444906696999   2.394569767285 AA   -7.549470511623  -2.730477932878   4.525081046332 Bohr   0.0
[INPUT] 20 N     -2.697554503296   1.341369629116   0.910264228219 AA   -5.097639217317   2.534821230839   1.720150092323 Bohr   0.0
[INPUT] 21 N     -2.692305268231   0.117188420811  -1.616653664742 AA   -5.087719600680   0.221454020303  -3.055032664637 Bohr   0.0
[INPUT] 22 C     -3.748496168894  -0.948651970198  -1.463536448183 AA   -7.083631138191  -1.792692411204  -2.765683060384 Bohr   0.0
[INPUT] 23 C     -3.270634037548   0.549528045496   2.044341243435 AA   -6.180602584647   1.038457503754   3.863245055245 Bohr   0.0
[INPUT] 24 N      2.683467156757  -1.458540693142   0.706500034062 AA    5.071017990536  -2.756242451572   1.335091571373 Bohr   0.0
[INPUT] 25 N      2.697549250249   1.341366111340   0.910266542074 AA    5.097629290497   2.534814583206   1.720154464875 Bohr   0.0
[INPUT] 26 N      2.692304031047   0.117185479284  -1.616652626891 AA    5.087717262742   0.221448461624  -3.055030703383 Bohr   0.0
[INPUT] 27 C     -2.044376163968   2.572259878607   1.436636083928 AA   -3.863311045488   4.860866691774   2.714848739292 Bohr   0.0
[INPUT] 28 C     -3.761942847301   1.733005962016  -0.084082940611 AA   -7.109041677666   3.274906640448  -0.158893729503 Bohr   0.0
[INPUT] 29 C     -2.032287179401  -0.036182839882  -2.943091349972 AA   -3.840466175532  -0.068375657786  -5.561636611024 Bohr   0.0
[INPUT] 30 C     -3.277254834486   1.490335581110  -1.500188505791 AA   -6.193114077586   2.816326081993  -2.834945411166 Bohr   0.0
[INPUT] 31 H     -4.656454719741  -0.487344107386  -1.079917607985 AA   -8.799424131749  -0.920946891380  -2.040748516187 Bohr   0.0
[INPUT] 32 H     -3.996642151514  -1.361688097991  -2.442269870526 AA   -7.552559084254  -2.573217572283  -4.615221177571 Bohr   0.0
[INPUT] 33 H     -2.475497156698   0.427349312938   2.782348746959 AA   -4.678011648298   0.807573160974   5.257877114780 Bohr   0.0
[INPUT] 34 H     -4.087551744583   1.097822178989   2.522900595000 AA   -7.724353317250   2.074583251762   4.767591164052 Bohr   0.0
[INPUT] 35 C      2.018231894804  -2.524660131703   1.505924321109 AA    3.813905537041  -4.770916206526   2.845784531217 Bohr   0.0
[INPUT] 36 C      3.259116921948  -2.049558056163  -0.542786932779 AA    6.158838390416  -3.873103402544  -1.025718646946 Bohr   0.0
[INPUT] 37 C      3.748273501655  -0.801523934656   1.548818748671 AA    7.083210358093  -1.514660718783   2.926843251580 Bohr   0.0
[INPUT] 38 C      2.044374388744   2.572256739604   1.436640473702 AA    3.863307690802   4.860860759918   2.714857034763 Bohr   0.0
[INPUT] 39 C      3.270632607094   0.549525293642   2.044342383893 AA    6.180599881480   1.038452303504   3.863247210398 Bohr   0.0
[INPUT] 40 C      3.761937580705   1.733004593980  -0.084080762949 AA    7.109031725241   3.274904055236  -0.158889614319 Bohr   0.0
[INPUT] 41 C      2.032289550442  -0.036187192108  -2.943092104283 AA    3.840470656151  -0.068383882301  -5.561638036465 Bohr   0.0
[INPUT] 42 C      3.277249957349   1.490334247155  -1.500186555065 AA    6.193104861131   2.816323561182  -2.834941724828 Bohr   0.0
[INPUT] 43 C      3.748498266908  -0.948652162250  -1.463534302164 AA    7.083635102863  -1.792692774128  -2.765679004996 Bohr   0.0
[INPUT] 44 H     -1.595750475143   3.122348148484   0.612919374615 AA   -3.015531361164   5.900382866178   1.158249754462 Bohr   0.0
[INPUT] 45 H     -1.268264453507   2.296640857269   2.149111869444 AA   -2.396672470649   4.340022226724   4.061232844302 Bohr   0.0
[INPUT] 46 H     -2.781621468451   3.196398605926   1.946665964380 AA   -5.256502757583   6.040317950142   3.678665528690 Bohr   0.0
[INPUT] 47 H     -4.664093531009   1.162486588401   0.127998673519 AA   -8.813859392963   2.196781275558   0.241882437258 Bohr   0.0
[INPUT] 48 H     -4.018276722542   2.784983976448   0.048894602139 AA   -7.593442498318   5.262856976788   0.092397407012 Bohr   0.0
[INPUT] 49 H     -1.579186673654  -1.022457105534  -3.008172189752 AA   -2.984230312769  -1.932163903574  -5.684621574165 Bohr   0.0
[INPUT] 50 H     -1.258844772640   0.722285682822  -3.054365049434 AA   -2.378871853630   1.364922124229  -5.771913427875 Bohr   0.0
[INPUT] 51 H     -2.766408368664   0.092140241800  -3.741759620425 AA   -5.227754165481   0.174119822054  -7.070900906561 Bohr   0.0
[INPUT] 52 H     -2.487025120156   2.196991079501  -1.761092175700 AA   -4.699796342009   4.151711438369  -3.327981892188 Bohr   0.0
[INPUT] 53 H     -4.092814372473   1.623587920372  -2.217222204101 AA   -7.734298242658   3.068136508656  -4.189942723055 Bohr   0.0
[INPUT] 54 H      1.567489534477  -2.082725591711   2.391295304008 AA    2.962125923283  -3.935780960956   4.518893207534 Bohr   0.0
[INPUT] 55 H      1.242444107848  -2.998627123979   0.906486892003 AA    2.347879088913  -5.666584014013   1.713011961393 Bohr   0.0
[INPUT] 56 H      2.748417069976  -3.283569631214   1.796076238705 AA    5.193755538334  -6.205047313933   3.394092189992 Bohr   0.0
[INPUT] 57 H      2.462925691263  -2.623378498356  -1.020937927256 AA    4.654255021642  -4.957466882966  -1.929293072696 Bohr   0.0
[INPUT] 58 H      4.070453027210  -2.743111635382  -0.302440488764 AA    7.692041424333  -5.183729719981  -0.571529692744 Bohr   0.0
[INPUT] 59 H      4.654483461152  -0.706804010281   0.953722280330 AA    8.795698992895  -1.335666003175   1.802273908719 Bohr   0.0
[INPUT] 60 H      3.995010759010  -1.444908513774   2.394569157312 AA    7.549476199220  -2.730481366085   4.525079893650 Bohr   0.0
[INPUT] 61 H      1.595745661349   3.122344774300   0.612925346124 AA    3.015522264412   5.900376489893   1.158261038979 Bohr   0.0
[INPUT] 62 H      1.268266278745   2.296639221816   2.149120841060 AA    2.396675919849   4.340019136167   4.061249798198 Bohr   0.0
[INPUT] 63 H      2.781622983096   3.196394953403   1.946666393171 AA    5.256505619846   6.040311047874   3.678666338988 Bohr   0.0
[INPUT] 64 H      2.475497860876   0.427344893132   2.782351735819 AA    4.678012979003   0.807564808751   5.257882762906 Bohr   0.0
[INPUT] 65 H      4.087550322115   1.097821254353   2.522899839470 AA    7.724350629175   2.074581504453   4.767589736307 Bohr   0.0
[INPUT] 66 H      4.664088987134   1.162486025694   0.127999944204 AA    8.813850806284   2.196780212196   0.241884838506 Bohr   0.0
[INPUT] 67 H      4.018270348659   2.784982765107   0.048897947876 AA    7.593430453426   5.262854687686   0.092403729539 Bohr   0.0
[INPUT] 68 H      1.579190777942  -1.022462211351  -3.008174776091 AA    2.984238068749  -1.932173552171  -5.684626461637 Bohr   0.0
[INPUT] 69 H      1.258846809902   0.722280589083  -3.054368428040 AA    2.378875703496   1.364912498456  -5.771919812514 Bohr   0.0
[INPUT] 70 H      2.766412766351   0.092136366151  -3.741758682492 AA    5.227762475903   0.174112498139  -7.070899134123 Bohr   0.0
[INPUT] 71 H      2.487018451282   2.196987993017  -1.761089326371 AA    4.699783739662   4.151705605760  -3.327976507735 Bohr   0.0
[INPUT] 72 H      4.092809443575   1.623589200858  -2.217219857410 AA    7.734288928390   3.068138928423  -4.189938288451 Bohr   0.0
[INPUT] 73 H      4.656454410628  -0.487341372317  -1.079913215498 AA    8.799423547609  -0.920941722850  -2.040740215589 Bohr   0.0
[INPUT] 74 H      3.996647919157  -1.361686564865  -2.442267685085 AA    7.552569983520  -2.573214675095  -4.615217047687 Bohr   0.0

nuclear repulsion = 4971.98175241531
number of shells = 297
number of NR pGTOs = 1150
number of NR cGTOs = 609
basis = {'default': 'def2tzvp', 'C': '6-31G*', 'H': '6-31G*', 'N': '6-31G*'}
ecp = {}
CPU time:         7.50


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = chk
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'liblan.utils.rdiis.tag_rdiis_.<locals>.RDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = Cr2O4_rohf.chk
max_memory 200000 MB (current use 143 MB)
num. doubly occ = 129  num. singly occ = 6


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -3356.40543035201
  HOMO = -0.503476636348659  LUMO = -0.187926369667279
cycle= 1 E= -3356.40543035156  delta_E= 4.51e-10  |g|= 2.95e-05  |ddm|= 7.05e-05
  HOMO = -0.50348009751801  LUMO = -0.187926443826429
Extra cycle  E= -3356.40543035077  delta_E= 7.93e-10  |g|= 3.95e-05  |ddm|= 9.45e-05
converged SCF energy = -3356.40543035077
nao =  609
nelec =  (135, 129)
imp_inds.shape (183,)
nimp =  183
act_inds =  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608]
nao =  318
nelec =  (135, 129)


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = 1e
damping factor = 0
level_shift factor = 0.2
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1000
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /tmp/tmpfo30r66p
max_memory 200000 MB (current use 169495 MB)
num. doubly occ = 129  num. singly occ = 6


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -8025.93339115667

WARN: HOMO 0.485435568751735 >= LUMO 0.419196086215746

cycle= 1 E= -8303.9802157819  delta_E= -278  |g|= 6.49  |ddm|= 16.2

WARN: HOMO -0.790005710368059 >= LUMO -0.857704401407188

cycle= 2 E= -8091.85337434562  delta_E=  212  |g|= 30.1  |ddm|= 10.5

WARN: HOMO -0.558442415802777 >= LUMO -0.663468720495818

cycle= 3 E= -8225.22112678563  delta_E= -133  |g|= 21.2  |ddm|= 5.41

WARN: HOMO -0.558628396661271 >= LUMO -0.691412249398844

cycle= 4 E= -8273.38966134011  delta_E= -48.2  |g|= 15.5  |ddm|= 4.27

WARN: HOMO -0.540018257683821 >= LUMO -0.664716825588767

cycle= 5 E= -8294.90480608141  delta_E= -21.5  |g|= 11.8  |ddm|= 2.96
  HOMO = -0.557950468020468  LUMO = -0.485178705740202
cycle= 6 E= -8312.18351570409  delta_E= -17.3  |g|= 8.29  |ddm|=  2.5
  HOMO = -0.562709259202087  LUMO = -0.203800990968878
cycle= 7 E= -8323.58861681349  delta_E= -11.4  |g|= 3.74  |ddm|= 2.54

WARN: HOMO 0.077082094242387 >= LUMO -0.293142770209521

cycle= 8 E= -8321.1183991275  delta_E= 2.47  |g|= 4.07  |ddm|= 3.73

WARN: HOMO -0.0927653109448547 >= LUMO -0.550847847826547

cycle= 9 E= -8325.99422846833  delta_E= -4.88  |g|= 2.59  |ddm|= 3.69

WARN: HOMO 0.133059283305971 >= LUMO -0.40604350135086

cycle= 10 E= -8325.05516528511  delta_E= 0.939  |g|= 2.71  |ddm|= 2.96

WARN: HOMO -0.169910987480062 >= LUMO -0.459480540050299

cycle= 11 E= -8326.15604282203  delta_E= -1.1  |g|= 2.34  |ddm|= 3.15

WARN: HOMO 0.0922076674509208 >= LUMO -0.408161856253149

cycle= 12 E= -8324.84266250658  delta_E= 1.31  |g|=  2.7  |ddm|= 3.15

WARN: HOMO -0.156421768196047 >= LUMO -0.461409356511699

cycle= 13 E= -8326.33951985368  delta_E= -1.5  |g|= 2.18  |ddm|= 3.13

WARN: HOMO -0.0805304362307159 >= LUMO -0.388821490097597

cycle= 14 E= -8326.29015678862  delta_E= 0.0494  |g|= 2.16  |ddm|=  2.8

WARN: HOMO 0.107768739859753 >= LUMO -0.342422721906691

cycle= 15 E= -8324.65918295646  delta_E= 1.63  |g|= 2.77  |ddm|= 3.15

WARN: HOMO 0.00715899330046786 >= LUMO -0.422453217467113

cycle= 16 E= -8324.80217127989  delta_E= -0.143  |g|= 2.66  |ddm|= 3.12

WARN: HOMO 0.00250694480928906 >= LUMO -0.298921009522882

cycle= 17 E= -8324.69151862987  delta_E= 0.111  |g|=  2.8  |ddm|= 3.12

WARN: HOMO -0.00518227414384727 >= LUMO -0.422626938196387

cycle= 18 E= -8325.02181933527  delta_E= -0.33  |g|= 2.58  |ddm|= 3.11

WARN: HOMO -0.103937961038075 >= LUMO -0.335366399957085

cycle= 19 E= -8326.33711212403  delta_E= -1.32  |g|= 2.09  |ddm|= 3.06

WARN: HOMO -0.0735444631345613 >= LUMO -0.413943111726719

cycle= 20 E= -8326.44141428012  delta_E= -0.104  |g|= 2.05  |ddm|= 2.81

WARN: HOMO -0.0804307777254372 >= LUMO -0.24375770911864

cycle= 21 E= -8326.37935498694  delta_E= 0.0621  |g|= 2.11  |ddm|= 2.79

WARN: HOMO -0.0811271497999076 >= LUMO -0.32467217218096

cycle= 22 E= -8327.14815363742  delta_E= -0.769  |g|= 1.52  |ddm|= 2.61

WARN: HOMO -0.0549610871519228 >= LUMO -0.292344369647912

cycle= 23 E= -8327.09123934385  delta_E= 0.0569  |g|= 1.68  |ddm|= 2.38

WARN: HOMO -0.0918144533821422 >= LUMO -0.310565626346157

cycle= 24 E= -8327.25913310482  delta_E= -0.168  |g|= 1.46  |ddm|= 2.39

WARN: HOMO -0.0604333456187208 >= LUMO -0.299670652478314

cycle= 25 E= -8327.56704005767  delta_E= -0.308  |g|= 0.948  |ddm|= 2.28

WARN: HOMO -0.177976289405936 >= LUMO -0.337015557430337

cycle= 26 E= -8327.77352324036  delta_E= -0.206  |g|= 0.926  |ddm|= 1.88

WARN: HOMO -0.134826918835265 >= LUMO -0.331913132851827

cycle= 27 E= -8327.76204992232  delta_E= 0.0115  |g|=  1.1  |ddm|=    2

WARN: HOMO -0.0358315284639303 >= LUMO -0.380549811112827

cycle= 28 E= -8326.6016652231  delta_E= 1.16  |g|= 1.95  |ddm|= 2.41

WARN: HOMO 0.000866140366500902 >= LUMO -0.356010019596233

cycle= 29 E= -8326.7060883811  delta_E= -0.104  |g|=  1.9  |ddm|= 2.73

WARN: HOMO -0.0328012928085062 >= LUMO -0.38178725605528

cycle= 30 E= -8327.06388054011  delta_E= -0.358  |g|= 1.59  |ddm|= 2.56

WARN: HOMO 0.00613169541240001 >= LUMO -0.365803626332626

cycle= 31 E= -8327.08523280164  delta_E= -0.0214  |g|= 1.62  |ddm|= 2.53

WARN: HOMO -0.0223692379127572 >= LUMO -0.366222930132979

cycle= 32 E= -8327.24865416557  delta_E= -0.163  |g|= 1.38  |ddm|= 2.44

WARN: HOMO 0.0231244654388555 >= LUMO -0.359474102695303

cycle= 33 E= -8327.0714874319  delta_E= 0.177  |g|= 1.62  |ddm|= 2.61

WARN: HOMO -0.00515933504307127 >= LUMO -0.359669350237108

cycle= 34 E= -8327.29593814999  delta_E= -0.224  |g|= 1.24  |ddm|= 2.15

WARN: HOMO -0.00153936568350896 >= LUMO -0.392153575793307

cycle= 35 E= -8327.46222490245  delta_E= -0.166  |g|= 1.24  |ddm|=  2.3

WARN: HOMO -0.107705958017519 >= LUMO -0.302412648776466

cycle= 36 E= -8327.89784573562  delta_E= -0.436  |g|= 0.52  |ddm|= 1.85
  HOMO = -0.25211315393854  LUMO = -0.147757288879433
cycle= 37 E= -8327.86670163652  delta_E= 0.0311  |g|= 0.809  |ddm|= 0.553

WARN: HOMO -0.0878414542325348 >= LUMO -0.299064874937908

cycle= 38 E= -8327.76599784052  delta_E= 0.101  |g|= 1.07  |ddm|= 1.98

WARN: HOMO 0.0178620973855011 >= LUMO -0.409834388342326

cycle= 39 E= -8326.85553243816  delta_E= 0.91  |g|= 1.75  |ddm|= 2.24

WARN: HOMO 0.0044516715927074 >= LUMO -0.416641901261648

cycle= 40 E= -8326.70421153655  delta_E= 0.151  |g|= 1.92  |ddm|= 2.76

WARN: HOMO 0.0240956502309702 >= LUMO -0.411061802247234

cycle= 41 E= -8327.02903244915  delta_E= -0.325  |g|= 1.59  |ddm|= 2.78

WARN: HOMO 0.0254894199672271 >= LUMO -0.445966422605974

cycle= 42 E= -8327.02108680344  delta_E= 0.00795  |g|= 1.65  |ddm|= 2.75

WARN: HOMO 0.015482245358772 >= LUMO -0.40261040694479

cycle= 43 E= -8326.98130695775  delta_E= 0.0398  |g|= 1.65  |ddm|= 2.77

WARN: HOMO 0.013947264463417 >= LUMO -0.434238804370087

cycle= 44 E= -8326.84296487765  delta_E= 0.138  |g|= 1.83  |ddm|=  2.8

WARN: HOMO 0.0277251825796744 >= LUMO -0.457365766093561

cycle= 45 E= -8327.11732175182  delta_E= -0.274  |g|= 1.57  |ddm|= 2.66

WARN: HOMO 0.0182042125769395 >= LUMO -0.472984783393383

cycle= 46 E= -8326.62715651056  delta_E= 0.49  |g|= 1.97  |ddm|= 2.64

WARN: HOMO -0.129401977512526 >= LUMO -0.345990553652478

cycle= 47 E= -8327.09511711269  delta_E= -0.468  |g|= 1.54  |ddm|= 2.64

WARN: HOMO -0.120859297127419 >= LUMO -0.351128073967196

cycle= 48 E= -8327.17118054134  delta_E= -0.0761  |g|= 1.46  |ddm|= 2.59

WARN: HOMO -0.126812186290736 >= LUMO -0.430027447291404

cycle= 49 E= -8326.97434720639  delta_E= 0.197  |g|= 1.59  |ddm|= 2.74

WARN: HOMO -0.123069454915413 >= LUMO -0.38952257201934

cycle= 50 E= -8326.89386190176  delta_E= 0.0805  |g|= 1.66  |ddm|= 2.51

WARN: HOMO -0.156442021284865 >= LUMO -0.396275081918876

cycle= 51 E= -8326.74225932469  delta_E= 0.152  |g|= 1.81  |ddm|= 2.75

WARN: HOMO -0.146351664634068 >= LUMO -0.368997331764993

cycle= 52 E= -8327.58805958187  delta_E= -0.846  |g|= 0.871  |ddm|= 2.19

WARN: HOMO -0.116724474388582 >= LUMO -0.272234492175497

cycle= 53 E= -8327.95524579401  delta_E= -0.367  |g|= 0.313  |ddm|=  1.5
  HOMO = -0.290811096931339  LUMO = -0.0838802464473365
cycle= 54 E= -8328.11923320611  delta_E= -0.164  |g|= 0.204  |ddm|= 0.622
  HOMO = -0.302194722780711  LUMO = -0.0430540314997091
cycle= 55 E= -8328.17117872833  delta_E= -0.0519  |g|= 0.115  |ddm|= 0.393
  HOMO = -0.334043981464159  LUMO = -0.04387193527037
cycle= 56 E= -8328.19542325732  delta_E= -0.0242  |g|= 0.0943  |ddm|= 0.248
  HOMO = -0.330107628399417  LUMO = -0.0231817736964009
cycle= 57 E= -8328.21628859407  delta_E= -0.0209  |g|= 0.088  |ddm|= 0.22
  HOMO = -0.335038248843541  LUMO = -0.0213273650852342
cycle= 58 E= -8328.2353521852  delta_E= -0.0191  |g|= 0.0865  |ddm|= 0.201
  HOMO = -0.3353395491458  LUMO = -0.0161904608208857
cycle= 59 E= -8328.25185044252  delta_E= -0.0165  |g|= 0.0871  |ddm|= 0.177
  HOMO = -0.349117738531225  LUMO = -0.0131898450758738
cycle= 60 E= -8328.25845913586  delta_E= -0.00661  |g|= 0.0838  |ddm|= 0.0727
  HOMO = -0.335949650971756  LUMO = -0.0196870965611029
cycle= 61 E= -8328.24900504931  delta_E= 0.00945  |g|= 0.0926  |ddm|= 0.0987
  HOMO = -0.333061218836473  LUMO = -0.0253887305038528
cycle= 62 E= -8328.24546107046  delta_E= 0.00354  |g|= 0.0949  |ddm|= 0.0464
  HOMO = -0.333252091960745  LUMO = -0.02379580835572
cycle= 63 E= -8328.24997819046  delta_E= -0.00452  |g|= 0.0913  |ddm|= 0.0631
  HOMO = -0.333519557852309  LUMO = -0.0229627250228214
cycle= 64 E= -8328.25278497721  delta_E= -0.00281  |g|= 0.0922  |ddm|= 0.0526
  HOMO = -0.34019696361467  LUMO = -0.0204091164806352
cycle= 65 E= -8328.25396506082  delta_E= -0.00118  |g|= 0.0864  |ddm|= 0.105
  HOMO = -0.346080020701489  LUMO = -0.0108249723336919
cycle= 66 E= -8328.26313105329  delta_E= -0.00917  |g|= 0.0763  |ddm|= 0.168
  HOMO = -0.351903389607496  LUMO = -0.0116404744634598
cycle= 67 E= -8328.27217570925  delta_E= -0.00904  |g|= 0.0688  |ddm|= 0.238
  HOMO = -0.346690179647274  LUMO = -0.00701491375023656
cycle= 68 E= -8328.28517601986  delta_E= -0.013  |g|= 0.0641  |ddm|= 0.243
  HOMO = -0.347159545791698  LUMO = -0.00609478571896941
cycle= 69 E= -8328.28801753946  delta_E= -0.00284  |g|= 0.0671  |ddm|= 0.049
  HOMO = -0.347943107119524  LUMO = -0.00606927789722423
cycle= 70 E= -8328.29062079953  delta_E= -0.0026  |g|= 0.0689  |ddm|= 0.0618
  HOMO = -0.349465907900795  LUMO = -0.00615021028086651
cycle= 71 E= -8328.29176566605  delta_E= -0.00114  |g|= 0.07  |ddm|= 0.037
  HOMO = -0.351374587918456  LUMO = -0.00353943309452626
cycle= 72 E= -8328.29814275511  delta_E= -0.00638  |g|= 0.0699  |ddm|= 0.102
  HOMO = -0.350078964018033  LUMO = -0.0036988276407234
cycle= 73 E= -8328.29899123991  delta_E= -0.000848  |g|= 0.0725  |ddm|= 0.0331
  HOMO = -0.350582070808071  LUMO = -0.00331453677554621
cycle= 74 E= -8328.29972944604  delta_E= -0.000738  |g|= 0.074  |ddm|= 0.0213
  HOMO = -0.349623267437425  LUMO = -0.00290727558525632
cycle= 75 E= -8328.30014119705  delta_E= -0.000412  |g|= 0.0732  |ddm|= 0.049
  HOMO = -0.346815652445366  LUMO = -0.00400886038300362
cycle= 76 E= -8328.2967651518  delta_E= 0.00338  |g|= 0.0747  |ddm|= 0.0549
  HOMO = -0.351928979676938  LUMO = -0.00907344927589952
cycle= 77 E= -8328.28912278043  delta_E= 0.00764  |g|= 0.0709  |ddm|= 0.126
  HOMO = -0.35697309866876  LUMO = -0.00429476169791149
cycle= 78 E= -8328.28721907479  delta_E= 0.0019  |g|= 0.0637  |ddm|= 0.113
  HOMO = -0.361123101668177  LUMO = 0.00347578101227771
cycle= 79 E= -8328.27997497404  delta_E= 0.00724  |g|= 0.06  |ddm|= 0.177
  HOMO = -0.356447960162944  LUMO = -0.000860420584765474
cycle= 80 E= -8328.27899161934  delta_E= 0.000983  |g|= 0.052  |ddm|= 0.089
  HOMO = -0.328156444638837  LUMO = -0.0183461254672831
cycle= 81 E= -8328.28072151528  delta_E= -0.00173  |g|= 0.0459  |ddm|=  0.2
  HOMO = -0.33335136436431  LUMO = -0.0142403032745454
cycle= 82 E= -8328.28044235488  delta_E= 0.000279  |g|= 0.0432  |ddm|= 0.0853
  HOMO = -0.332185963443966  LUMO = -0.0155897090315044
cycle= 83 E= -8328.28042862871  delta_E= 1.37e-05  |g|= 0.0426  |ddm|= 0.0158
  HOMO = -0.341684481467891  LUMO = -0.0114241615977253
cycle= 84 E= -8328.27822549194  delta_E= 0.0022  |g|= 0.0423  |ddm|= 0.0544
  HOMO = -0.342630237740925  LUMO = -0.0113998150164603
cycle= 85 E= -8328.27796145505  delta_E= 0.000264  |g|= 0.0411  |ddm|= 0.0101
  HOMO = -0.335554247861201  LUMO = -0.0134448346473783
cycle= 86 E= -8328.28129616707  delta_E= -0.00333  |g|= 0.04  |ddm|= 0.0818
  HOMO = -0.333661444347593  LUMO = -0.0130914750742356
cycle= 87 E= -8328.28426218457  delta_E= -0.00297  |g|= 0.044  |ddm|= 0.0652
  HOMO = -0.334150197916685  LUMO = -0.0133573675007802
cycle= 88 E= -8328.28476184193  delta_E= -0.0005  |g|= 0.0471  |ddm|= 0.0248
  HOMO = -0.335125961695826  LUMO = -0.0151569627031394
cycle= 89 E= -8328.28075690072  delta_E= 0.004  |g|= 0.0445  |ddm|= 0.0872
  HOMO = -0.340600870233793  LUMO = -0.0125910921472419
cycle= 90 E= -8328.27652703489  delta_E= 0.00423  |g|= 0.0368  |ddm|= 0.139
  HOMO = -0.338078651518953  LUMO = -0.0154342573865092
cycle= 91 E= -8328.27587519701  delta_E= 0.000652  |g|= 0.0293  |ddm|= 0.119
  HOMO = -0.329005516089726  LUMO = -0.01826222150486
cycle= 92 E= -8328.27711639841  delta_E= -0.00124  |g|= 0.025  |ddm|= 0.128
  HOMO = -0.336440332657519  LUMO = -0.0161196323090023
cycle= 93 E= -8328.27757736266  delta_E= -0.000461  |g|= 0.0234  |ddm|= 0.0895
  HOMO = -0.335977746208392  LUMO = -0.0169998673080332
cycle= 94 E= -8328.27857651171  delta_E= -0.000999  |g|= 0.0221  |ddm|= 0.0652
  HOMO = -0.332825067928121  LUMO = -0.0193571838812557
cycle= 95 E= -8328.27961694541  delta_E= -0.00104  |g|= 0.0218  |ddm|= 0.0448
  HOMO = -0.339168140936439  LUMO = -0.0188064751686432
cycle= 96 E= -8328.28005806082  delta_E= -0.000441  |g|= 0.0225  |ddm|= 0.0322
  HOMO = -0.335572669700863  LUMO = -0.020131123810982
cycle= 97 E= -8328.28061454849  delta_E= -0.000556  |g|= 0.0224  |ddm|= 0.0241
  HOMO = -0.3322141840821  LUMO = -0.021169709081547
cycle= 98 E= -8328.28127385797  delta_E= -0.000659  |g|= 0.0224  |ddm|= 0.0288
  HOMO = -0.330764681591199  LUMO = -0.0228830988418222
cycle= 99 E= -8328.2818885932  delta_E= -0.000615  |g|= 0.0226  |ddm|= 0.0286
  HOMO = -0.331457930673796  LUMO = -0.0222309499650814
cycle= 100 E= -8328.28225456699  delta_E= -0.000366  |g|= 0.0224  |ddm|= 0.0284
  HOMO = -0.331853619778572  LUMO = -0.0202165866716149
cycle= 101 E= -8328.28183055219  delta_E= 0.000424  |g|= 0.0233  |ddm|= 0.0213
  HOMO = -0.331976483069403  LUMO = -0.0234581030819521
cycle= 102 E= -8328.28199353598  delta_E= -0.000163  |g|= 0.023  |ddm|= 0.0428
  HOMO = -0.333278530534994  LUMO = -0.0227823344066653
cycle= 103 E= -8328.28322121028  delta_E= -0.00123  |g|= 0.022  |ddm|= 0.0531
  HOMO = -0.332742366963915  LUMO = -0.0206275209490587
cycle= 104 E= -8328.28475712531  delta_E= -0.00154  |g|= 0.0211  |ddm|= 0.0679
  HOMO = -0.334370311063445  LUMO = -0.0198790445730963
cycle= 105 E= -8328.28656229092  delta_E= -0.00181  |g|= 0.021  |ddm|= 0.0754
  HOMO = -0.334129370504552  LUMO = -0.0189948544398401
cycle= 106 E= -8328.28696976622  delta_E= -0.000407  |g|= 0.0228  |ddm|= 0.0183
  HOMO = -0.333679061132222  LUMO = -0.0190846961009975
cycle= 107 E= -8328.28642717615  delta_E= 0.000543  |g|= 0.0236  |ddm|= 0.0401
  HOMO = -0.335424746088907  LUMO = -0.0191197509133126
cycle= 108 E= -8328.28724796613  delta_E= -0.000821  |g|= 0.0213  |ddm|= 0.0563
  HOMO = -0.337330635234884  LUMO = -0.0176584922538626
cycle= 109 E= -8328.2889914754  delta_E= -0.00174  |g|= 0.0196  |ddm|= 0.0847
  HOMO = -0.335218864002404  LUMO = -0.0242066003111579
cycle= 110 E= -8328.28851589556  delta_E= 0.000476  |g|= 0.0236  |ddm|= 0.0363
  HOMO = -0.335965530624351  LUMO = -0.0234314538369772
cycle= 111 E= -8328.28856362406  delta_E= -4.77e-05  |g|= 0.0233  |ddm|= 0.00995
  HOMO = -0.335941714465998  LUMO = -0.0227230780442496
cycle= 112 E= -8328.28878881657  delta_E= -0.000225  |g|= 0.0224  |ddm|= 0.0134
  HOMO = -0.336870885543855  LUMO = -0.0192578314800923
cycle= 113 E= -8328.2898680972  delta_E= -0.00108  |g|= 0.0202  |ddm|= 0.046
  HOMO = -0.338264806612747  LUMO = -0.0165128640962301
cycle= 114 E= -8328.29195258555  delta_E= -0.00208  |g|= 0.0185  |ddm|= 0.0905
  HOMO = -0.341913596259454  LUMO = -0.0143118231022324
cycle= 115 E= -8328.29373713341  delta_E= -0.00178  |g|= 0.0184  |ddm|= 0.0869
  HOMO = -0.343085750470139  LUMO = -0.0152732910371606
cycle= 116 E= -8328.29623797981  delta_E= -0.0025  |g|= 0.0164  |ddm|= 0.116
  HOMO = -0.342498606379115  LUMO = -0.0226180493345254
cycle= 117 E= -8328.29784559854  delta_E= -0.00161  |g|= 0.0189  |ddm|= 0.0894
  HOMO = -0.350383841902957  LUMO = -0.00108731827375436
cycle= 118 E= -8328.30105178419  delta_E= -0.00321  |g|= 0.0249  |ddm|= 0.196
  HOMO = -0.349955390569687  LUMO = -0.00644129924884178
cycle= 119 E= -8328.30190739322  delta_E= -0.000856  |g|= 0.0169  |ddm|= 0.0525
  HOMO = -0.35132314897625  LUMO = -0.00807508168714694
cycle= 120 E= -8328.30346160021  delta_E= -0.00155  |g|= 0.0126  |ddm|= 0.13
  HOMO = -0.34912361694096  LUMO = -0.0187900404109547
cycle= 121 E= -8328.30395191902  delta_E= -0.00049  |g|= 0.0139  |ddm|= 0.056
  HOMO = -0.349102892384544  LUMO = -0.0202595305113104
cycle= 122 E= -8328.30449640759  delta_E= -0.000544  |g|= 0.0162  |ddm|= 0.0787
  HOMO = -0.35102262016894  LUMO = -0.0135955419271456
cycle= 123 E= -8328.3047769909  delta_E= -0.000281  |g|= 0.0104  |ddm|= 0.0319
  HOMO = -0.353016495560538  LUMO = -0.00729667713787015
cycle= 124 E= -8328.30479439847  delta_E= -1.74e-05  |g|= 0.0122  |ddm|= 0.0236
  HOMO = -0.352019239066508  LUMO = -0.0121682291300012
cycle= 125 E= -8328.30478936571  delta_E= 5.03e-06  |g|= 0.0112  |ddm|= 0.0218
  HOMO = -0.352279681163384  LUMO = -0.0113208028384867
cycle= 126 E= -8328.30476159168  delta_E= 2.78e-05  |g|= 0.011  |ddm|= 0.00793
  HOMO = -0.352007309164515  LUMO = -0.0134060149141517
cycle= 127 E= -8328.30455206  delta_E= 0.00021  |g|= 0.01  |ddm|= 0.026
  HOMO = -0.353363105618236  LUMO = -0.0105057391516597
cycle= 128 E= -8328.30450649201  delta_E= 4.56e-05  |g|= 0.00772  |ddm|= 0.0547
  HOMO = -0.352497957069631  LUMO = -0.0110499968432009
cycle= 129 E= -8328.30437036407  delta_E= 0.000136  |g|= 0.00583  |ddm|= 0.035
  HOMO = -0.3531959219075  LUMO = -0.0107504065850417
cycle= 130 E= -8328.30443865048  delta_E= -6.83e-05  |g|= 0.00359  |ddm|= 0.0447
  HOMO = -0.350875202279727  LUMO = -0.0122620767431031
cycle= 131 E= -8328.30449783538  delta_E= -5.92e-05  |g|= 0.0022  |ddm|= 0.0191
  HOMO = -0.351648763135037  LUMO = -0.0116699116544255
cycle= 132 E= -8328.30451839847  delta_E= -2.06e-05  |g|= 0.00207  |ddm|= 0.0083
  HOMO = -0.352063761404293  LUMO = -0.0114759644226535
cycle= 133 E= -8328.30453953896  delta_E= -2.11e-05  |g|= 0.0017  |ddm|= 0.0105
  HOMO = -0.352032593121893  LUMO = -0.0112834849105979
cycle= 134 E= -8328.30456073929  delta_E= -2.12e-05  |g|= 0.00133  |ddm|= 0.0128
  HOMO = -0.351921109558344  LUMO = -0.011403319378099
cycle= 135 E= -8328.30458076274  delta_E= -2e-05  |g|= 0.00088  |ddm|= 0.0154
  HOMO = -0.352074409221535  LUMO = -0.0113691100808833
cycle= 136 E= -8328.30458940579  delta_E= -8.64e-06  |g|= 0.000664  |ddm|= 0.00904
  HOMO = -0.351992940749646  LUMO = -0.0113164291817319
cycle= 137 E= -8328.30459543083  delta_E= -6.03e-06  |g|= 0.000601  |ddm|= 0.0102
  HOMO = -0.352013266594276  LUMO = -0.0113677823246803
cycle= 138 E= -8328.30459764243  delta_E= -2.21e-06  |g|= 0.000428  |ddm|= 0.00622
  HOMO = -0.351987429279853  LUMO = -0.0114307148119387
cycle= 139 E= -8328.30459826626  delta_E= -6.24e-07  |g|= 0.000281  |ddm|= 0.00412
  HOMO = -0.35202055396329  LUMO = -0.0114383191163814
cycle= 140 E= -8328.30459863263  delta_E= -3.66e-07  |g|= 0.000176  |ddm|= 0.0022
  HOMO = -0.352003980313802  LUMO = -0.0113936789002186
cycle= 141 E= -8328.30459879115  delta_E= -1.59e-07  |g|= 0.000162  |ddm|= 0.00118
  HOMO = -0.352008800854786  LUMO = -0.0113953227245976
cycle= 142 E= -8328.30459885104  delta_E= -5.99e-08  |g|= 0.000162  |ddm|= 0.000587
  HOMO = -0.352012588097652  LUMO = -0.011401156798736
cycle= 143 E= -8328.30459886261  delta_E= -1.16e-08  |g|= 0.000156  |ddm|= 0.000362
  HOMO = -0.352014573876297  LUMO = -0.0114056725846112
cycle= 144 E= -8328.30459886052  delta_E= 2.09e-09  |g|= 0.000143  |ddm|= 0.000363
  HOMO = -0.352010138837057  LUMO = -0.011403253611645
cycle= 145 E= -8328.3045988522  delta_E= 8.31e-09  |g|= 0.000114  |ddm|= 0.000743
  HOMO = -0.352020884460097  LUMO = -0.0114104306255138
cycle= 146 E= -8328.30459885756  delta_E= -5.36e-09  |g|= 9.11e-05  |ddm|= 0.000627
  HOMO = -0.352013428031279  LUMO = -0.0114049141093344
cycle= 147 E= -8328.30459885829  delta_E= -7.28e-10  |g|= 8.48e-05  |ddm|= 0.000511
  HOMO = -0.352015781239206  LUMO = -0.0114066103807291
cycle= 148 E= -8328.30459886223  delta_E= -3.93e-09  |g|= 7.62e-05  |ddm|= 0.000143
  HOMO = -0.352014092521343  LUMO = -0.0114044731406694
cycle= 149 E= -8328.3045988971  delta_E= -3.49e-08  |g|= 5.6e-05  |ddm|= 0.000457
  HOMO = -0.352017673294754  LUMO = -0.0114065923324485
cycle= 150 E= -8328.30459892168  delta_E= -2.46e-08  |g|= 4.77e-05  |ddm|= 0.000401
  HOMO = -0.352013745261312  LUMO = -0.0114032132470662
cycle= 151 E= -8328.30459894311  delta_E= -2.14e-08  |g|= 4.06e-05  |ddm|= 0.000579
  HOMO = -0.352016014034223  LUMO = -0.0114042223480028
cycle= 152 E= -8328.30459895146  delta_E= -8.35e-09  |g|= 3.6e-05  |ddm|= 0.000367
  HOMO = -0.352016140979593  LUMO = -0.0114038222064935
cycle= 153 E= -8328.30459895581  delta_E= -4.34e-09  |g|= 3.61e-05  |ddm|= 0.000342
  HOMO = -0.352016740318897  LUMO = -0.0114043254546169
cycle= 154 E= -8328.30459895605  delta_E= -2.44e-10  |g|= 3.32e-05  |ddm|= 8.84e-05
  HOMO = -0.352015795487079  LUMO = -0.0114035574923151
cycle= 155 E= -8328.30459895616  delta_E= -1.11e-10  |g|= 3.3e-05  |ddm|= 5.12e-05
  HOMO = -0.352014618722287  LUMO = -0.0114029052300868
cycle= 156 E= -8328.30459895765  delta_E= -1.49e-09  |g|= 3.24e-05  |ddm|= 0.00011
  HOMO = -0.352016669431741  LUMO = -0.0114041853383344
cycle= 157 E= -8328.30459896253  delta_E= -4.88e-09  |g|= 3.25e-05  |ddm|= 0.000136
  HOMO = -0.352016248257775  LUMO = -0.0114037682419748
cycle= 158 E= -8328.30459896415  delta_E= -1.62e-09  |g|= 3.57e-05  |ddm|= 6.29e-05
  HOMO = -0.352014591371257  LUMO = -0.0114027685695862
cycle= 159 E= -8328.30459896142  delta_E= 2.73e-09  |g|= 3.86e-05  |ddm|= 8.69e-05
  HOMO = -0.352015290595304  LUMO = -0.0114033999265753
cycle= 160 E= -8328.30459895986  delta_E= 1.56e-09  |g|= 3.71e-05  |ddm|= 9.13e-05
  HOMO = -0.352015155261268  LUMO = -0.0114033353234893
cycle= 161 E= -8328.30459895867  delta_E= 1.2e-09  |g|= 3.63e-05  |ddm|= 5.85e-05
  HOMO = -0.352014802186284  LUMO = -0.0114031623379863
cycle= 162 E= -8328.30459895731  delta_E= 1.36e-09  |g|= 3.56e-05  |ddm|= 6.77e-05
  HOMO = -0.352015024285091  LUMO = -0.0114033314062315
cycle= 163 E= -8328.30459895684  delta_E= 4.66e-10  |g|= 3.45e-05  |ddm|= 2.32e-05
  HOMO = -0.352015059061428  LUMO = -0.0114033711674508
cycle= 164 E= -8328.30459895727  delta_E= -4.33e-10  |g|= 3.45e-05  |ddm|= 3.68e-05
  HOMO = -0.352015331261525  LUMO = -0.0114035537393621
cycle= 165 E= -8328.30459895749  delta_E= -2.15e-10  |g|= 3.52e-05  |ddm|= 1.75e-05
  HOMO = -0.352016286108616  LUMO = -0.0114042068065784
cycle= 166 E= -8328.30459896045  delta_E= -2.96e-09  |g|= 3.39e-05  |ddm|= 8.87e-05
  HOMO = -0.352016496396463  LUMO = -0.0114045157244876
cycle= 167 E= -8328.30459896065  delta_E= -2e-10  |g|= 2.94e-05  |ddm|= 0.000154
  HOMO = -0.452014685312344  LUMO = -0.211403040844876
Extra cycle  E= -8328.30459896354  delta_E= -2.9e-09  |g|= 3.19e-05  |ddm|= 9.67e-05
converged SCF energy = -8328.30459896354

Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =      2.862 | E =   -8328.3879941393 | DW = 2.07881e-08

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =      5.503 | E =   -8328.3907840340 | DE = -2.79e-03 | DW = 1.37028e-07

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =      7.964 | E =   -8328.3908230222 | DE = -3.90e-05 | DW = 4.67848e-07

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =     10.137 | E =   -8328.3908282532 | DE = -5.23e-06 | DW = 3.31271e-07

Sweep =    4 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     15.720 | E =   -8328.3908340990 | DE = -5.85e-06 | DW = 1.93608e-08

Sweep =    5 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     24.031 | E =   -8328.3908383477 | DE = -4.25e-06 | DW = 4.08078e-08

Sweep =    6 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     32.835 | E =   -8328.3908391546 | DE = -8.07e-07 | DW = 7.26991e-08

Sweep =    7 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     40.622 | E =   -8328.3908393843 | DE = -2.30e-07 | DW = 5.74594e-08

Sweep =    8 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =     68.982 | E =   -8328.3908406261 | DE = -1.24e-06 | DW = 1.38109e-19

Sweep =    9 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    151.442 | E =   -8328.3908422986 | DE = -1.67e-06 | DW = 8.02919e-11

Sweep =   10 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    276.920 | E =   -8328.3908425249 | DE = -2.26e-07 | DW = 6.40188e-10

Sweep =   11 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    390.263 | E =   -8328.3908425392 | DE = -1.43e-08 | DW = 7.67709e-10

Sweep =   12 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    502.928 | E =   -8328.3908425450 | DE = -5.83e-09 | DW = 7.41864e-10

DMRG energy = -8328.390842544999032
已保存为 minfo_data.h5
