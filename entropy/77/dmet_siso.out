#INFO: **** input file is /home/Yxwxwx/code/dmet/test/entropy/77/dmet_siso.py ****
from pyscf import gto, scf, ao2mo, mcscf, fci, dmrgscf, lib

# from pyscf.csf_fci import csf_solver  # TODO:
from pyscf.mcscf import avas
from pyscf.tools import molden, fcidump
from pyscf.lib import logger, cho_solve
from pyscf.data import nist
import numpy as np
import scipy
from functools import reduce
import os
import tempfile
from liblan.utils.rdiis import tag_rdiis_
import h5py
from pyblock2._pyscf.ao2mo import integrals as itg
from pyblock2.driver.core import DMRGDriver, SymmetryTypes

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ""


def read_cas_info(fname):
    with open(fname, "r") as f1:
        ncasorb, ncaselec = [int(x) for x in f1.readline().split(" ")]
        casorbind = [int(x) for x in f1.readline().split(" ")]
        statelis = [int(x) for x in f1.readline().split(" ")]
    return ncasorb, ncaselec, casorbind, statelis


def sacasscf_dump_chk(solver, sav):
    # saving properties for SISO
    with h5py.File(sav, "w") as fh5:
        fh5["ncore"] = np.asarray(solver.ncore)
        fh5["ncas"] = np.asarray(solver.ncas)
        fh5["nelecas"] = np.asarray(solver.nelecas)
        fh5["mo_coeff"] = solver.mo_coeff
        fh5["rdm1"] = solver.make_rdm1()

        for i in range(len(solver.ci)):
            fh5["ci" + str(i)] = solver.ci[i]
        fh5["e_states"] = solver.e_states


def sacasscf_load_chk(solver, sav):
    with h5py.File(sav, "r") as fh5:
        solver.ncore = fh5["ncore"][()]
        solver.ncas = fh5["ncas"][()]
        solver.nelecas = fh5["nelecas"][:]

        solver.mo_coeff = fh5["mo_coeff"][:]
        rdm1 = fh5["rdm1"][:]
        solver.make_rdm1 = lambda *args: rdm1

        # solver.e_states = fh5["e_states"][:]
        # solver.ci = [fh5["ci" + str(i)][:] for i in range(len(solver.e_states))]
    return solver


def rohf_solve_imp(hcore, eris, nelec, spin, max_mem, dm0=None, verbose=logger.INFO):
    mol = gto.M()
    mol.verbose = verbose
    mol.incore_anyway = True
    mol.nelectron = nelec
    mol.spin = spin

    nao = hcore.shape[0]
    print("nao = ", nao)
    print("nelec = ", mol.nelec)

    mf = scf.rohf.ROHF(mol).x2c()
    mf.max_memory = max_mem
    mf.mo_energy = np.zeros((nao))
    mf.max_cycle = 1000
    mf.diis_space = 8
    mf.init_guess = "1e"
    mf.level_shift = 0.2

    mf.get_hcore = lambda *args: hcore
    mf.get_ovlp = lambda *args: np.eye(nao)
    mf._eri = ao2mo.restore(8, eris, nao)

    if dm0 is None:
        mf.kernel()
    else:
        if dm0.shape != hcore.shape:
            bath_size = hcore.shape[0] - dm0.shape[0]
            dm0 = scipy.linalg.block_diag(
                dm0, np.eye(bath_size) * (nelec - np.trace(dm0)) / bath_size
            )
        mf.kernel(dm0)
    return mf


def sacasscf_solve_imp(
    solver_base, mol, ncasorb, ncaselec, casorbind, statelis, avas=False
):
    solver = mcscf.CASSCF(solver_base, ncasorb, ncaselec)

    if avas:
        mo = casorbind
    else:
        mo = solver.sort_mo(casorbind)
    mcfs = []
    logger.info(solver, "Attempting SA-DMRGSCF with")
    for i in range(len(statelis)):
        if statelis[i] != 0:
            new_mcf = dmrgscf.DMRGCI(mol, maxM=1500, tol=1e-10)
            new_mcf.spin = i
            new_mcf.nroots = statelis[i]
            new_mcf.threads = 16
            new_mcf.memory = int(mol.max_memory / 1000)
            new_mcf.block_extra_keyword = [
                "real_density_matrix",
                "davidson_soft_max_iter 1600",
                "noreorder",
                "cutoff 1E-24",
            ]
            new_mcf.runtimeDir = lib.param.TMPDIR + "/%d" % i
            new_mcf.scratchDirectory = lib.param.TMPDIR + "/%d" % i
            mcfs.append(new_mcf)
            logger.info(
                solver, "%s states with spin multiplicity %s", statelis[i], i + 1
            )

    statetot = sum(statelis)
    mcscf.state_average_mix_(solver, mcfs, np.ones(statetot) / statetot)
    solver.run(mo, verbose=mol.verbose)
    return solver


def lowdin(s):
    """new basis is |mu> c^{lowdin}_{mu i}"""
    e, v = scipy.linalg.eigh(s)
    idx = e > 1e-15
    return np.dot(v[:, idx] / np.sqrt(e[idx]), v[:, idx].conj().T)


def caolo(s):
    return lowdin(s)


def cloao(s):
    return lowdin(s) @ s


def get_dmet_as_props(mf, imp_inds, lo_meth="lowdin", thres=1e-13):
    """
    Returns C(AO->AS), entropy loss, and orbital composition
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)
    env_inds = [x for x in range(s.shape[0]) if x not in imp_inds]

    if mf.mol.spin == 0:
        pass
    else:
        dma, dmb = mf.make_rdm1()

        ldma = reduce(np.dot, (cloao_mat, dma, cloao_mat.conj().T))
        ldmb = reduce(np.dot, (cloao_mat, dmb, cloao_mat.conj().T))

        ldma_env = ldma[env_inds, :][:, env_inds]
        ldmb_env = ldmb[env_inds, :][:, env_inds]

        nat_occa, nat_coeffa = np.linalg.eigh(ldma_env)
        nat_occb, nat_coeffb = np.linalg.eigh(ldmb_env)

        ldmr_env = ldma_env + ldmb_env
        nat_occr, nat_coeffr = np.linalg.eigh(ldmr_env)

        caoas = np.hstack([caolo_mat[:, imp_inds], caolo_mat[:, env_inds] @ nat_coeffr])

        nuu = np.sum([nat_occr < thres])
        ne = np.sum([(nat_occr >= thres) & (nat_occr <= 2 - thres)])
        nuo = np.sum([nat_occr > 2 - thres])

        asorbs = (nuu, ne, nuo)
        print("caoas.shape = ", caoas.shape)
        print("asorbs = ", asorbs)

        nat_occa = nat_occa[nat_occa > thres]
        nat_occb = nat_occb[nat_occb > thres]
        nat_occr = nat_occr[nat_occr > thres]

        ent = -np.sum(nat_occa * np.log(nat_occa)) - np.sum(nat_occb * np.log(nat_occb))
        entr = -2 * np.sum(nat_occr / 2 * np.log(nat_occr / 2))

        return caoas, entr - ent, asorbs


def get_dmet_imp_ldm(mf, imp_inds, lo_meth="lowdin"):
    """
    Returns better initial guess than '1e' for impurity
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)

    dma, dmb = mf.make_rdm1()

    ldm = reduce(np.dot, (cloao_mat, (dma + dmb), cloao_mat.conj().T))[imp_inds, :][
        :, imp_inds
    ]
    return ldm


def get_as_1e_ints(mf, caoas, asorbs):
    # hcore from mf
    hcore = mf.get_hcore()

    # HF J/K from env UO
    uos = hcore.shape[0] - asorbs[-1]
    dm_uo = caoas[:, uos:] @ caoas[:, uos:].conj().T * 2
    vj, vk = mf.get_jk(dm=dm_uo)

    fock = hcore + vj - 0.5 * vk

    nimp = hcore.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    asints1e = reduce(np.dot, (caoas[:, act_inds].conj().T, fock, caoas[:, act_inds]))
    return asints1e


def get_as_2e_ints(mf, caoas, asorbs):
    nimp = caoas.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    if mf._eri is not None:
        asints2e = ao2mo.full(mf._eri, caoas[:, act_inds])
    else:
        asints2e = ao2mo.full(mf.mol, caoas[:, act_inds])

    return asints2e


def get_bp_hso2e(mol, dm0):
    hso2e = mol.intor("int2e_p1vxp1", 3).reshape(3, mol.nao, mol.nao, mol.nao, mol.nao)
    vj = np.einsum("yijkl,lk->yij", hso2e, dm0, optimize=True)
    vk = np.einsum("yijkl,jk->yil", hso2e, dm0, optimize=True)
    vk += np.einsum("yijkl,li->ykj", hso2e, dm0, optimize=True)
    return vj, vk


def get_bp_hso2e_amfi(mol, dm0):
    """atomic-mean-field approximation"""
    ao_loc = mol.ao_loc_nr()
    nao = ao_loc[-1]
    vj = np.zeros((3, nao, nao))
    vk = np.zeros((3, nao, nao))
    import copy

    atom = copy.copy(mol)
    aoslice = mol.aoslice_by_atom(ao_loc)
    for ia in range(mol.natm):
        b0, b1, p0, p1 = aoslice[ia]
        atom._bas = mol._bas[b0:b1]
        vj1, vk1 = get_bp_hso2e(atom, dm0[p0:p1, p0:p1])
        vj[:, p0:p1, p0:p1] = vj1
        vk[:, p0:p1, p0:p1] = vk1
    return vj, vk


mol = gto.M(
    atom="""
Co      11.04404000       1.04900000       3.34378000 
S        8.77823000       3.00936000       4.33821000 
S       11.43622000       3.02151000       0.92730000 
S       10.91108000      -2.02878000       2.57231000 
S       13.08635000       0.19519000       5.60771000 
O       11.83167000      -0.45768000       5.96583000 
O       12.19019000       3.07283000      -0.30709000 
O        7.93263000       3.08738000       5.51462000 
O       10.07860000       2.53858000       0.82177000 
N       10.12989000      -0.70978000       2.99572000 
O       13.74529000       0.85669000       6.71938000 
O       10.27427000      -2.76510000       1.49667000 
O       10.00204000       3.77701000       4.38210000 
O       12.27951000      -1.59956000       2.30125000 
N       12.76369000       1.14747000       4.38064000 
N        9.20359000       1.51260000       3.96893000 
N       12.13222000       2.14916000       2.06988000 
C        6.10275000      -0.60027000       4.18585000 
H        5.20999000      -0.54352000       4.44081000 
C       13.46188000       2.40605000       2.47683000 
C        8.76888000      -0.75790000       3.38109000 
C        7.81280000       3.62067000       2.98712000 
H        6.98919000       3.13006000       2.93372000 
H        8.30293000       3.51372000       2.16919000 
H        7.62236000       4.55121000       3.12576000 
C       14.42792000       3.12175000       1.75566000 
H       14.21536000       3.46576000       0.91816000 
C       13.81006000       1.85310000       3.73518000 
C       11.00381000      -3.08882000       3.98356000 
H       11.42504000      -2.62011000       4.70785000 
H       11.51861000      -3.86861000       3.76408000 
H       10.11859000      -3.35226000       4.24328000 
C       11.35066000       4.67750000       1.54807000 
H       10.85506000       4.68550000       2.37038000 
H       10.91096000       5.23861000       0.90353000 
H       12.23807000       5.00681000       1.70646000 
C       15.09147000       2.06251000       4.23761000 
H       15.32372000       1.70571000       5.06450000 
C       15.70143000       3.32269000       2.28021000 
H       16.32999000       3.80946000       1.79791000 
C        6.91566000       0.52770000       4.27382000 
H        6.56140000       1.32684000       4.59079000 
C       14.17866000      -1.05460000       5.00085000 
H       13.76692000      -1.50748000       4.26157000 
H       14.36363000      -1.68492000       5.70099000 
H       14.99923000      -0.64903000       4.70968000 
C        8.26027000       0.46871000       3.88809000 
C        7.93481000      -1.87020000       3.30665000 
H        8.26769000      -2.67286000       2.97395000 
C        6.60455000      -1.79779000       3.72549000 
H        6.06192000      -2.55296000       3.69458000 
C       16.03321000       2.80059000       3.51717000 
H       16.88295000       2.94142000       3.86834000
        """,
    basis={
        "default": "def2tzvp",
        "C": "6-31G*",
        "H": "6-31G*",
        "S": "6-31G*",
        "O": "6-31G*",
    },
    symmetry=0,
    spin=3,
    charge=-2,
    verbose=4,
    max_memory=200000,
)

mf = scf.rohf.ROHF(mol).x2c()
mf.max_cycle = 100
title = "CoNSPh2"
imp_inds = mol.search_ao_label(["Co *"])
mf.chkfile = title + "_rohf.chk"
mf.init_guess = "atom"
mf.level_shift = 0.2
if os.path.isfile(title + "_rohf.chk"):
    mf.init_guess = "chk"
    mf.level_shift = 0.0
mf = tag_rdiis_(mf=mf, imp_inds=imp_inds)
mf.kernel()


print("nao = ", mol.nao_nr())
print("nelec = ", mol.nelec)


print("imp_inds.shape", imp_inds.shape)

as_fname = title + "_as_chk.h5"
if not os.path.isfile(as_fname):
    # AS general info
    caoas, ent, asorbs = get_dmet_as_props(mf, imp_inds, thres=1e-13)
    # AS hcore + j/k
    as1e = get_as_1e_ints(mf, caoas, asorbs)
    # AS ERIs
    as2e = get_as_2e_ints(mf, caoas, asorbs)

    print(f"Entanglement S: {ent:.3f}")

    with h5py.File(as_fname, "w") as fh5:
        fh5["caoas"] = caoas
        fh5["ent"] = ent
        fh5["asorbs"] = asorbs
        fh5["1e"] = as1e
        fh5["2e"] = as2e
else:
    fh5 = h5py.File(as_fname, "r")
    caoas = fh5["caoas"][:]
    ent = fh5["ent"][()]
    asorbs = fh5["asorbs"][:]
    as1e = fh5["1e"][:]
    as2e = fh5["2e"][:]
    fh5.close()

nimp = caoas.shape[0] - np.sum(asorbs)
print("nimp = ", nimp)
act_inds = [
    *list(range(nimp)),
    *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
]

print("act_inds = ", act_inds)

nelec = int(mf.mol.nelectron - asorbs[-1] * 2)
ldm = get_dmet_imp_ldm(mf, imp_inds)
solver_base = rohf_solve_imp(as1e, as2e, nelec, mf.mol.spin, mf.max_memory, dm0=ldm)

with open(title + "_imp_rohf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver_base.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

# avas
# ao_labels = ["Co 3d"]
# ncasorb, ncaselec, casorbind = avas.avas(solver_base, ao_labels, canonicalize=False)

# ncasorb = 5
# ncaselec = 7
# casorbind = [40, 41, 55, 56, 57]  # F-style

caschk_fname = title + "_imp_cas_chk.h5"


if not os.path.isfile(caschk_fname):
    casinfo_fname = title + "_cas_info"
    if not os.path.isfile(casinfo_fname):
        print("Failed to read saved CAS briefings.")
        exit()
    ncasorb, ncaselec, casorbind, statelis = read_cas_info(casinfo_fname)

    solver = sacasscf_solve_imp(
        solver_base, mf.mol, ncasorb, ncaselec, casorbind, statelis=statelis
    )
    sacasscf_dump_chk(solver, caschk_fname)

else:
    solver = sacasscf_load_chk(lib.StreamObject(), caschk_fname)


with open(title + "_imp_casscf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

huge_casorbind = [
    42,
    43,
    44,
    45,
    46,
    47,
    48,
    49,
    50,
    51,
    52,
    53,
    54,
    55,
    56,
    57,
    58,
    59,
    60,
    61,
    62,
    63,
]
if len(huge_casorbind) != 22:
    exit()

mc = mcscf.CASSCF(solver_base, ncas=22, nelecas=31)
mc.mo_coeff = mc.sort_mo(huge_casorbind, solver.mo_coeff)

bond_dims = [250] * 4 + [500] * 4 + [2000]
noises = [1e-4] * 4 + [1e-5] * 4 + [0]
thrds = [1e-10] * 8
ncas = 22
n_elec = 31
spin = 3
ecore = mc.get_h1eff()[1]
h1e = mc.get_h1eff()[0]
g2e = mc.get_h2eff()
orb_sym = [0] * ncas
# ncas, n_elec, spin, ecore, h1e, g2e, orb_sym = itg.get_rhf_integrals(
#     mf, ncore=0, ncas=None, g2e_symm=8
# )
driver = DMRGDriver(
    scratch="./tmp",
    symm_type=SymmetryTypes.SZ,
    n_threads=32,
    stack_mem=int(200 * 1024**3),
)
driver.initialize_system(n_sites=ncas, n_elec=n_elec, spin=spin, orb_sym=orb_sym)

mpo = driver.get_qc_mpo(h1e=h1e, g2e=g2e, ecore=ecore, iprint=0)
ket = driver.get_random_mps(tag="GS", bond_dim=250, nroots=1)
energy = driver.dmrg(
    mpo, ket, n_sweeps=20, bond_dims=bond_dims, noises=noises, thrds=thrds, iprint=1
)
print("DMRG energy = %20.15f" % energy)

ordm1 = driver.get_orbital_entropies(ket, orb_type=1)
ordm2 = driver.get_orbital_entropies(ket, orb_type=2)
minfo = 0.5 * (ordm1[:, None] + ordm1[None, :] - ordm2) * (1 - np.identity(len(ordm1)))

with h5py.File("minfo_data.h5", "w") as f:
    f.create_dataset("minfo", data=minfo)
    f.create_dataset("ordm1", data=ordm1)
    f.create_dataset("ordm2", data=ordm2)

    # 可选：写入注释
    f.attrs["description"] = (
        "Mutual information matrix computed from 1-RDM and 2-RDM orbital entropies."
    )
    f.attrs["formula"] = (
        "minfo = 0.5 * (ordm1[:, None] + ordm1[None, :] - ordm2) * (1 - I)"
    )

print("已保存为 minfo_data.h5")

import matplotlib.pyplot as plt

if not os.path.exists("minfo_data.h5"):
    print("minfo_data.h5 not found. Please run the DMRG calculation first.")
    exit()

with h5py.File("minfo_data.h5", "r") as f:
    minfo = f["minfo"][:]
    # ordm1 = f["ordm1"][:]   # 可选
    # ordm2 = f["ordm2"][:]   # 可选

fig, ax = plt.subplots(figsize=(6, 6))  # 图像尺寸可调整
cax = ax.imshow(minfo, cmap="ocean_r")  # 使用你原来的颜色风格

# 添加 colorbar
cbar = fig.colorbar(cax, ax=ax, fraction=0.046, pad=0.04)
cbar.set_label("Mutual Information", fontsize=10)

# 设置坐标轴刻度为 1~N（从1开始）
n = minfo.shape[0]
ax.set_xticks(np.arange(n))
ax.set_yticks(np.arange(n))
ax.set_xticklabels(np.arange(1, n + 1))
ax.set_yticklabels(np.arange(1, n + 1))
ax.tick_params(length=0, labelsize=8)

# 添加细网格线
ax.set_xticks(np.arange(-0.5, n, 1), minor=True)
ax.set_yticks(np.arange(-0.5, n, 1), minor=True)
ax.grid(which="minor", color="gray", linestyle="-", linewidth=0.3)
ax.tick_params(which="minor", bottom=False, left=False)

# 保持正方形比例
ax.set_aspect("equal")

# 保存图片
plt.tight_layout()
plt.savefig("minfo_matrix_oceanr.png", dpi=600)
plt.close()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='cu09', release='5.15.0-133-generic', version='#144-Ubuntu SMP Fri Feb 7 20:47:38 UTC 2025', machine='x86_64')  Threads 32
Python 3.11.13 (main, Jun  5 2025, 13:12:00) [GCC 11.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Wed Jul 30 15:48:30 2025
PySCF version 2.9.0
PySCF path  /home/Yxwxwx/.conda/envs/pyscf_311/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 53
[INPUT] num. electrons = 301
[INPUT] charge = -2
[INPUT] spin (= nelec alpha-beta = 2S) = 3
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Co    11.044040000000   1.049000000000   3.343780000000 AA   20.870210908742   1.982322704669   6.318828420798 Bohr   0.0
[INPUT]  2 S      8.778230000000   3.009360000000   4.338210000000 AA   16.588450558441   5.686866210221   8.198028770849 Bohr   0.0
[INPUT]  3 S     11.436220000000   3.021510000000   0.927300000000 AA   21.611323700273   5.709826382635   1.752343035309 Bohr   0.0
[INPUT]  4 S     10.911080000000  -2.028780000000   2.572310000000 AA   20.618952923219  -3.833838566995   4.860961407480 Bohr   0.0
[INPUT]  5 S     13.086350000000   0.195190000000   5.607710000000 AA   24.729617470202   0.368855642254  10.597036085985 Bohr   0.0
[INPUT]  6 O     11.831670000000  -0.457680000000   5.965830000000 AA   22.358615896233  -0.864889852691  11.273784805714 Bohr   0.0
[INPUT]  7 O     12.190190000000   3.072830000000  -0.307090000000 AA   23.036120506412   5.806807127347  -0.580315995593 Bohr   0.0
[INPUT]  8 O      7.932630000000   3.087380000000   5.514620000000 AA   14.990498147509   5.834302642460  10.421121481049 Bohr   0.0
[INPUT]  9 O     10.078600000000   2.538580000000   0.821770000000 AA   19.045793719041   4.797220945298   1.552920237384 Bohr   0.0
[INPUT] 10 N     10.129890000000  -0.709780000000   2.995720000000 AA   19.142717771970  -1.341289808694   5.661090345882 Bohr   0.0
[INPUT] 11 O     13.745290000000   0.856690000000   6.719380000000 AA   25.974833602723   1.618909473654  12.697787926880 Bohr   0.0
[INPUT] 12 O     10.274270000000  -2.765100000000   1.496670000000 AA   19.415556429835  -5.225281707035   2.828296398853 Bohr   0.0
[INPUT] 13 O     10.002040000000   3.777010000000   4.382100000000 AA   18.901116286945   7.137514469743   8.280968850457 Bohr   0.0
[INPUT] 14 O     12.279510000000  -1.599560000000   2.301250000000 AA   23.204910843858  -3.022730319809   4.348732244155 Bohr   0.0
[INPUT] 15 N     12.763690000000   1.147470000000   4.380640000000 AA   24.119878438850   2.168404036155   8.278209850315 Bohr   0.0
[INPUT] 16 N      9.203590000000   1.512600000000   3.968930000000 AA   17.392264462786   2.858399736017   7.500190707570 Bohr   0.0
[INPUT] 17 N     12.132220000000   2.149160000000   2.069880000000 AA   22.926573082971   4.061323797870   3.911506310715 Bohr   0.0
[INPUT] 18 C      6.102750000000  -0.600270000000   4.185850000000 AA   11.532526106689  -1.134345900793   7.910110098511 Bohr   0.0
[INPUT] 19 H      5.209990000000  -0.543520000000   4.440810000000 AA    9.845454211723  -1.027103943224   8.391914671230 Bohr   0.0
[INPUT] 20 C     13.461880000000   2.406050000000   2.476830000000 AA   25.439266321760   4.546775542010   4.680530357106 Bohr   0.0
[INPUT] 21 C      8.768880000000  -0.757900000000   3.381090000000 AA   16.570781619176  -1.432223429808   6.389334102506 Bohr   0.0
[INPUT] 22 C      7.812800000000   3.620670000000   2.987120000000 AA   14.764052266002   6.842074687429   5.644838701211 Bohr   0.0
[INPUT] 23 H      6.989190000000   3.130060000000   2.933720000000 AA   13.207654932549   5.914956153456   5.543927326159 Bohr   0.0
[INPUT] 24 H      8.302930000000   3.513720000000   2.169190000000 AA   15.690263731435   6.639968478407   4.099175012145 Bohr   0.0
[INPUT] 25 H      7.622360000000   4.551210000000   3.125760000000 AA   14.404172822840   8.600540435382   5.906830331120 Bohr   0.0
[INPUT] 26 C     14.427920000000   3.121750000000   1.755660000000 AA   27.264817347135   5.899252529361   3.317716567854 Bohr   0.0
[INPUT] 27 H     14.215360000000   3.465760000000   0.918160000000 AA   26.863137162097   6.549337213473   1.735070938531 Bohr   0.0
[INPUT] 28 C     13.810060000000   1.853100000000   3.735180000000 AA   26.097231163811   3.501851481432   7.058467225953 Bohr   0.0
[INPUT] 29 C     11.003810000000  -3.088820000000   3.983560000000 AA   20.794187226750  -5.837023848079   7.527837400772 Bohr   0.0
[INPUT] 30 H     11.425040000000  -2.620110000000   4.707850000000 AA   21.590196562201  -4.951290316234   8.896547135534 Bohr   0.0
[INPUT] 31 H     11.518610000000  -3.868610000000   3.764080000000 AA   21.767018235676  -7.310613382754   7.113080310953 Bohr   0.0
[INPUT] 32 H     10.118590000000  -3.352260000000   4.243280000000 AA   19.121363866763  -6.334853298334   8.018637069844 Bohr   0.0
[INPUT] 33 C     11.350660000000   4.677500000000   1.548070000000 AA   21.449638733056   8.839193947653   2.925428321655 Bohr   0.0
[INPUT] 34 H     10.855060000000   4.685500000000   2.370380000000 AA   20.513090465721   8.854311756650   4.479369011147 Bohr   0.0
[INPUT] 35 H     10.910960000000   5.238610000000   0.903530000000 AA   20.618726156084   9.899538173408   1.707424245328 Bohr   0.0
[INPUT] 36 H     12.238070000000   5.006810000000   1.706460000000 AA   23.126600593256   9.461499657734   3.224742042525 Bohr   0.0
[INPUT] 37 C     15.091470000000   2.062510000000   4.237610000000 AA   28.518745117090   3.897579029177   8.007922322718 Bohr   0.0
[INPUT] 38 H     15.323720000000   1.705710000000   5.064500000000 AA   28.957634009520   3.223324747932   9.570517957860 Bohr   0.0
[INPUT] 39 C     15.701430000000   3.322690000000   2.280210000000 AA   29.671402464030   6.278974096831   4.308972406494 Bohr   0.0
[INPUT] 40 H     16.329990000000   3.809460000000   1.797910000000 AA   30.859208716886   7.198836082486   3.397557496617 Bohr   0.0
[INPUT] 41 C      6.915660000000   0.527700000000   4.273820000000 AA   13.068703370610   0.997208475933   8.076349305689 Bohr   0.0
[INPUT] 42 H      6.561400000000   1.326840000000   4.590790000000 AA   12.399248993721   2.507364211118   8.675335795392 Bohr   0.0
[INPUT] 43 C     14.178660000000  -1.054600000000   5.000850000000 AA   26.793784213326  -1.992905170966   9.450236890031 Bohr   0.0
[INPUT] 44 H     13.766920000000  -1.507480000000   4.261570000000 AA   26.015708378797  -2.848724338259   8.053200160663 Bohr   0.0
[INPUT] 45 H     14.363630000000  -1.684920000000   5.700990000000 AA   27.143326854586  -3.184037341802  10.773309738884 Bohr   0.0
[INPUT] 46 H     14.999230000000  -0.649030000000   4.709680000000 AA   28.344436779360  -1.226488946626   8.900005334342 Bohr   0.0
[INPUT] 47 C      8.260270000000   0.468710000000   3.888090000000 AA   15.609648014961   0.885733531845   7.347425247660 Bohr   0.0
[INPUT] 48 C      7.934810000000  -1.870200000000   3.306650000000 AA   14.994617750460  -3.534165798162   6.248662889793 Bohr   0.0
[INPUT] 49 H      8.267690000000  -2.672860000000   2.973950000000 AA   15.623669782805  -5.050973369305   5.619951008150 Bohr   0.0
[INPUT] 50 C      6.604550000000  -1.797790000000   3.725490000000 AA   12.480790675996  -3.397330729482   7.040155779806 Bohr   0.0
[INPUT] 51 H      6.061920000000  -2.552960000000   3.694580000000 AA   11.455368589023  -4.824395206970   6.981744345296 Bohr   0.0
[INPUT] 52 C     16.033210000000   2.800590000000   3.517170000000 AA   30.298375797638   5.292348087196   6.646488033536 Bohr   0.0
[INPUT] 53 H     16.882950000000   2.941420000000   3.868340000000 AA   31.904151674726   5.558478217318   7.310103156700 Bohr   0.0

nuclear repulsion = 5792.68230398633
number of shells = 275
number of NR pGTOs = 1208
number of NR cGTOs = 617
basis = {'default': 'def2tzvp', 'C': '6-31G*', 'H': '6-31G*', 'S': '6-31G*', 'O': '6-31G*'}
ecp = {}
CPU time:         7.50


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = chk
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'liblan.utils.rdiis.tag_rdiis_.<locals>.RDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = CoNSPh2_rohf.chk
max_memory 200000 MB (current use 142 MB)
num. doubly occ = 149  num. singly occ = 3


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -4418.46313159218
  HOMO = 0.14159362838631  LUMO = 0.347708864535288
cycle= 1 E= -4418.46313159225  delta_E= -6.73e-11  |g|= 4.28e-06  |ddm|= 8.12e-06
  HOMO = 0.14159338761562  LUMO = 0.347708867879449
Extra cycle  E= -4418.46313159226  delta_E= -1.09e-11  |g|= 5.48e-06  |ddm|= 1.12e-05
converged SCF energy = -4418.46313159226
nao =  617
nelec =  (152, 149)
imp_inds.shape (45,)
nimp =  45
act_inds =  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522]
nao =  103
nelec =  (58, 55)


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = 1e
damping factor = 0
level_shift factor = 0.2
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1000
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /tmp/tmpbamtk7y2
max_memory 200000 MB (current use 146369 MB)
num. doubly occ = 55  num. singly occ = 3


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -2557.27309847269
  HOMO = 1.76572905010471  LUMO = 1.77738749799762
cycle= 1 E= -2666.33641658891  delta_E= -109  |g|= 5.31  |ddm|= 10.8

WARN: HOMO -0.280904890895324 >= LUMO -0.387693850176367

cycle= 2 E= -2643.49127918719  delta_E= 22.8  |g|= 14.8  |ddm|= 5.37
  HOMO = -0.00659001439810568  LUMO = 0.0895538543010641
cycle= 3 E= -2666.29198615346  delta_E= -22.8  |g|=  8.8  |ddm|= 2.73
  HOMO = -0.1061659531185  LUMO = 0.351309361739396
cycle= 4 E= -2670.32544526995  delta_E= -4.03  |g|= 6.51  |ddm|= 0.842
  HOMO = 0.0114455725806384  LUMO = 0.736006715617144
cycle= 5 E= -2674.01087698741  delta_E= -3.69  |g|= 3.75  |ddm|= 1.16
  HOMO = 0.136069768304963  LUMO = 0.788398462578318
cycle= 6 E= -2676.37610081072  delta_E= -2.37  |g|= 1.14  |ddm|=  1.4
  HOMO = 0.370847691258341  LUMO = 0.821336645867768
cycle= 7 E= -2677.0287645194  delta_E= -0.653  |g|= 0.368  |ddm|= 1.19
  HOMO = 0.271509849146092  LUMO = 0.823347723740476
cycle= 8 E= -2677.09768545615  delta_E= -0.0689  |g|= 0.225  |ddm|= 0.633
  HOMO = 0.26354513484976  LUMO = 0.811967610620095
cycle= 9 E= -2677.11047005967  delta_E= -0.0128  |g|= 0.143  |ddm|= 0.231
  HOMO = 0.244260993222694  LUMO = 0.806158744245845
cycle= 10 E= -2677.1148457699  delta_E= -0.00438  |g|= 0.0622  |ddm|= 0.0783
  HOMO = 0.242328467470293  LUMO = 0.801764885545225
cycle= 11 E= -2677.11560096477  delta_E= -0.000755  |g|= 0.0121  |ddm|= 0.0282
  HOMO = 0.242135540571244  LUMO = 0.80153596686422
cycle= 12 E= -2677.11565312875  delta_E= -5.22e-05  |g|= 0.00301  |ddm|= 0.0104
  HOMO = 0.242279680332628  LUMO = 0.801707633669787
cycle= 13 E= -2677.11565910861  delta_E= -5.98e-06  |g|= 0.00277  |ddm|= 0.00451
  HOMO = 0.242154344239514  LUMO = 0.801810219266745
cycle= 14 E= -2677.1156703351  delta_E= -1.12e-05  |g|= 0.00137  |ddm|= 0.00574
  HOMO = 0.242188538585094  LUMO = 0.801866745168333
cycle= 15 E= -2677.1156753007  delta_E= -4.97e-06  |g|= 0.000947  |ddm|= 0.00386
  HOMO = 0.241961754455137  LUMO = 0.801871329223287
cycle= 16 E= -2677.11568044765  delta_E= -5.15e-06  |g|= 0.000703  |ddm|= 0.00517
  HOMO = 0.24174471541133  LUMO = 0.801879817381201
cycle= 17 E= -2677.11568472634  delta_E= -4.28e-06  |g|= 0.000403  |ddm|= 0.00662
  HOMO = 0.241714905596345  LUMO = 0.801891009601761
cycle= 18 E= -2677.11568572048  delta_E= -9.94e-07  |g|= 0.000256  |ddm|= 0.00258
  HOMO = 0.241618888988729  LUMO = 0.801902778736399
cycle= 19 E= -2677.11568640562  delta_E= -6.85e-07  |g|= 0.000166  |ddm|= 0.00316
  HOMO = 0.241611515818158  LUMO = 0.801905338739816
cycle= 20 E= -2677.11568654066  delta_E= -1.35e-07  |g|= 0.000114  |ddm|= 0.00103
  HOMO = 0.241589382373694  LUMO = 0.801904006499754
cycle= 21 E= -2677.11568661073  delta_E= -7.01e-08  |g|= 0.0001  |ddm|= 0.000629
  HOMO = 0.241584238185168  LUMO = 0.801903624950324
cycle= 22 E= -2677.1156866878  delta_E= -7.71e-08  |g|= 8.12e-05  |ddm|= 0.00073
  HOMO = 0.241586125990305  LUMO = 0.801904827576618
cycle= 23 E= -2677.11568677748  delta_E= -8.97e-08  |g|= 6.14e-05  |ddm|= 0.000992
  HOMO = 0.241587085115211  LUMO = 0.801904078452449
cycle= 24 E= -2677.11568681444  delta_E= -3.7e-08  |g|= 5.36e-05  |ddm|= 0.000504
  HOMO = 0.241591462923215  LUMO = 0.801903561204179
cycle= 25 E= -2677.11568685753  delta_E= -4.31e-08  |g|= 4.63e-05  |ddm|= 0.000729
  HOMO = 0.241592779963614  LUMO = 0.801903598226409
cycle= 26 E= -2677.11568689029  delta_E= -3.28e-08  |g|= 3.95e-05  |ddm|= 0.000658
  HOMO = 0.241594891313021  LUMO = 0.801903420287943
cycle= 27 E= -2677.11568690856  delta_E= -1.83e-08  |g|= 3.63e-05  |ddm|= 0.000394
  HOMO = 0.241594036866906  LUMO = 0.801903561774989
cycle= 28 E= -2677.11568692352  delta_E= -1.5e-08  |g|= 3.52e-05  |ddm|= 0.000346
  HOMO = 0.241594615971843  LUMO = 0.80190339987145
cycle= 29 E= -2677.1156869282  delta_E= -4.69e-09  |g|= 3.68e-05  |ddm|= 0.000106
  HOMO = 0.241594289296441  LUMO = 0.801903405017418
cycle= 30 E= -2677.11568692841  delta_E= -2.1e-10  |g|= 3.84e-05  |ddm|= 8.59e-06
  HOMO = 0.241593970679052  LUMO = 0.801903412958512
cycle= 31 E= -2677.11568693251  delta_E= -4.09e-09  |g|= 3.76e-05  |ddm|= 8.74e-05
  HOMO = 0.241594349032797  LUMO = 0.801903536207498
cycle= 32 E= -2677.11568693791  delta_E= -5.4e-09  |g|= 3.7e-05  |ddm|= 0.000114
  HOMO = 0.241594489881728  LUMO = 0.801903538371055
cycle= 33 E= -2677.11568693867  delta_E= -7.64e-10  |g|= 3.84e-05  |ddm|= 1.85e-05
  HOMO = 0.241595359469931  LUMO = 0.801903505914206
cycle= 34 E= -2677.11568693332  delta_E= 5.35e-09  |g|= 4.09e-05  |ddm|= 0.000114
  HOMO = 0.241595475742589  LUMO = 0.801903467713303
cycle= 35 E= -2677.115686924  delta_E= 9.32e-09  |g|= 4.2e-05  |ddm|= 0.000197
  HOMO = 0.241595852007287  LUMO = 0.801903422263566
cycle= 36 E= -2677.11568690852  delta_E= 1.55e-08  |g|= 4.46e-05  |ddm|= 0.000331
  HOMO = 0.241595921480417  LUMO = 0.801903411057407
cycle= 37 E= -2677.11568690492  delta_E= 3.61e-09  |g|= 3.96e-05  |ddm|= 8.19e-05
  HOMO = 0.241596323047197  LUMO = 0.801903277833485
cycle= 38 E= -2677.1156868938  delta_E= 1.11e-08  |g|= 4.2e-05  |ddm|= 0.00024
  HOMO = 0.241596831886742  LUMO = 0.801903297441184
cycle= 39 E= -2677.11568688429  delta_E= 9.51e-09  |g|= 4.13e-05  |ddm|= 0.000208
  HOMO = 0.241597035625654  LUMO = 0.801903300509644
cycle= 40 E= -2677.11568688149  delta_E= 2.81e-09  |g|= 3.84e-05  |ddm|= 6.28e-05
  HOMO = 0.241597217833262  LUMO = 0.801903204973907
cycle= 41 E= -2677.11568686579  delta_E= 1.57e-08  |g|= 4.4e-05  |ddm|= 0.000345
  HOMO = 0.241598415851571  LUMO = 0.801903134947983
cycle= 42 E= -2677.11568684334  delta_E= 2.24e-08  |g|= 4.77e-05  |ddm|= 0.000507
  HOMO = 0.241597805833634  LUMO = 0.801903109123129
cycle= 43 E= -2677.11568682848  delta_E= 1.49e-08  |g|= 4.31e-05  |ddm|= 0.000354
  HOMO = 0.241598186751606  LUMO = 0.801903227204519
cycle= 44 E= -2677.11568680348  delta_E= 2.5e-08  |g|= 4.82e-05  |ddm|= 0.00063
  HOMO = 0.241597107680681  LUMO = 0.801903110162906
cycle= 45 E= -2677.11568676164  delta_E= 4.18e-08  |g|= 6.03e-05  |ddm|= 0.00107
  HOMO = 0.241595367699923  LUMO = 0.801903237931641
cycle= 46 E= -2677.11568672605  delta_E= 3.56e-08  |g|= 5.61e-05  |ddm|= 0.001
  HOMO = 0.241595002433714  LUMO = 0.801903456308129
cycle= 47 E= -2677.11568666448  delta_E= 6.16e-08  |g|= 7.91e-05  |ddm|= 0.00183
  HOMO = 0.24159459916459  LUMO = 0.801903372181333
cycle= 48 E= -2677.11568671531  delta_E= -5.08e-08  |g|= 4.29e-05  |ddm|= 0.0015
  HOMO = 0.241590338650137  LUMO = 0.801903363499381
cycle= 49 E= -2677.11568658272  delta_E= 1.33e-07  |g|= 0.000156  |ddm|= 0.00433
  HOMO = 0.241588603063133  LUMO = 0.801903497661888
cycle= 50 E= -2677.11568657132  delta_E= 1.14e-08  |g|= 4.43e-05  |ddm|= 0.000704
  HOMO = 0.241588246276618  LUMO = 0.801903478604439
cycle= 51 E= -2677.11568656434  delta_E= 6.98e-09  |g|= 2.8e-05  |ddm|= 0.000337
  HOMO = 0.24158753236357  LUMO = 0.801903548910455
cycle= 52 E= -2677.1156865291  delta_E= 3.52e-08  |g|= 6.86e-05  |ddm|= 0.00172
  HOMO = 0.24158726978706  LUMO = 0.801903448904252
cycle= 53 E= -2677.11568652649  delta_E= 2.6e-09  |g|= 2.38e-05  |ddm|= 0.000208
  HOMO = 0.241588319648056  LUMO = 0.80190336496931
cycle= 54 E= -2677.11568651221  delta_E= 1.43e-08  |g|= 3.92e-05  |ddm|= 0.000875
  HOMO = 0.241590092889397  LUMO = 0.801903179619689
cycle= 55 E= -2677.11568650014  delta_E= 1.21e-08  |g|= 3.85e-05  |ddm|= 0.000872
  HOMO = 0.241591138703838  LUMO = 0.801903101172065
cycle= 56 E= -2677.1156864965  delta_E= 3.65e-09  |g|= 2.08e-05  |ddm|= 0.000327
  HOMO = 0.241591723596269  LUMO = 0.80190280458
cycle= 57 E= -2677.11568649344  delta_E= 3.06e-09  |g|= 1.81e-05  |ddm|= 0.000286
  HOMO = 0.241593397799804  LUMO = 0.801902907468168
cycle= 58 E= -2677.11568648141  delta_E= 1.2e-08  |g|= 4.32e-05  |ddm|= 0.00112
  HOMO = 0.241594496507062  LUMO = 0.801902737128496
cycle= 59 E= -2677.11568647251  delta_E= 8.91e-09  |g|= 4.39e-05  |ddm|= 0.00116
  HOMO = 0.241593877740251  LUMO = 0.80190276080096
cycle= 60 E= -2677.11568647013  delta_E= 2.37e-09  |g|= 2.07e-05  |ddm|= 0.000495
  HOMO = 0.241593901317991  LUMO = 0.801902721977953
cycle= 61 E= -2677.11568646735  delta_E= 2.78e-09  |g|= 2.45e-05  |ddm|= 0.00064
  HOMO = 0.241593648229309  LUMO = 0.801902723684495
cycle= 62 E= -2677.11568646554  delta_E= 1.81e-09  |g|= 2.39e-05  |ddm|= 0.000649
  HOMO = 0.2415935547976  LUMO = 0.801902753318244
cycle= 63 E= -2677.11568646553  delta_E= 1.41e-11  |g|= 5.51e-06  |ddm|= 9.32e-05
  HOMO = 0.141593301730173  LUMO = 0.601902737878154
Extra cycle  E= -2677.11568646555  delta_E= -2.68e-11  |g|= 3.23e-06  |ddm|= 1.05e-05
converged SCF energy = -2677.11568646555

Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =      4.492 | E =   -2677.2096715535 | DW = 2.03035e-06

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =      8.687 | E =   -2677.2157692690 | DE = -6.10e-03 | DW = 2.29688e-06

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =     12.215 | E =   -2677.2160469409 | DE = -2.78e-04 | DW = 3.29156e-06

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =     15.924 | E =   -2677.2164790212 | DE = -4.32e-04 | DW = 2.49307e-06

Sweep =    4 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     25.005 | E =   -2677.2172047155 | DE = -7.26e-04 | DW = 1.77796e-07

Sweep =    5 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     41.477 | E =   -2677.2178734650 | DE = -6.69e-04 | DW = 2.80717e-07

Sweep =    6 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     54.480 | E =   -2677.2180250268 | DE = -1.52e-04 | DW = 4.55976e-07

Sweep =    7 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     69.011 | E =   -2677.2180632778 | DE = -3.83e-05 | DW = 4.16914e-07

Sweep =    8 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    101.201 | E =   -2677.2180879991 | DE = -2.47e-05 | DW = 1.95716e-19

Sweep =    9 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    218.536 | E =   -2677.2180932612 | DE = -5.26e-06 | DW = 1.76877e-09

Sweep =   10 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    399.334 | E =   -2677.2180934699 | DE = -2.09e-07 | DW = 6.45638e-09

Sweep =   11 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    580.568 | E =   -2677.2180934912 | DE = -2.13e-08 | DW = 6.49471e-09

Sweep =   12 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    762.758 | E =   -2677.2180935047 | DE = -1.36e-08 | DW = 6.70439e-09

Sweep =   13 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    941.022 | E =   -2677.2180935053 | DE = -5.34e-10 | DW = 6.71729e-09

DMRG energy = -2677.218093505257912
已保存为 minfo_data.h5
