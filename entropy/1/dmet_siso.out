#INFO: **** input file is /home/Yxwxwx/code/dmet/test/entropy/1/dmet_siso.py ****
from pyscf import gto, scf, ao2mo, mcscf, fci, dmrgscf, lib

# from pyscf.csf_fci import csf_solver  # TODO:
from pyscf.mcscf import avas
from pyscf.tools import molden, fcidump
from pyscf.lib import logger, cho_solve
from pyscf.data import nist
import numpy as np
import scipy
from functools import reduce
import os
import tempfile
from liblan.utils.rdiis import tag_rdiis_
import h5py
from pyblock2._pyscf.ao2mo import integrals as itg
from pyblock2.driver.core import DMRGDriver, SymmetryTypes

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ""


def read_cas_info(fname):
    with open(fname, "r") as f1:
        ncasorb, ncaselec = [int(x) for x in f1.readline().split(" ")]
        casorbind = [int(x) for x in f1.readline().split(" ")]
        statelis = [int(x) for x in f1.readline().split(" ")]
    return ncasorb, ncaselec, casorbind, statelis


def sacasscf_dump_chk(solver, sav):
    # saving properties for SISO
    with h5py.File(sav, "w") as fh5:
        fh5["ncore"] = np.asarray(solver.ncore)
        fh5["ncas"] = np.asarray(solver.ncas)
        fh5["nelecas"] = np.asarray(solver.nelecas)
        fh5["mo_coeff"] = solver.mo_coeff
        fh5["rdm1"] = solver.make_rdm1()

        # for i in range(len(solver.ci)):
        #     fh5["ci" + str(i)] = solver.ci[i]
        # fh5["e_states"] = solver.e_states


def sacasscf_load_chk(solver, sav):
    with h5py.File(sav, "r") as fh5:
        solver.ncore = fh5["ncore"][()]
        solver.ncas = fh5["ncas"][()]
        solver.nelecas = fh5["nelecas"][:]

        solver.mo_coeff = fh5["mo_coeff"][:]
        rdm1 = fh5["rdm1"][:]
        solver.make_rdm1 = lambda *args: rdm1

        # solver.e_states = fh5["e_states"][:]
        # solver.ci = [fh5["ci" + str(i)][:] for i in range(len(solver.e_states))]
    return solver


def rohf_solve_imp(hcore, eris, nelec, spin, max_mem, dm0=None, verbose=logger.INFO):
    mol = gto.M()
    mol.verbose = verbose
    mol.incore_anyway = True
    mol.nelectron = nelec
    mol.spin = spin

    nao = hcore.shape[0]
    print("nao = ", nao)
    print("nelec = ", mol.nelec)

    mf = scf.rohf.ROHF(mol).x2c()
    mf.max_memory = max_mem
    mf.mo_energy = np.zeros((nao))
    mf.max_cycle = 1000
    mf.diis_space = 8
    mf.init_guess = "1e"
    mf.level_shift = 0.2

    mf.get_hcore = lambda *args: hcore
    mf.get_ovlp = lambda *args: np.eye(nao)
    mf._eri = ao2mo.restore(8, eris, nao)

    if dm0 is None:
        mf.kernel()
    else:
        if dm0.shape != hcore.shape:
            bath_size = hcore.shape[0] - dm0.shape[0]
            dm0 = scipy.linalg.block_diag(
                dm0, np.eye(bath_size) * (nelec - np.trace(dm0)) / bath_size
            )
        mf.kernel(dm0)
    return mf


def sacasscf_solve_imp(
    solver_base, mol, ncasorb, ncaselec, casorbind, statelis, avas=False
):
    solver = mcscf.CASSCF(solver_base, ncasorb, ncaselec)

    if avas:
        mo = casorbind
    else:
        mo = solver.sort_mo(casorbind)
    mcfs = []
    logger.info(solver, "Attempting SA-DMRGSCF with")
    for i in range(len(statelis)):
        if statelis[i] != 0:
            new_mcf = dmrgscf.DMRGCI(mol, maxM=1500, tol=1e-10)
            new_mcf.spin = i
            new_mcf.nroots = statelis[i]
            new_mcf.threads = 32
            new_mcf.memory = int(mol.max_memory / 1000)
            new_mcf.block_extra_keyword = [
                "real_density_matrix",
                "davidson_soft_max_iter 1600",
                "noreorder",
                "cutoff 1E-24",
            ]
            new_mcf.runtimeDir = lib.param.TMPDIR + "/%d" % i
            new_mcf.scratchDirectory = lib.param.TMPDIR + "/%d" % i
            mcfs.append(new_mcf)
            logger.info(
                solver, "%s states with spin multiplicity %s", statelis[i], i + 1
            )

    statetot = sum(statelis)
    mcscf.state_average_mix_(solver, mcfs, np.ones(statetot) / statetot)
    solver.run(mo, verbose=mol.verbose)
    return solver


def lowdin(s):
    """new basis is |mu> c^{lowdin}_{mu i}"""
    e, v = scipy.linalg.eigh(s)
    idx = e > 1e-15
    return np.dot(v[:, idx] / np.sqrt(e[idx]), v[:, idx].conj().T)


def caolo(s):
    return lowdin(s)


def cloao(s):
    return lowdin(s) @ s


def get_dmet_as_props(mf, imp_inds, lo_meth="lowdin", thres=1e-13):
    """
    Returns C(AO->AS), entropy loss, and orbital composition
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)
    env_inds = [x for x in range(s.shape[0]) if x not in imp_inds]

    if mf.mol.spin == 0:
        pass
    else:
        dma, dmb = mf.make_rdm1()

        ldma = reduce(np.dot, (cloao_mat, dma, cloao_mat.conj().T))
        ldmb = reduce(np.dot, (cloao_mat, dmb, cloao_mat.conj().T))

        ldma_env = ldma[env_inds, :][:, env_inds]
        ldmb_env = ldmb[env_inds, :][:, env_inds]

        nat_occa, nat_coeffa = np.linalg.eigh(ldma_env)
        nat_occb, nat_coeffb = np.linalg.eigh(ldmb_env)

        ldmr_env = ldma_env + ldmb_env
        nat_occr, nat_coeffr = np.linalg.eigh(ldmr_env)

        caoas = np.hstack([caolo_mat[:, imp_inds], caolo_mat[:, env_inds] @ nat_coeffr])

        nuu = np.sum([nat_occr < thres])
        ne = np.sum([(nat_occr >= thres) & (nat_occr <= 2 - thres)])
        nuo = np.sum([nat_occr > 2 - thres])

        asorbs = (nuu, ne, nuo)
        print("caoas.shape = ", caoas.shape)
        print("asorbs = ", asorbs)

        nat_occa = nat_occa[nat_occa > thres]
        nat_occb = nat_occb[nat_occb > thres]
        nat_occr = nat_occr[nat_occr > thres]

        ent = -np.sum(nat_occa * np.log(nat_occa)) - np.sum(nat_occb * np.log(nat_occb))
        entr = -2 * np.sum(nat_occr / 2 * np.log(nat_occr / 2))

        return caoas, entr - ent, asorbs


def get_dmet_imp_ldm(mf, imp_inds, lo_meth="lowdin"):
    """
    Returns better initial guess than '1e' for impurity
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)

    dma, dmb = mf.make_rdm1()

    ldm = reduce(np.dot, (cloao_mat, (dma + dmb), cloao_mat.conj().T))[imp_inds, :][
        :, imp_inds
    ]
    return ldm


def get_as_1e_ints(mf, caoas, asorbs):
    # hcore from mf
    hcore = mf.get_hcore()

    # HF J/K from env UO
    uos = hcore.shape[0] - asorbs[-1]
    dm_uo = caoas[:, uos:] @ caoas[:, uos:].conj().T * 2
    vj, vk = mf.get_jk(dm=dm_uo)

    fock = hcore + vj - 0.5 * vk

    nimp = hcore.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    asints1e = reduce(np.dot, (caoas[:, act_inds].conj().T, fock, caoas[:, act_inds]))
    return asints1e


def get_as_2e_ints(mf, caoas, asorbs):
    nimp = caoas.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    if mf._eri is not None:
        asints2e = ao2mo.full(mf._eri, caoas[:, act_inds])
    else:
        asints2e = ao2mo.full(mf.mol, caoas[:, act_inds])

    return asints2e


def get_bp_hso2e(mol, dm0):
    hso2e = mol.intor("int2e_p1vxp1", 3).reshape(3, mol.nao, mol.nao, mol.nao, mol.nao)
    vj = np.einsum("yijkl,lk->yij", hso2e, dm0, optimize=True)
    vk = np.einsum("yijkl,jk->yil", hso2e, dm0, optimize=True)
    vk += np.einsum("yijkl,li->ykj", hso2e, dm0, optimize=True)
    return vj, vk


def get_bp_hso2e_amfi(mol, dm0):
    """atomic-mean-field approximation"""
    ao_loc = mol.ao_loc_nr()
    nao = ao_loc[-1]
    vj = np.zeros((3, nao, nao))
    vk = np.zeros((3, nao, nao))
    import copy

    atom = copy.copy(mol)
    aoslice = mol.aoslice_by_atom(ao_loc)
    for ia in range(mol.natm):
        b0, b1, p0, p1 = aoslice[ia]
        atom._bas = mol._bas[b0:b1]
        vj1, vk1 = get_bp_hso2e(atom, dm0[p0:p1, p0:p1])
        vj[:, p0:p1, p0:p1] = vj1
        vk[:, p0:p1, p0:p1] = vk1
    return vj, vk


mol = gto.M(
    atom="""
            Co   1.506499   10.764206    0.414024
            S    0.900702   12.969251    0.863740
            S   -0.630821    9.850987    0.263627
            S    2.753892   10.415545   -1.502746
            S    3.027943    9.878195    1.923416
            C    2.377311   13.975173    0.913216
            C    2.276518   15.365718    0.836418
            H    1.444112   15.762234    0.713835
            C    3.399137   16.154649    0.937832
            H    3.312247   17.078944    0.888601
            C    4.645140   15.606362    1.112844
            H    5.397607   16.149181    1.179058
            C    4.758096   14.244532    1.186689
            H    5.597454   13.867157    1.321825
            C    3.649380   13.407744    1.065829
            H    3.753648   12.483449    1.085522
            C   -0.483108    8.032887    0.187074
            C   -1.603989    7.293178    0.071383
            H   -2.422493    7.725245   -0.019692
            C   -1.574447    5.919042    0.086153
            H   -2.366884    5.440487    0.000000
            C   -0.364938    5.235392    0.231381
            H   -0.335395    4.306995    0.285534
            C    0.776797    5.988774    0.292919
            H    1.598776    5.558075    0.347072
            C    0.738565    7.384787    0.273226
            H    1.527526    7.875648    0.319995
            C    2.008897   11.246043   -2.857063
            C    0.792437   11.947467   -2.723896
            H    0.359725   11.969345   -1.900278
            C    0.238079   12.605139   -3.809910
            H   -0.559572   13.071388   -3.704557
            C    0.851522   12.577793   -5.050260
            H    0.465730   13.018063   -5.772218
            C    2.036702   11.896878   -5.208288
            H    2.450298   11.872266   -6.040521
            C    2.615389   11.247410   -4.127935
            H    3.423466   10.801671   -4.246087
            C    2.286945    9.211500    3.375947
            C    3.044626    9.114422    4.556237
            H    3.906575    9.464451    4.578390
            C    2.530237    8.503239    5.693449
            H    3.049839    8.432139    6.461437
            C    1.239051    8.001440    5.679173
            H    0.886278    7.585780    6.431899
            C    0.479633    8.125864    4.519314
            H   -0.391005    7.797712    4.514391
            C    0.962741    8.709702    3.404255
            H    0.424023    8.782168    2.648574
        """,
    basis={"default": "def2tzvp", "C": "6-31G*", "H": "6-31G*"},
    symmetry=0,
    spin=3,
    charge=-2,
    verbose=4,
    max_memory=500000,
)

mf = scf.rohf.ROHF(mol).x2c()
mf.max_cycle = 100
title = "CoSPh4"
imp_inds = mol.search_ao_label(["Co *"])
mf.chkfile = title + "_rohf.chk"
mf.init_guess = "atom"
mf.level_shift = 0.2
if os.path.isfile(title + "_rohf.chk"):
    mf.init_guess = "chk"
    mf.level_shift = 0.0
mf = tag_rdiis_(mf=mf, imp_inds=imp_inds)
mf.kernel()

print("nao = ", mol.nao_nr())
print("nelec = ", mol.nelec)


print("imp_inds.shape", imp_inds.shape)

as_fname = title + "_as_chk.h5"
if not os.path.isfile(as_fname):
    # AS general info
    caoas, ent, asorbs = get_dmet_as_props(mf, imp_inds, thres=1e-13)
    # AS hcore + j/k
    as1e = get_as_1e_ints(mf, caoas, asorbs)
    # AS ERIs
    as2e = get_as_2e_ints(mf, caoas, asorbs)

    print(f"Entanglement S: {ent:.3f}")

    with h5py.File(as_fname, "w") as fh5:
        fh5["caoas"] = caoas
        fh5["ent"] = ent
        fh5["asorbs"] = asorbs
        fh5["1e"] = as1e
        fh5["2e"] = as2e
else:
    fh5 = h5py.File(as_fname, "r")
    caoas = fh5["caoas"][:]
    ent = fh5["ent"][()]
    asorbs = fh5["asorbs"][:]
    as1e = fh5["1e"][:]
    as2e = fh5["2e"][:]
    fh5.close()

nimp = caoas.shape[0] - np.sum(asorbs)
print("nimp = ", nimp)
act_inds = [
    *list(range(nimp)),
    *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
]

print("act_inds = ", act_inds)

nelec = int(mf.mol.nelectron - asorbs[-1] * 2)
ldm = get_dmet_imp_ldm(mf, imp_inds)
solver_base = rohf_solve_imp(as1e, as2e, nelec, mf.mol.spin, mf.max_memory, dm0=ldm)

with open(title + "_imp_rohf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver_base.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

# avas
# ao_labels = ["Co 3d"]
# ncasorb, ncaselec, casorbind = avas.avas(solver_base, ao_labels, canonicalize=False)

# ncasorb = 5
# ncaselec = 7
# casorbind = [40, 41, 55, 56, 57]  # F-style

caschk_fname = title + "_imp_cas_chk.h5"


if not os.path.isfile(caschk_fname):
    casinfo_fname = title + "_cas_info"
    if not os.path.isfile(casinfo_fname):
        print("Failed to read saved CAS briefings.")
        exit()
    ncasorb, ncaselec, casorbind, statelis = read_cas_info(casinfo_fname)

    solver = sacasscf_solve_imp(
        solver_base, mf.mol, ncasorb, ncaselec, casorbind, statelis=statelis
    )
    sacasscf_dump_chk(solver, caschk_fname)

else:
    solver = sacasscf_load_chk(lib.StreamObject(), caschk_fname)


with open(title + "_imp_casscf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

huge_casorbind = [
    40,
    42,
    43,
    44,
    45,
    46,
    47,
    48,
    49,
    50,
    51,
    52,
    53,
    54,
    55,
    56,
    57,
    58,
    59,
    60,
    61,
    62,
]
if len(huge_casorbind) != 22:
    print("huge_casorbind must be 22, but got", len(huge_casorbind))
    exit()

mc = mcscf.CASSCF(solver_base, ncas=22, nelecas=31)
mc.mo_coeff = mc.sort_mo(huge_casorbind, solver.mo_coeff)

bond_dims = [250] * 4 + [500] * 4 + [2000]
noises = [1e-4] * 4 + [1e-5] * 4 + [0]
thrds = [1e-10] * 8
ncas = 22
n_elec = 31
spin = 3
ecore = mc.get_h1eff()[1]
h1e = mc.get_h1eff()[0]
g2e = mc.get_h2eff()
orb_sym = [0] * ncas
# ncas, n_elec, spin, ecore, h1e, g2e, orb_sym = itg.get_rhf_integrals(
#     mf, ncore=0, ncas=None, g2e_symm=8
# )
driver = DMRGDriver(
    scratch="./tmp",
    symm_type=SymmetryTypes.SZ,
    n_threads=32,
    stack_mem=int(200 * 1024**3),
)
driver.initialize_system(n_sites=ncas, n_elec=n_elec, spin=spin, orb_sym=orb_sym)

mpo = driver.get_qc_mpo(h1e=h1e, g2e=g2e, ecore=ecore, iprint=0)
ket = driver.get_random_mps(tag="GS", bond_dim=250, nroots=1)
energy = driver.dmrg(
    mpo, ket, n_sweeps=20, bond_dims=bond_dims, noises=noises, thrds=thrds, iprint=1
)
print("DMRG energy = %20.15f" % energy)

ordm1 = driver.get_orbital_entropies(ket, orb_type=1)
ordm2 = driver.get_orbital_entropies(ket, orb_type=2)
minfo = 0.5 * (ordm1[:, None] + ordm1[None, :] - ordm2) * (1 - np.identity(len(ordm1)))

with h5py.File("minfo_data.h5", "w") as f:
    f.create_dataset("minfo", data=minfo)
    f.create_dataset("ordm1", data=ordm1)
    f.create_dataset("ordm2", data=ordm2)

    # 可选：写入注释
    f.attrs["description"] = (
        "Mutual information matrix computed from 1-RDM and 2-RDM orbital entropies."
    )
    f.attrs["formula"] = (
        "minfo = 0.5 * (ordm1[:, None] + ordm1[None, :] - ordm2) * (1 - I)"
    )

print("已保存为 minfo_data.h5")

import matplotlib.pyplot as plt

if not os.path.exists("minfo_data.h5"):
    print("minfo_data.h5 not found. Please run the DMRG calculation first.")
    exit()

with h5py.File("minfo_data.h5", "r") as f:
    minfo = f["minfo"][:]
    # ordm1 = f["ordm1"][:]   # 可选
    # ordm2 = f["ordm2"][:]   # 可选

fig, ax = plt.subplots(figsize=(6, 6))  # 图像尺寸可调整
cax = ax.imshow(minfo, cmap="ocean_r")  # 使用你原来的颜色风格

# 添加 colorbar
cbar = fig.colorbar(cax, ax=ax, fraction=0.046, pad=0.04)
cbar.set_label("Mutual Information", fontsize=10)

# 设置坐标轴刻度为 1~N（从1开始）
n = minfo.shape[0]
ax.set_xticks(np.arange(n))
ax.set_yticks(np.arange(n))
ax.set_xticklabels(np.arange(1, n + 1))
ax.set_yticklabels(np.arange(1, n + 1))
ax.tick_params(length=0, labelsize=8)

# 添加细网格线
ax.set_xticks(np.arange(-0.5, n, 1), minor=True)
ax.set_yticks(np.arange(-0.5, n, 1), minor=True)
ax.grid(which="minor", color="gray", linestyle="-", linewidth=0.3)
ax.tick_params(which="minor", bottom=False, left=False)

# 保持正方形比例
ax.set_aspect("equal")

# 保存图片
plt.tight_layout()
plt.savefig("minfo_matrix_oceanr.png", dpi=600)
plt.close()
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='cu09', release='5.15.0-133-generic', version='#144-Ubuntu SMP Fri Feb 7 20:47:38 UTC 2025', machine='x86_64')  Threads 32
Python 3.11.13 (main, Jun  5 2025, 13:12:00) [GCC 11.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Wed Jul 30 15:08:31 2025
PySCF version 2.9.0
PySCF path  /home/Yxwxwx/.conda/envs/pyscf_311/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 49
[INPUT] num. electrons = 257
[INPUT] charge = -2
[INPUT] spin (= nelec alpha-beta = 2S) = 3
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Co     1.506499000000  10.764206000000   0.414024000000 AA    2.846870516931  20.341401288400   0.782391968997 Bohr   0.0
[INPUT]  2 S      0.900702000000  12.969251000000   0.863740000000 AA    1.702080099848  24.508332430742   1.632232042832 Bohr   0.0
[INPUT]  3 S     -0.630821000000   9.850987000000   0.263627000000 AA   -1.192078923624  18.615667486651   0.498182829041 Bohr   0.0
[INPUT]  4 S      2.753892000000  10.415545000000  -1.502746000000 AA    5.204101656631  19.682527488083  -2.839778374786 Bohr   0.0
[INPUT]  5 S      3.027943000000   9.878195000000   1.923416000000 AA    5.721982990794  18.667083155048   3.634729463606 Bohr   0.0
[INPUT]  6 C      2.377311000000  13.975173000000   0.913216000000 AA    4.492466702916  26.409249513416   1.725728132571 Bohr   0.0
[INPUT]  7 C      2.276518000000  15.365718000000   0.836418000000 AA    4.301995537643  29.036998727300   1.580600945656 Bohr   0.0
[INPUT]  8 H      1.444112000000  15.762234000000   0.713835000000 AA    2.728976173198  29.786305371308   1.348952648129 Bohr   0.0
[INPUT]  9 C      3.399137000000  16.154649000000   0.937832000000 AA    6.423437989876  30.527862248479   1.772245630853 Bohr   0.0
[INPUT] 10 H      3.312247000000  17.078944000000   0.888601000000 AA    6.259239686912  32.274526656784   1.679212524015 Bohr   0.0
[INPUT] 11 C      4.645140000000  15.606362000000   1.112844000000 AA    8.778042410262  29.491749980819   2.102970379365 Bohr   0.0
[INPUT] 12 H      5.397607000000  16.149181000000   1.179058000000 AA   10.199998958035  30.517529226030   2.228096704977 Bohr   0.0
[INPUT] 13 C      4.758096000000  14.244532000000   1.186689000000 AA    8.991498314389  26.918264252603   2.242517205034 Bohr   0.0
[INPUT] 14 H      5.597454000000  13.867157000000   1.321825000000 AA   10.577655054851  26.205128856345   2.497887234603 Bohr   0.0
[INPUT] 15 C      3.649380000000  13.407744000000   1.065829000000 AA    6.896328724465  25.336964108280   2.014124905619 Bohr   0.0
[INPUT] 16 H      3.753648000000  12.483449000000   1.085522000000 AA    7.093366688021  23.590299699976   2.051339282190 Bohr   0.0
[INPUT] 17 C     -0.483108000000   8.032887000000   0.187074000000 AA   -0.912941808586  15.179956419579   0.353518625027 Bohr   0.0
[INPUT] 18 C     -1.603989000000   7.293178000000   0.071383000000 AA   -3.031099916815  13.782108997703   0.134894319950 Bohr   0.0
[INPUT] 19 H     -2.422493000000   7.725245000000  -0.019692000000 AA   -4.577848308676  14.598597295166  -0.037212486845 Bohr   0.0
[INPUT] 20 C     -1.574447000000   5.919042000000   0.086153000000 AA   -2.975273627643  11.185368299798   0.162805574810 Bohr   0.0
[INPUT] 21 H     -2.366884000000   5.440487000000   0.000000000000 AA   -4.472762528615  10.281030414257   0.000000000000 Bohr   0.0
[INPUT] 22 C     -0.364938000000   5.235392000000   0.231381000000 AA   -0.689632872447   9.893457034739   0.437246720428 Bohr   0.0
[INPUT] 23 H     -0.335395000000   4.306995000000   0.285534000000 AA   -0.633804693548   8.139040969871   0.539581059252 Bohr   0.0
[INPUT] 24 C      0.776797000000   5.988774000000   0.292919000000 AA    1.467933584384  11.317142681916   0.553536686681 Bohr   0.0
[INPUT] 25 H      1.598776000000   5.558075000000   0.347072000000 AA    3.021248774528  10.503239529792   0.655871025505 Bohr   0.0
[INPUT] 26 C      0.738565000000   7.384787000000   0.273226000000 AA    1.395685575189  13.955224918248   0.516322310110 Bohr   0.0
[INPUT] 27 H      1.527526000000   7.875648000000   0.319995000000 AA    2.886605788152  14.882817773479   0.604702911230 Bohr   0.0
[INPUT] 28 C      2.008897000000  11.246043000000  -2.857063000000 AA    3.796265142460  21.251941255082  -5.399066590628 Bohr   0.0
[INPUT] 29 C      0.792437000000  11.947467000000  -2.723896000000 AA    1.497488900972  22.577440512279  -5.147417431798 Bohr   0.0
[INPUT] 30 H      0.359725000000  11.969345000000  -1.900278000000 AA    0.679781730159  22.618783940432  -3.591004980536 Bohr   0.0
[INPUT] 31 C      0.238079000000  12.605139000000  -3.809910000000 AA    0.449904106010  23.820260472074  -7.199686459242 Bohr   0.0
[INPUT] 32 H     -0.559572000000  13.071388000000  -3.704557000000 AA   -1.057437826975  24.701343387926  -7.000598142840 Bohr   0.0
[INPUT] 33 C      0.851522000000  12.577793000000  -5.050260000000 AA    1.609143369042  23.768584021472  -9.543608257846 Bohr   0.0
[INPUT] 34 H      0.465730000000  13.018063000000  -5.772218000000 AA    0.880102147994  24.600573742334 -10.907911151285 Bohr   0.0
[INPUT] 35 C      2.036702000000  11.896878000000  -5.208288000000 AA    3.848808977354  22.481841157363  -9.842237897859 Bohr   0.0
[INPUT] 36 H      2.450298000000  11.872266000000  -6.040521000000 AA    4.630392143570  22.435331217986 -11.414930339684 Bohr   0.0
[INPUT] 37 C      2.615389000000  11.247410000000  -4.127935000000 AA    4.942368919200  21.254524510694  -7.800666610006 Bohr   0.0
[INPUT] 38 H      3.423466000000  10.801671000000  -4.246087000000 AA    6.469413136760  20.412199877657  -8.023941531076 Bohr   0.0
[INPUT] 39 C      2.286945000000   9.211500000000   3.375947000000 AA    4.321699711943  17.407212196431   6.379615241047 Bohr   0.0
[INPUT] 40 C      3.044626000000   9.114422000000   4.556237000000 AA    5.753509291730  17.223761363711   8.610040088610 Bohr   0.0
[INPUT] 41 H      3.906575000000   9.464451000000   4.578390000000 AA    7.382356835073  17.885220309366   8.651903191447 Bohr   0.0
[INPUT] 42 C      2.530237000000   8.503239000000   5.693449000000 AA    4.781454960241  16.068792881720  10.759059314179 Bohr   0.0
[INPUT] 43 H      3.049839000000   8.432139000000   6.461437000000 AA    5.763360434017  15.934433354264  12.210346301131 Bohr   0.0
[INPUT] 44 C      1.239051000000   8.001440000000   5.679173000000 AA    2.341467044368  15.120530202140  10.732081584025 Bohr   0.0
[INPUT] 45 H      0.886278000000   7.585780000000   6.431899000000 AA    1.674822690227  14.335046641203  12.154527570864 Bohr   0.0
[INPUT] 46 C      0.479633000000   8.125864000000   4.519314000000 AA    0.906375010304  15.355657485463   8.540265730913 Bohr   0.0
[INPUT] 47 H     -0.391005000000   7.797712000000   4.514391000000 AA   -0.738892363336  14.735540078234   8.530962609201 Bohr   0.0
[INPUT] 48 C      0.962741000000   8.709702000000   3.404255000000 AA    1.819316818890  16.458951406577   6.433109608181 Bohr   0.0
[INPUT] 49 H      0.424023000000   8.782168000000   2.648574000000 AA    0.801287340516  16.595892299919   5.005079480644 Bohr   0.0

nuclear repulsion = 3883.49561326911
number of shells = 251
number of NR pGTOs = 1072
number of NR cGTOs = 569
basis = {'default': 'def2tzvp', 'C': '6-31G*', 'H': '6-31G*'}
ecp = {}
CPU time:         7.57


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = chk
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'liblan.utils.rdiis.tag_rdiis_.<locals>.RDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = CoSPh4_rohf.chk
max_memory 500000 MB (current use 143 MB)
num. doubly occ = 127  num. singly occ = 3


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -3904.54016516905
  HOMO = 0.11976747255034  LUMO = 0.343093645948753
cycle= 1 E= -3904.54016516716  delta_E= 1.89e-09  |g|= 4.81e-05  |ddm|= 8.47e-05
----------SDDIS-Entropy 0.022
  HOMO = 0.11975450033954  LUMO = 0.343093531399371
cycle= 2 E= -3904.54016515732  delta_E= 9.84e-09  |g|= 0.000109  |ddm|= 0.000192
----------SDDIS-Entropy 0.022
  HOMO = 0.119763505643361  LUMO = 0.343093611097652
cycle= 3 E= -3904.54016516949  delta_E= -1.22e-08  |g|= 1.45e-06  |ddm|= 0.000134
----------SDDIS-Entropy 0.022
  HOMO = 0.119763532871375  LUMO = 0.343093611490375
cycle= 4 E= -3904.54016516951  delta_E= -1.55e-11  |g|= 1.06e-06  |ddm|= 1.52e-06
  HOMO = 0.119763449254777  LUMO = 0.343093610713251
Extra cycle  E= -3904.54016516951  delta_E= -4.55e-12  |g|= 1.17e-06  |ddm|= 1.97e-06
converged SCF energy = -3904.54016516951
nao =  569
nelec =  (130, 127)
imp_inds.shape (45,)
nimp =  45
act_inds =  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 454, 455, 456, 457, 458, 459, 460, 461, 462, 463, 464, 465, 466, 467, 468, 469, 470, 471, 472, 473, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495]
nao =  102
nelec =  (57, 54)


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = 1e
damping factor = 0
level_shift factor = 0.2
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1000
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /tmp/tmpyfp9v1_l
max_memory 500000 MB (current use 106136 MB)
num. doubly occ = 54  num. singly occ = 3


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -2411.97444122886
  HOMO = 1.55413232834521  LUMO = 1.59465926244363
cycle= 1 E= -2497.58593419334  delta_E= -85.6  |g|= 4.89  |ddm|= 10.5
  HOMO = -0.297387071589475  LUMO = -0.294592974711967
cycle= 2 E= -2468.58904992288  delta_E=   29  |g|= 16.5  |ddm|= 5.84

WARN: HOMO 0.00590318801483006 >= LUMO -0.0306213665670844

cycle= 3 E= -2490.17205211959  delta_E= -21.6  |g|= 11.3  |ddm|=  2.4
  HOMO = -0.0596812726824787  LUMO = 0.198640879130039
cycle= 4 E= -2497.37353309165  delta_E= -7.2  |g|= 8.69  |ddm|= 1.16
  HOMO = -0.00757414333086896  LUMO = 0.383273040733368
cycle= 5 E= -2502.25617025618  delta_E= -4.88  |g|= 6.17  |ddm|= 1.02
  HOMO = 0.0913353767910692  LUMO = 0.649372626281719
cycle= 6 E= -2505.61399364166  delta_E= -3.36  |g|= 3.72  |ddm|= 1.04
  HOMO = 0.115620068118419  LUMO = 0.738215207510266
cycle= 7 E= -2506.99670102008  delta_E= -1.38  |g|= 2.18  |ddm|= 0.786
  HOMO = 0.279968563324954  LUMO = 0.779968160276898
cycle= 8 E= -2507.88786983322  delta_E= -0.891  |g|= 0.707  |ddm|= 0.953
  HOMO = 0.430115640601843  LUMO = 0.809652527831803
cycle= 9 E= -2508.28162972463  delta_E= -0.394  |g|= 0.454  |ddm|= 1.08
  HOMO = 0.297757447127606  LUMO = 0.806714457103657
cycle= 10 E= -2508.41365334787  delta_E= -0.132  |g|= 0.503  |ddm|= 0.739
  HOMO = 0.258840872741792  LUMO = 0.798412198892002
cycle= 11 E= -2508.45179498931  delta_E= -0.0381  |g|= 0.354  |ddm|= 0.216
  HOMO = 0.227472831010846  LUMO = 0.786947680882378
cycle= 12 E= -2508.47130420324  delta_E= -0.0195  |g|= 0.15  |ddm|= 0.19
  HOMO = 0.223977751145351  LUMO = 0.781348949629316
cycle= 13 E= -2508.47920672  delta_E= -0.0079  |g|= 0.0509  |ddm|= 0.0987
  HOMO = 0.217512928880352  LUMO = 0.780808121688818
cycle= 14 E= -2508.48080624342  delta_E= -0.0016  |g|= 0.0138  |ddm|= 0.0823
  HOMO = 0.222811966434764  LUMO = 0.781758544118202
cycle= 15 E= -2508.48106344696  delta_E= -0.000257  |g|= 0.00753  |ddm|= 0.0306
  HOMO = 0.221168960064663  LUMO = 0.78165986955495
cycle= 16 E= -2508.48118065754  delta_E= -0.000117  |g|= 0.0055  |ddm|= 0.0176
  HOMO = 0.220448183722441  LUMO = 0.781551647939142
cycle= 17 E= -2508.48128456145  delta_E= -0.000104  |g|= 0.00433  |ddm|= 0.0185
  HOMO = 0.219631870444951  LUMO = 0.781491200456177
cycle= 18 E= -2508.48141310191  delta_E= -0.000129  |g|= 0.00313  |ddm|= 0.0284
  HOMO = 0.219451892571459  LUMO = 0.781559304945524
cycle= 19 E= -2508.48149436399  delta_E= -8.13e-05  |g|= 0.00244  |ddm|= 0.0245
  HOMO = 0.219274540481318  LUMO = 0.78156446811915
cycle= 20 E= -2508.48153571905  delta_E= -4.14e-05  |g|= 0.00207  |ddm|= 0.0155
  HOMO = 0.21912074117613  LUMO = 0.781547820451628
cycle= 21 E= -2508.48156605354  delta_E= -3.03e-05  |g|= 0.00192  |ddm|= 0.013
  HOMO = 0.21909870192544  LUMO = 0.781560779127507
cycle= 22 E= -2508.48159345379  delta_E= -2.74e-05  |g|= 0.00182  |ddm|= 0.0116
  HOMO = 0.219077725087893  LUMO = 0.781567228767251
cycle= 23 E= -2508.48162873097  delta_E= -3.53e-05  |g|= 0.0017  |ddm|= 0.0154
  HOMO = 0.219180919013525  LUMO = 0.78157884663448
cycle= 24 E= -2508.48170870868  delta_E= -8e-05  |g|= 0.0016  |ddm|= 0.0379
  HOMO = 0.219174670941366  LUMO = 0.781580689017484
cycle= 25 E= -2508.48172322893  delta_E= -1.45e-05  |g|= 0.0015  |ddm|= 0.00742
  HOMO = 0.219565840214921  LUMO = 0.781617518319627
cycle= 26 E= -2508.48180007355  delta_E= -7.68e-05  |g|= 0.0018  |ddm|= 0.0443
  HOMO = 0.219520319493445  LUMO = 0.781611041048931
cycle= 27 E= -2508.48182483982  delta_E= -2.48e-05  |g|= 0.00141  |ddm|= 0.0158
  HOMO = 0.219504978684793  LUMO = 0.781611030574139
cycle= 28 E= -2508.4818305997  delta_E= -5.76e-06  |g|= 0.00143  |ddm|= 0.00393
  HOMO = 0.219592602347452  LUMO = 0.781611483357331
cycle= 29 E= -2508.48183196715  delta_E= -1.37e-06  |g|= 0.00162  |ddm|= 0.00167
  HOMO = 0.219649000894285  LUMO = 0.781624535161438
cycle= 30 E= -2508.48185302445  delta_E= -2.11e-05  |g|= 0.00157  |ddm|= 0.0149
  HOMO = 0.219545555246693  LUMO = 0.781624341568245
cycle= 31 E= -2508.48187043977  delta_E= -1.74e-05  |g|= 0.00142  |ddm|= 0.0123
  HOMO = 0.219215987186358  LUMO = 0.781623467704615
cycle= 32 E= -2508.48188235687  delta_E= -1.19e-05  |g|= 0.00121  |ddm|= 0.00773
  HOMO = 0.219443074697068  LUMO = 0.781642503474811
cycle= 33 E= -2508.48190773514  delta_E= -2.54e-05  |g|= 0.00121  |ddm|= 0.02
  HOMO = 0.219441806067212  LUMO = 0.781655752108469
cycle= 34 E= -2508.48193273345  delta_E= -2.5e-05  |g|= 0.00121  |ddm|= 0.02
  HOMO = 0.219336888114372  LUMO = 0.781658475720121
cycle= 35 E= -2508.48196013825  delta_E= -2.74e-05  |g|= 0.00116  |ddm|= 0.0225
  HOMO = 0.219379922357794  LUMO = 0.781675804987174
cycle= 36 E= -2508.48200220313  delta_E= -4.21e-05  |g|= 0.00152  |ddm|= 0.039
  HOMO = 0.219249212350184  LUMO = 0.781659364752692
cycle= 37 E= -2508.48198420408  delta_E= 1.8e-05  |g|= 0.00167  |ddm|= 0.0219
  HOMO = 0.219389345800791  LUMO = 0.781684757049458
cycle= 38 E= -2508.48202822103  delta_E= -4.4e-05  |g|= 0.0015  |ddm|= 0.0441
  HOMO = 0.219426690303953  LUMO = 0.781688906638054
cycle= 39 E= -2508.48204074966  delta_E= -1.25e-05  |g|= 0.00112  |ddm|= 0.0135
  HOMO = 0.219425511859428  LUMO = 0.781697526699735
cycle= 40 E= -2508.4820658602  delta_E= -2.51e-05  |g|= 0.00143  |ddm|= 0.0293
  HOMO = 0.219403079544093  LUMO = 0.781689768040353
cycle= 41 E= -2508.48207128804  delta_E= -5.43e-06  |g|= 0.000723  |ddm|= 0.00723
  HOMO = 0.219423579334784  LUMO = 0.781694181972559
cycle= 42 E= -2508.48207522229  delta_E= -3.93e-06  |g|= 0.000727  |ddm|= 0.00592
  HOMO = 0.219477287846842  LUMO = 0.781711026481343
cycle= 43 E= -2508.48209964377  delta_E= -2.44e-05  |g|= 0.0015  |ddm|= 0.0374
  HOMO = 0.2195251784484  LUMO = 0.78171096719264
cycle= 44 E= -2508.48210597677  delta_E= -6.33e-06  |g|= 0.000741  |ddm|= 0.0117
  HOMO = 0.219570864794971  LUMO = 0.781718524176782
cycle= 45 E= -2508.48211367052  delta_E= -7.69e-06  |g|= 0.00113  |ddm|= 0.0176
  HOMO = 0.219511959079683  LUMO = 0.781700126293129
cycle= 46 E= -2508.48210131497  delta_E= 1.24e-05  |g|= 0.00133  |ddm|= 0.0251
  HOMO = 0.219623865528342  LUMO = 0.781718760140739
cycle= 47 E= -2508.48211655465  delta_E= -1.52e-05  |g|= 0.00121  |ddm|= 0.0316
  HOMO = 0.219592021003472  LUMO = 0.781713319132856
cycle= 48 E= -2508.48211401615  delta_E= 2.54e-06  |g|= 0.000531  |ddm|= 0.00737
  HOMO = 0.219620577999928  LUMO = 0.781715835578435
cycle= 49 E= -2508.48211561822  delta_E= -1.6e-06  |g|= 0.000381  |ddm|= 0.00364
  HOMO = 0.219628314064267  LUMO = 0.781716015184434
cycle= 50 E= -2508.48211731297  delta_E= -1.69e-06  |g|= 0.000346  |ddm|= 0.00375
  HOMO = 0.219646517826351  LUMO = 0.781717388854663
cycle= 51 E= -2508.48211887423  delta_E= -1.56e-06  |g|= 0.000326  |ddm|= 0.00355
  HOMO = 0.21965144159866  LUMO = 0.78171841421068
cycle= 52 E= -2508.48212058206  delta_E= -1.71e-06  |g|= 0.000315  |ddm|= 0.00472
  HOMO = 0.219645241507604  LUMO = 0.781717944740031
cycle= 53 E= -2508.48212099774  delta_E= -4.16e-07  |g|= 0.000317  |ddm|= 0.00113
  HOMO = 0.219693726244003  LUMO = 0.781722948443937
cycle= 54 E= -2508.48212497819  delta_E= -3.98e-06  |g|= 0.00041  |ddm|= 0.0113
  HOMO = 0.219679204856725  LUMO = 0.781722173195107
cycle= 55 E= -2508.48212607486  delta_E= -1.1e-06  |g|= 0.000282  |ddm|= 0.00427
  HOMO = 0.219690766145976  LUMO = 0.781723914663534
cycle= 56 E= -2508.4821285188  delta_E= -2.44e-06  |g|= 0.000343  |ddm|= 0.00881
  HOMO = 0.21968102370952  LUMO = 0.781724264334853
cycle= 57 E= -2508.48213043237  delta_E= -1.91e-06  |g|= 0.00026  |ddm|= 0.00684
  HOMO = 0.219685163957912  LUMO = 0.781726610320779
cycle= 58 E= -2508.48213255997  delta_E= -2.13e-06  |g|= 0.000321  |ddm|= 0.00926
  HOMO = 0.219685244416238  LUMO = 0.781726431745932
cycle= 59 E= -2508.48213313477  delta_E= -5.75e-07  |g|= 0.000164  |ddm|= 0.00257
  HOMO = 0.219702984211858  LUMO = 0.781727925940008
cycle= 60 E= -2508.48213496549  delta_E= -1.83e-06  |g|= 0.000384  |ddm|= 0.011
  HOMO = 0.219704785170272  LUMO = 0.781727540846159
cycle= 61 E= -2508.4821356088  delta_E= -6.43e-07  |g|= 0.000197  |ddm|= 0.00429
  HOMO = 0.2197093006407  LUMO = 0.781727877520907
cycle= 62 E= -2508.48213574119  delta_E= -1.32e-07  |g|= 0.000119  |ddm|= 0.000963
  HOMO = 0.219737899368351  LUMO = 0.781731219537655
cycle= 63 E= -2508.48213664052  delta_E= -8.99e-07  |g|= 0.000337  |ddm|= 0.00905
  HOMO = 0.219730214314431  LUMO = 0.781729938836632
cycle= 64 E= -2508.48213705856  delta_E= -4.18e-07  |g|= 0.000257  |ddm|= 0.00571
  HOMO = 0.219738191642209  LUMO = 0.78173097129955
cycle= 65 E= -2508.48213719783  delta_E= -1.39e-07  |g|= 0.000119  |ddm|= 0.00209
  HOMO = 0.219745555465542  LUMO = 0.781731174885033
cycle= 66 E= -2508.48213731931  delta_E= -1.21e-07  |g|= 0.000134  |ddm|= 0.00326
  HOMO = 0.219750591227327  LUMO = 0.781731325988891
cycle= 67 E= -2508.48213735409  delta_E= -3.48e-08  |g|= 7.13e-05  |ddm|= 0.00121
  HOMO = 0.219754928270706  LUMO = 0.781732081142691
cycle= 68 E= -2508.48213739232  delta_E= -3.82e-08  |g|= 7.11e-05  |ddm|= 0.00179
  HOMO = 0.219758086437931  LUMO = 0.781732246812863
cycle= 69 E= -2508.48213739994  delta_E= -7.61e-09  |g|= 3.64e-05  |ddm|= 0.000474
  HOMO = 0.219756213597388  LUMO = 0.781731997744152
cycle= 70 E= -2508.48213739914  delta_E= 8.01e-10  |g|= 3.03e-05  |ddm|= 0.000258
  HOMO = 0.119760045918837  LUMO = 0.581732335949392
Extra cycle  E= -2508.48213740153  delta_E= -2.39e-09  |g|= 3e-05  |ddm|= 8.26e-05
converged SCF energy = -2508.48213740153

Sweep =    0 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =      4.278 | E =   -2508.5798736209 | DW = 3.34676e-06

Sweep =    1 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =      8.761 | E =   -2508.5880485742 | DE = -8.17e-03 | DW = 4.75027e-06

Sweep =    2 | Direction =  forward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =     12.664 | E =   -2508.5881427862 | DE = -9.42e-05 | DW = 6.41103e-06

Sweep =    3 | Direction = backward | Bond dimension =  250 | Noise =  1.00e-04 | Dav threshold =  1.00e-10
Time elapsed =     16.414 | E =   -2508.5881717102 | DE = -2.89e-05 | DW = 5.12246e-06

Sweep =    4 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     26.026 | E =   -2508.5882877313 | DE = -1.16e-04 | DW = 2.54166e-07

Sweep =    5 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     42.105 | E =   -2508.5883602418 | DE = -7.25e-05 | DW = 8.95182e-07

Sweep =    6 | Direction =  forward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     55.741 | E =   -2508.5883767755 | DE = -1.65e-05 | DW = 1.05003e-06

Sweep =    7 | Direction = backward | Bond dimension =  500 | Noise =  1.00e-05 | Dav threshold =  1.00e-10
Time elapsed =     69.792 | E =   -2508.5883880185 | DE = -1.12e-05 | DW = 1.05759e-06

Sweep =    8 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    101.921 | E =   -2508.5884222040 | DE = -3.42e-05 | DW = 2.38120e-19

Sweep =    9 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    213.183 | E =   -2508.5884329200 | DE = -1.07e-05 | DW = 1.01293e-08

Sweep =   10 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    415.294 | E =   -2508.5884335897 | DE = -6.70e-07 | DW = 2.24424e-08

Sweep =   11 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    613.058 | E =   -2508.5884336270 | DE = -3.74e-08 | DW = 2.26247e-08

Sweep =   12 | Direction =  forward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =    807.080 | E =   -2508.5884337044 | DE = -7.74e-08 | DW = 2.32430e-08

Sweep =   13 | Direction = backward | Bond dimension = 2000 | Noise =  0.00e+00 | Dav threshold =  1.00e-09
Time elapsed =   1000.065 | E =   -2508.5884337068 | DE = -2.41e-09 | DW = 2.32771e-08

DMRG energy = -2508.588433706805517
已保存为 minfo_data.h5
