#INFO: **** input file is /home/Yxwxwx/code/dmet/test/huge_ci/Cr2/dmet_siso.py ****
from pyscf import gto, scf, ao2mo, mcscf, fci, dmrgscf, lib

# from pyscf.csf_fci import csf_solver  # TODO:
from pyscf.mcscf import avas
from pyscf.tools import molden, fcidump
from pyscf.lib import logger, cho_solve
from pyscf.data import nist
import numpy as np
import scipy
from functools import reduce
import os
import tempfile
from liblan.utils.rdiis import tag_rdiis_
import h5py

dmrgscf.settings.BLOCKEXE = os.popen("which block2main").read().strip()
dmrgscf.settings.MPIPREFIX = ""


def read_cas_info(fname):
    with open(fname, "r") as f1:
        ncasorb, ncaselec = [int(x) for x in f1.readline().split(" ")]
        casorbind = [int(x) for x in f1.readline().split(" ")]
        statelis = [int(x) for x in f1.readline().split(" ")]
    return ncasorb, ncaselec, casorbind, statelis


def sacasscf_dump_chk(solver, sav):
    # saving properties for SISO
    with h5py.File(sav, "w") as fh5:
        fh5["ncore"] = np.asarray(solver.ncore)
        fh5["ncas"] = np.asarray(solver.ncas)
        fh5["nelecas"] = np.asarray(solver.nelecas)
        fh5["mo_coeff"] = solver.mo_coeff
        fh5["rdm1"] = solver.make_rdm1()

        for i in range(len(solver.ci)):
            fh5["ci" + str(i)] = solver.ci[i]
        fh5["e_states"] = solver.e_states


def sacasscf_load_chk(solver, sav):
    with h5py.File(sav, "r") as fh5:
        solver.ncore = fh5["ncore"][()]
        solver.ncas = fh5["ncas"][()]
        solver.nelecas = fh5["nelecas"][:]

        solver.mo_coeff = fh5["mo_coeff"][:]
        rdm1 = fh5["rdm1"][:]
        solver.make_rdm1 = lambda *args: rdm1

        # solver.e_states = fh5["e_states"][:]
        # solver.ci = [fh5["ci" + str(i)][:] for i in range(len(solver.e_states))]
    return solver


def rohf_solve_imp(hcore, eris, nelec, spin, max_mem, dm0=None, verbose=logger.INFO):
    mol = gto.M()
    mol.verbose = verbose
    mol.incore_anyway = True
    mol.nelectron = nelec
    mol.spin = spin

    nao = hcore.shape[0]
    print("nao = ", nao)
    print("nelec = ", mol.nelec)

    mf = scf.rohf.ROHF(mol).x2c()
    mf.max_memory = max_mem
    mf.mo_energy = np.zeros((nao))
    mf.max_cycle = 1000
    mf.diis_space = 8
    mf.init_guess = "1e"
    mf.level_shift = 0.2

    mf.get_hcore = lambda *args: hcore
    mf.get_ovlp = lambda *args: np.eye(nao)
    mf._eri = ao2mo.restore(8, eris, nao)

    if dm0 is None:
        mf.kernel()
    else:
        if dm0.shape != hcore.shape:
            bath_size = hcore.shape[0] - dm0.shape[0]
            dm0 = scipy.linalg.block_diag(
                dm0, np.eye(bath_size) * (nelec - np.trace(dm0)) / bath_size
            )
        mf.kernel(dm0)
    return mf


def sacasscf_solve_imp(
    solver_base, mol, ncasorb, ncaselec, casorbind, statelis, avas=False
):
    solver = mcscf.CASSCF(solver_base, ncasorb, ncaselec)

    if avas:
        mo = casorbind
    else:
        mo = solver.sort_mo(casorbind)
    mcfs = []
    logger.info(solver, "Attempting SA-DMRGSCF with")
    for i in range(len(statelis)):
        if statelis[i] != 0:
            new_mcf = dmrgscf.DMRGCI(mol, maxM=1500, tol=1e-10)
            new_mcf.spin = i
            new_mcf.nroots = statelis[i]
            new_mcf.threads = 16
            new_mcf.memory = int(mol.max_memory / 1000)
            new_mcf.block_extra_keyword = [
                "real_density_matrix",
                "davidson_soft_max_iter 1600",
                "noreorder",
                "cutoff 1E-24",
            ]
            new_mcf.runtimeDir = lib.param.TMPDIR + "/%d" % i
            new_mcf.scratchDirectory = lib.param.TMPDIR + "/%d" % i
            mcfs.append(new_mcf)
            logger.info(
                solver, "%s states with spin multiplicity %s", statelis[i], i + 1
            )

    statetot = sum(statelis)
    mcscf.state_average_mix_(solver, mcfs, np.ones(statetot) / statetot)
    solver.run(mo, verbose=mol.verbose)
    return solver


def lowdin(s):
    """new basis is |mu> c^{lowdin}_{mu i}"""
    e, v = scipy.linalg.eigh(s)
    idx = e > 1e-15
    return np.dot(v[:, idx] / np.sqrt(e[idx]), v[:, idx].conj().T)


def caolo(s):
    return lowdin(s)


def cloao(s):
    return lowdin(s) @ s


def get_dmet_as_props(mf, imp_inds, lo_meth="lowdin", thres=1e-13):
    """
    Returns C(AO->AS), entropy loss, and orbital composition
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)
    env_inds = [x for x in range(s.shape[0]) if x not in imp_inds]

    if mf.mol.spin == 0:
        pass
    else:
        dma, dmb = mf.make_rdm1()

        ldma = reduce(np.dot, (cloao_mat, dma, cloao_mat.conj().T))
        ldmb = reduce(np.dot, (cloao_mat, dmb, cloao_mat.conj().T))

        ldma_env = ldma[env_inds, :][:, env_inds]
        ldmb_env = ldmb[env_inds, :][:, env_inds]

        nat_occa, nat_coeffa = np.linalg.eigh(ldma_env)
        nat_occb, nat_coeffb = np.linalg.eigh(ldmb_env)

        ldmr_env = ldma_env + ldmb_env
        nat_occr, nat_coeffr = np.linalg.eigh(ldmr_env)

        caoas = np.hstack([caolo_mat[:, imp_inds], caolo_mat[:, env_inds] @ nat_coeffr])

        nuu = np.sum([nat_occr < thres])
        ne = np.sum([(nat_occr >= thres) & (nat_occr <= 2 - thres)])
        nuo = np.sum([nat_occr > 2 - thres])

        asorbs = (nuu, ne, nuo)
        print("caoas.shape = ", caoas.shape)
        print("asorbs = ", asorbs)

        nat_occa = nat_occa[nat_occa > thres]
        nat_occb = nat_occb[nat_occb > thres]
        nat_occr = nat_occr[nat_occr > thres]

        ent = -np.sum(nat_occa * np.log(nat_occa)) - np.sum(nat_occb * np.log(nat_occb))
        entr = -2 * np.sum(nat_occr / 2 * np.log(nat_occr / 2))

        return caoas, entr - ent, asorbs


def get_dmet_imp_ldm(mf, imp_inds, lo_meth="lowdin"):
    """
    Returns better initial guess than '1e' for impurity
    """
    s = mf.get_ovlp()
    caolo_mat, cloao_mat = caolo(s), cloao(s)

    dma, dmb = mf.make_rdm1()

    ldm = reduce(np.dot, (cloao_mat, (dma + dmb), cloao_mat.conj().T))[imp_inds, :][
        :, imp_inds
    ]
    return ldm


def get_as_1e_ints(mf, caoas, asorbs):
    # hcore from mf
    hcore = mf.get_hcore()

    # HF J/K from env UO
    uos = hcore.shape[0] - asorbs[-1]
    dm_uo = caoas[:, uos:] @ caoas[:, uos:].conj().T * 2
    vj, vk = mf.get_jk(dm=dm_uo)

    fock = hcore + vj - 0.5 * vk

    nimp = hcore.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    asints1e = reduce(np.dot, (caoas[:, act_inds].conj().T, fock, caoas[:, act_inds]))
    return asints1e


def get_as_2e_ints(mf, caoas, asorbs):
    nimp = caoas.shape[0] - np.sum(asorbs)
    act_inds = [
        *list(range(nimp)),
        *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
    ]

    if mf._eri is not None:
        asints2e = ao2mo.full(mf._eri, caoas[:, act_inds])
    else:
        asints2e = ao2mo.full(mf.mol, caoas[:, act_inds])

    return asints2e


def get_bp_hso2e(mol, dm0):
    hso2e = mol.intor("int2e_p1vxp1", 3).reshape(3, mol.nao, mol.nao, mol.nao, mol.nao)
    vj = np.einsum("yijkl,lk->yij", hso2e, dm0, optimize=True)
    vk = np.einsum("yijkl,jk->yil", hso2e, dm0, optimize=True)
    vk += np.einsum("yijkl,li->ykj", hso2e, dm0, optimize=True)
    return vj, vk


def get_bp_hso2e_amfi(mol, dm0):
    """atomic-mean-field approximation"""
    ao_loc = mol.ao_loc_nr()
    nao = ao_loc[-1]
    vj = np.zeros((3, nao, nao))
    vk = np.zeros((3, nao, nao))
    import copy

    atom = copy.copy(mol)
    aoslice = mol.aoslice_by_atom(ao_loc)
    for ia in range(mol.natm):
        b0, b1, p0, p1 = aoslice[ia]
        atom._bas = mol._bas[b0:b1]
        vj1, vk1 = get_bp_hso2e(atom, dm0[p0:p1, p0:p1])
        vj[:, p0:p1, p0:p1] = vj1
        vk[:, p0:p1, p0:p1] = vk1
    return vj, vk


mol = gto.M(
    atom="""
  Cr  -1.35424450239280      0.00748246778796     -0.00087595645706 
  Cr   1.35423764131845      0.00747803055009     -0.00087750355078 
  O   -0.00000294430974     -0.13734660180713      1.46342333077295 
  O   -0.00000064383679      1.35420350893235     -0.59959802230353 
  O   -0.00000516089286     -1.18217624605433     -0.86562559483160 
  H   -0.00000065463206      0.52075486357441      2.16950923336362 
  H    0.00000446473449      1.64878725909317     -1.51878718478551 
  H   -0.00000926896581     -2.12530440890393     -0.66035454411104 
  N   -2.68346617865321     -1.45853826988486      0.70650005032200 
  C   -2.01822727274717     -2.52465540625361      1.50592497177303 
  C   -3.25911308583331     -2.04955652529081     -0.54278797058362 
  C   -3.74827281074952     -0.80152247456954      1.54881850901734 
  H   -1.56748557922213     -2.08271923805020      2.39129571316802 
  H   -1.24243826043958     -2.99862043316970      0.90648770606852 
  H   -2.74840997387176     -3.28356694917433      1.79607780436372 
  H   -2.46291984415168     -2.62337513441757     -1.02093781896581 
  H   -4.07044743926176     -2.74311239041734     -0.30244269679464 
  H   -4.65448299937734     -0.70680487372819      0.95372217138132 
  H   -3.99500774926338     -1.44490669699879      2.39456976728496 
  N   -2.69755450329625      1.34136962911627      0.91026422821942 
  N   -2.69230526823111      0.11718842081111     -1.61665366474216 
  C   -3.74849616889413     -0.94865197019848     -1.46353644818261 
  C   -3.27063403754831      0.54952804549553      2.04434124343513 
  N    2.68346715675698     -1.45854069314242      0.70650003406182 
  N    2.69754925024949      1.34136611134027      0.91026654207433 
  N    2.69230403104748      0.11718547928447     -1.61665262689138 
  C   -2.04437616396754      2.57225987860668      1.43663608392829 
  C   -3.76194284730143      1.73300596201565     -0.08408294061084 
  C   -2.03228717940052     -0.03618283988186     -2.94309134997238 
  C   -3.27725483448617      1.49033558111027     -1.50018850579138 
  H   -4.65645471974087     -0.48734410738601     -1.07991760798513 
  H   -3.99664215151405     -1.36168809799084     -2.44226987052617 
  H   -2.47549715669751      0.42734931293811      2.78234874695929
  H   -4.08755174458298      1.09782217898898      2.52290059499979 
  C    2.01823189480386     -2.52466013170271      1.50592432110894 
  C    3.25911692194754     -2.04955805616288     -0.54278693277931 
  C    3.74827350165531     -0.80152393465555      1.54881874867098 
  C    2.04437438874437      2.57225673960399      1.43664047370217 
  C    3.27063260709400      0.54952529364165      2.04434238389264 
  C    3.76193758070494      1.73300459398023     -0.08408076294943 
  C    2.03228955044192     -0.03618719210796     -2.94309210428304 
  C    3.27724995734855      1.49033424715459     -1.50018655506513 
  C    3.74849826690828     -0.94865216224951     -1.46353430216360 
  H   -1.59575047514265      3.12234814848417      0.61291937461478 
  H   -1.26826445350661      2.29664085726858      2.14911186944439 
  H   -2.78162146845096      3.19639860592609      1.94666596437982 
  H   -4.66409353100933      1.16248658840109      0.12799867351868 
  H   -4.01827672254151      2.78498397644774      0.04889460213876 
  H   -1.57918667365396     -1.02245710553356     -3.00817218975222 
  H   -1.25884477264019      0.72228568282228     -3.05436504943444 
  H   -2.76640836866444      0.09214024180044     -3.74175962042542 
  H   -2.48702512015610      2.19699107950093     -1.76109217570029 
  H   -4.09281437247312      1.62358792037224     -2.21722220410103 
  H    1.56748953447666     -2.08272559171093      2.39129530400812 
  H    1.24244410784823     -2.99862712397942      0.90648689200259 
  H    2.74841706997603     -3.28356963121360      1.79607623870542 
  H    2.46292569126273     -2.62337849835601     -1.02093792725634 
  H    4.07045302720973     -2.74311163538248     -0.30244048876426 
  H    4.65448346115229     -0.70680401028077      0.95372228032966 
  H    3.99501075900995     -1.44490851377397      2.39456915731191 
  H    1.59574566134859      3.12234477429960      0.61292534612400 
  H    1.26826627874473      2.29663922181641      2.14912084106002 
  H    2.78162298309563      3.19639495340303      1.94666639317082 
  H    2.47549786087627      0.42734489313183      2.78235173581885 
  H    4.08755032211489      1.09782125435258      2.52289983946985 
  H    4.66408898713428      1.16248602569396      0.12799994420443 
  H    4.01827034865908      2.78498276510688      0.04889794787615 
  H    1.57919077794174     -1.02246221135116     -3.00817477609090 
  H    1.25884680990156      0.72228058908288     -3.05436842804018 
  H    2.76641276635084      0.09213636615134     -3.74175868249209 
  H    2.48701845128170      2.19698799301717     -1.76108932637069 
  H    4.09280944357511      1.62358920085783     -2.21721985740965 
  H    4.65645441062758     -0.48734137231740     -1.07991321549768 
  H    3.99664791915730     -1.36168656486501     -2.44226768508526 
        """,
    basis={
        "default": "def2tzvp",
        "C": "6-31G*",
        "H": "6-31G*",
        "N": "6-31G*",
    },
    symmetry=0,
    spin=6,
    charge=+3,
    verbose=4,
    max_memory=200000,
)

mf = scf.rohf.ROHF(mol).x2c()
mf.max_cycle = 100
title = "Cr2O4"
imp_inds = mol.search_ao_label(["Cr *", "O *"])
mf.chkfile = title + "_rohf.chk"
mf.init_guess = "atom"
mf.level_shift = 0.2
if os.path.isfile(title + "_rohf.chk"):
    mf.init_guess = "chk"
    mf.level_shift = 0.0
mf = tag_rdiis_(mf=mf, imp_inds=imp_inds)
mf.kernel()


print("nao = ", mol.nao_nr())
print("nelec = ", mol.nelec)


print("imp_inds.shape", imp_inds.shape)

as_fname = title + "_as_chk.h5"
if not os.path.isfile(as_fname):
    # AS general info
    caoas, ent, asorbs = get_dmet_as_props(mf, imp_inds, thres=1e-13)
    # AS hcore + j/k
    as1e = get_as_1e_ints(mf, caoas, asorbs)
    # AS ERIs
    as2e = get_as_2e_ints(mf, caoas, asorbs)

    print(f"Entanglement S: {ent:.3f}")

    with h5py.File(as_fname, "w") as fh5:
        fh5["caoas"] = caoas
        fh5["ent"] = ent
        fh5["asorbs"] = asorbs
        fh5["1e"] = as1e
        fh5["2e"] = as2e
else:
    fh5 = h5py.File(as_fname, "r")
    caoas = fh5["caoas"][:]
    ent = fh5["ent"][()]
    asorbs = fh5["asorbs"][:]
    as1e = fh5["1e"][:]
    as2e = fh5["2e"][:]
    fh5.close()

nimp = caoas.shape[0] - np.sum(asorbs)
print("nimp = ", nimp)
act_inds = [
    *list(range(nimp)),
    *list(range(nimp + asorbs[0], nimp + asorbs[0] + asorbs[1])),
]

print("act_inds = ", act_inds)

nelec = int(mf.mol.nelectron - asorbs[-1] * 2)
ldm = get_dmet_imp_ldm(mf, imp_inds)
solver_base = rohf_solve_imp(as1e, as2e, nelec, mf.mol.spin, mf.max_memory, dm0=ldm)

with open(title + "_imp_rohf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver_base.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

# avas
# ao_labels = ["Co 3d"]
# ncasorb, ncaselec, casorbind = avas.avas(solver_base, ao_labels, canonicalize=False)

# ncasorb = 5
# ncaselec = 7
# casorbind = [40, 41, 55, 56, 57]  # F-style

caschk_fname = title + "_imp_cas_chk.h5"


if not os.path.isfile(caschk_fname):
    casinfo_fname = title + "_cas_info"
    if not os.path.isfile(casinfo_fname):
        print("Failed to read saved CAS briefings.")
        exit()
    ncasorb, ncaselec, casorbind, statelis = read_cas_info(casinfo_fname)

    solver = sacasscf_solve_imp(
        solver_base, mf.mol, ncasorb, ncaselec, casorbind, statelis=statelis
    )
    sacasscf_dump_chk(solver, caschk_fname)

else:
    solver = sacasscf_load_chk(lib.StreamObject(), caschk_fname)


with open(title + "_imp_casscf_orbs.molden", "w") as f1:
    molden.header(mf.mol, f1)
    molden.orbital_coeff(
        mf.mol,
        f1,
        caoas[:, act_inds] @ solver.mo_coeff,
        ene=solver_base.mo_energy,
        occ=solver_base.mo_occ,
    )

huge_casorbind = [
    73,
    78,
    79,
    100,
    101,
    102,
    107,
    108,
    109,
    130,
    131,
    132,
    133,
    134,
    135,
    136,
    137,
    138,
    139,
]
if len(huge_casorbind) != 19:
    exit()

mc = mcscf.CASSCF(solver_base, ncas=19, nelecas=24)
mc.mo_coeff = mc.sort_mo(huge_casorbind, solver.mo_coeff)

fcidump.from_integrals(
    "FCIDUMP",
    mc.get_h1eff()[0],
    mc.get_h2eff(),
    mc.ncas,
    mc.nelecas,
    nuc=mc.get_h1eff()[1],
)

uos = caoas.shape[0] - asorbs[-1]
dm_uo = caoas[:, uos:] @ caoas[:, uos:].conj().T * 2
mo_cas = caoas[:, act_inds] @ mc.mo_coeff[:, mc.ncore : mc.ncore + mc.ncas]
print("mo_cas.shape = ", mo_cas.shape)
sodm1_act = reduce(
    np.dot, [caoas[:, act_inds], solver.make_rdm1(), caoas[:, act_inds].conj().T]
)
sodm1 = sodm1_act + dm_uo

# soc integral
# breit-pauli amfi
# amfi = True
# hso1e = mol.intor_asymmetric("int1e_pnucxp", 3)
# vj, vk = get_bp_hso2e_amfi(mol, sodm1) if amfi else get_bp_hso2e(mol, sodm1)
# hso2e = vj - vk * 1.5
# hsoao = 1.0j * (nist.ALPHA**2 / 2) * (hso1e + hso2e)
# print("hsoao.shape = ", hsoao.shape)

# hso = np.asarray([reduce(np.dot, (mo_cas.T, x.T, mo_cas)) for x in hsoao])
# print("hso.shape = ", hso.shape)
# # Save each component of hso (shape: 3 x nao x nao) to separate binary files as complex128
# hso[0].astype(np.complex128).tofile("hso_x.bin")
# hso[1].astype(np.complex128).tofile("hso_y.bin")
# hso[2].astype(np.complex128).tofile("hso_z.bin")

# x2camf
from mycamf import x2camf
import os

xmol, ctr = mf.with_x2c.get_xmol(mol)
xdmao = ctr @ sodm1 @ ctr.conj().T
print("sodm1.shape = ", sodm1.shape)
print("xdmao.shape = ", xdmao.shape)
x = mf.with_x2c.get_xmat()
r = mf.with_x2c._get_rmat(x=x)
hso1e = xmol.intor_asymmetric("int1e_pnucxp", 3)
hso1e = np.einsum(
    "pq,qr,irs,sk,kl->ipl", r.conj().T, x.conj().T, hso1e, x, r, optimize=True
)

hso2e = x2camf.amfi(mf.with_x2c, printLevel=1)

hso2e = hso2e / (nist.ALPHA**2 / 4)
sphsp = xmol.sph2spinor_coeff()
p_repr = np.einsum("ixp,pq,jyq->ijxy", sphsp, hso2e, sphsp.conj(), optimize=True)
hso2e = (p_repr[0, np.array([1, 1, 0])] * np.array([-1j, 1, -1j])[:, None, None]).real

s22 = xmol.intor_symmetric("int1e_ovlp")
s21 = gto.intor_cross("int1e_ovlp", xmol, mol)
c = cho_solve(s22, s21)
hso1e = c.conj().T @ hso1e @ c
hso2e = c.conj().T @ hso2e @ c
print("hso1e.shape = ", hso1e.shape)
print("hso2e.shape = ", hso2e.shape)
hsoao = (1j * nist.ALPHA**2 / 2) * (hso1e + hso2e)

hso = np.asarray([reduce(np.dot, (mo_cas.T.conj(), i.T, mo_cas)) for i in hsoao])
print("hso.shape = ", hso.shape)
# Save each component of hso (shape: 3 x nao x nao) to separate binary files as complex128
hso_labels = ["x", "y", "z"]
for i, label in enumerate(hso_labels):
    with open(f"hso_{label}.bin", "wb") as f:
        # 先写入shape信息（int32），再写入数据（complex128）
        shape = np.array(hso[i].shape, dtype=np.int32)
        f.write(shape.tobytes())
        f.write(hso[i].astype(np.complex128).tobytes())
        # print(hso[i])
#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='cu02', release='5.15.0-133-generic', version='#144-Ubuntu SMP Fri Feb 7 20:47:38 UTC 2025', machine='x86_64')  Threads 32
Python 3.11.13 (main, Jun  5 2025, 13:12:00) [GCC 11.2.0]
numpy 2.3.1  scipy 1.16.0  h5py 3.14.0
Date: Sun Jul 13 14:18:43 2025
PySCF version 2.9.0
PySCF path  /home/Yxwxwx/.conda/envs/pyscf_311/lib/python3.11/site-packages/pyscf

[CONFIG] conf_file None
[INPUT] verbose = 4
[INPUT] num. atoms = 74
[INPUT] num. electrons = 264
[INPUT] charge = 3
[INPUT] spin (= nelec alpha-beta = 2S) = 6
[INPUT] symmetry 0 subgroup None
[INPUT] Mole.unit = angstrom
[INPUT] Symbol           X                Y                Z      unit          X                Y                Z       unit  Magmom
[INPUT]  1 Cr    -1.354244502393   0.007482467788  -0.000875956457 AA   -2.559151215220   0.014139814855  -0.001655317801 Bohr   0.0
[INPUT]  2 Cr     1.354237641318   0.007478030550  -0.000877503551 AA    2.559138249669   0.014131429691  -0.001658241384 Bohr   0.0
[INPUT]  3 O     -0.000002944310  -0.137346601807   1.463423330773 AA   -0.000005563939  -0.259547461555   2.765469299460 Bohr   0.0
[INPUT]  4 O     -0.000000643837   1.354203508932  -0.599598022304 AA   -0.000001216675   2.559073748807  -1.133076046985 Bohr   0.0
[INPUT]  5 O     -0.000005160893  -1.182176246054  -0.865625594832 AA   -0.000009752674  -2.233989336009  -1.635795300645 Bohr   0.0
[INPUT]  6 H     -0.000000654632   0.520754863574   2.169509233364 AA   -0.000001237075   0.984084070191   4.099778275772 Bohr   0.0
[INPUT]  7 H      0.000004464734   1.648787259093  -1.518787184786 AA    0.000008437125   3.115756357358  -2.870091820744 Bohr   0.0
[INPUT]  8 H     -0.000009268966  -2.125304408904  -0.660354544111 AA   -0.000017515807  -4.016243264159  -1.247889233482 Bohr   0.0
[INPUT]  9 N     -2.683466178653  -1.458538269885   0.706500050322 AA   -5.071016142188  -2.756237872279   1.335091602100 Bohr   0.0
[INPUT] 10 C     -2.018227272747  -2.524655406254   1.505924971773 AA   -3.813896802620  -4.770907276722   2.845785760794 Bohr   0.0
[INPUT] 11 C     -3.259113085833  -2.049556525291  -0.542787970584 AA   -6.158831141211  -3.873100509615  -1.025720608112 Bohr   0.0
[INPUT] 12 C     -3.748272810750  -0.801522474570   1.548818509017 AA   -7.083209052470  -1.514657959620   2.926842798700 Bohr   0.0
[INPUT] 13 H     -1.567485579222  -2.082719238050   2.391295713168 AA   -2.962118448935  -3.935768954278   4.518893980734 Bohr   0.0
[INPUT] 14 H     -1.242438260440  -2.998620433170   0.906487706069 AA   -2.347868038912  -5.666571370215   1.713013499755 Bohr   0.0
[INPUT] 15 H     -2.748409973872  -3.283566949174   1.796077804364 AA   -5.193742128641  -6.205042245613   3.394095148658 Bohr   0.0
[INPUT] 16 H     -2.462919844152  -2.623375134418  -1.020937818966 AA   -4.654243972203  -4.957460526043  -1.929292868056 Bohr   0.0
[INPUT] 17 H     -4.070447439262  -2.743112390417  -0.302442696795 AA   -7.692030864642  -5.183731146790  -0.571533865317 Bohr   0.0
[INPUT] 18 H     -4.654482999377  -0.706804873728   0.953722171381 AA   -8.795698120267  -1.335667634854   1.802273702836 Bohr   0.0
[INPUT] 19 H     -3.995007749263  -1.444906696999   2.394569767285 AA   -7.549470511623  -2.730477932878   4.525081046332 Bohr   0.0
[INPUT] 20 N     -2.697554503296   1.341369629116   0.910264228219 AA   -5.097639217317   2.534821230839   1.720150092323 Bohr   0.0
[INPUT] 21 N     -2.692305268231   0.117188420811  -1.616653664742 AA   -5.087719600680   0.221454020303  -3.055032664637 Bohr   0.0
[INPUT] 22 C     -3.748496168894  -0.948651970198  -1.463536448183 AA   -7.083631138191  -1.792692411204  -2.765683060384 Bohr   0.0
[INPUT] 23 C     -3.270634037548   0.549528045496   2.044341243435 AA   -6.180602584647   1.038457503754   3.863245055245 Bohr   0.0
[INPUT] 24 N      2.683467156757  -1.458540693142   0.706500034062 AA    5.071017990536  -2.756242451572   1.335091571373 Bohr   0.0
[INPUT] 25 N      2.697549250249   1.341366111340   0.910266542074 AA    5.097629290497   2.534814583206   1.720154464875 Bohr   0.0
[INPUT] 26 N      2.692304031047   0.117185479284  -1.616652626891 AA    5.087717262742   0.221448461624  -3.055030703383 Bohr   0.0
[INPUT] 27 C     -2.044376163968   2.572259878607   1.436636083928 AA   -3.863311045488   4.860866691774   2.714848739292 Bohr   0.0
[INPUT] 28 C     -3.761942847301   1.733005962016  -0.084082940611 AA   -7.109041677666   3.274906640448  -0.158893729503 Bohr   0.0
[INPUT] 29 C     -2.032287179401  -0.036182839882  -2.943091349972 AA   -3.840466175532  -0.068375657786  -5.561636611024 Bohr   0.0
[INPUT] 30 C     -3.277254834486   1.490335581110  -1.500188505791 AA   -6.193114077586   2.816326081993  -2.834945411166 Bohr   0.0
[INPUT] 31 H     -4.656454719741  -0.487344107386  -1.079917607985 AA   -8.799424131749  -0.920946891380  -2.040748516187 Bohr   0.0
[INPUT] 32 H     -3.996642151514  -1.361688097991  -2.442269870526 AA   -7.552559084254  -2.573217572283  -4.615221177571 Bohr   0.0
[INPUT] 33 H     -2.475497156698   0.427349312938   2.782348746959 AA   -4.678011648298   0.807573160974   5.257877114780 Bohr   0.0
[INPUT] 34 H     -4.087551744583   1.097822178989   2.522900595000 AA   -7.724353317250   2.074583251762   4.767591164052 Bohr   0.0
[INPUT] 35 C      2.018231894804  -2.524660131703   1.505924321109 AA    3.813905537041  -4.770916206526   2.845784531217 Bohr   0.0
[INPUT] 36 C      3.259116921948  -2.049558056163  -0.542786932779 AA    6.158838390416  -3.873103402544  -1.025718646946 Bohr   0.0
[INPUT] 37 C      3.748273501655  -0.801523934656   1.548818748671 AA    7.083210358093  -1.514660718783   2.926843251580 Bohr   0.0
[INPUT] 38 C      2.044374388744   2.572256739604   1.436640473702 AA    3.863307690802   4.860860759918   2.714857034763 Bohr   0.0
[INPUT] 39 C      3.270632607094   0.549525293642   2.044342383893 AA    6.180599881480   1.038452303504   3.863247210398 Bohr   0.0
[INPUT] 40 C      3.761937580705   1.733004593980  -0.084080762949 AA    7.109031725241   3.274904055236  -0.158889614319 Bohr   0.0
[INPUT] 41 C      2.032289550442  -0.036187192108  -2.943092104283 AA    3.840470656151  -0.068383882301  -5.561638036465 Bohr   0.0
[INPUT] 42 C      3.277249957349   1.490334247155  -1.500186555065 AA    6.193104861131   2.816323561182  -2.834941724828 Bohr   0.0
[INPUT] 43 C      3.748498266908  -0.948652162250  -1.463534302164 AA    7.083635102863  -1.792692774128  -2.765679004996 Bohr   0.0
[INPUT] 44 H     -1.595750475143   3.122348148484   0.612919374615 AA   -3.015531361164   5.900382866178   1.158249754462 Bohr   0.0
[INPUT] 45 H     -1.268264453507   2.296640857269   2.149111869444 AA   -2.396672470649   4.340022226724   4.061232844302 Bohr   0.0
[INPUT] 46 H     -2.781621468451   3.196398605926   1.946665964380 AA   -5.256502757583   6.040317950142   3.678665528690 Bohr   0.0
[INPUT] 47 H     -4.664093531009   1.162486588401   0.127998673519 AA   -8.813859392963   2.196781275558   0.241882437258 Bohr   0.0
[INPUT] 48 H     -4.018276722542   2.784983976448   0.048894602139 AA   -7.593442498318   5.262856976788   0.092397407012 Bohr   0.0
[INPUT] 49 H     -1.579186673654  -1.022457105534  -3.008172189752 AA   -2.984230312769  -1.932163903574  -5.684621574165 Bohr   0.0
[INPUT] 50 H     -1.258844772640   0.722285682822  -3.054365049434 AA   -2.378871853630   1.364922124229  -5.771913427875 Bohr   0.0
[INPUT] 51 H     -2.766408368664   0.092140241800  -3.741759620425 AA   -5.227754165481   0.174119822054  -7.070900906561 Bohr   0.0
[INPUT] 52 H     -2.487025120156   2.196991079501  -1.761092175700 AA   -4.699796342009   4.151711438369  -3.327981892188 Bohr   0.0
[INPUT] 53 H     -4.092814372473   1.623587920372  -2.217222204101 AA   -7.734298242658   3.068136508656  -4.189942723055 Bohr   0.0
[INPUT] 54 H      1.567489534477  -2.082725591711   2.391295304008 AA    2.962125923283  -3.935780960956   4.518893207534 Bohr   0.0
[INPUT] 55 H      1.242444107848  -2.998627123979   0.906486892003 AA    2.347879088913  -5.666584014013   1.713011961393 Bohr   0.0
[INPUT] 56 H      2.748417069976  -3.283569631214   1.796076238705 AA    5.193755538334  -6.205047313933   3.394092189992 Bohr   0.0
[INPUT] 57 H      2.462925691263  -2.623378498356  -1.020937927256 AA    4.654255021642  -4.957466882966  -1.929293072696 Bohr   0.0
[INPUT] 58 H      4.070453027210  -2.743111635382  -0.302440488764 AA    7.692041424333  -5.183729719981  -0.571529692744 Bohr   0.0
[INPUT] 59 H      4.654483461152  -0.706804010281   0.953722280330 AA    8.795698992895  -1.335666003175   1.802273908719 Bohr   0.0
[INPUT] 60 H      3.995010759010  -1.444908513774   2.394569157312 AA    7.549476199220  -2.730481366085   4.525079893650 Bohr   0.0
[INPUT] 61 H      1.595745661349   3.122344774300   0.612925346124 AA    3.015522264412   5.900376489893   1.158261038979 Bohr   0.0
[INPUT] 62 H      1.268266278745   2.296639221816   2.149120841060 AA    2.396675919849   4.340019136167   4.061249798198 Bohr   0.0
[INPUT] 63 H      2.781622983096   3.196394953403   1.946666393171 AA    5.256505619846   6.040311047874   3.678666338988 Bohr   0.0
[INPUT] 64 H      2.475497860876   0.427344893132   2.782351735819 AA    4.678012979003   0.807564808751   5.257882762906 Bohr   0.0
[INPUT] 65 H      4.087550322115   1.097821254353   2.522899839470 AA    7.724350629175   2.074581504453   4.767589736307 Bohr   0.0
[INPUT] 66 H      4.664088987134   1.162486025694   0.127999944204 AA    8.813850806284   2.196780212196   0.241884838506 Bohr   0.0
[INPUT] 67 H      4.018270348659   2.784982765107   0.048897947876 AA    7.593430453426   5.262854687686   0.092403729539 Bohr   0.0
[INPUT] 68 H      1.579190777942  -1.022462211351  -3.008174776091 AA    2.984238068749  -1.932173552171  -5.684626461637 Bohr   0.0
[INPUT] 69 H      1.258846809902   0.722280589083  -3.054368428040 AA    2.378875703496   1.364912498456  -5.771919812514 Bohr   0.0
[INPUT] 70 H      2.766412766351   0.092136366151  -3.741758682492 AA    5.227762475903   0.174112498139  -7.070899134123 Bohr   0.0
[INPUT] 71 H      2.487018451282   2.196987993017  -1.761089326371 AA    4.699783739662   4.151705605760  -3.327976507735 Bohr   0.0
[INPUT] 72 H      4.092809443575   1.623589200858  -2.217219857410 AA    7.734288928390   3.068138928423  -4.189938288451 Bohr   0.0
[INPUT] 73 H      4.656454410628  -0.487341372317  -1.079913215498 AA    8.799423547609  -0.920941722850  -2.040740215589 Bohr   0.0
[INPUT] 74 H      3.996647919157  -1.361686564865  -2.442267685085 AA    7.552569983520  -2.573214675095  -4.615217047687 Bohr   0.0

nuclear repulsion = 4971.98175241531
number of shells = 297
number of NR pGTOs = 1150
number of NR cGTOs = 609
basis = {'default': 'def2tzvp', 'C': '6-31G*', 'H': '6-31G*', 'N': '6-31G*'}
ecp = {}
CPU time:         6.44


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = chk
damping factor = 0
level_shift factor = 0.0
DIIS = <class 'liblan.utils.rdiis.tag_rdiis_.<locals>.RDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = Cr2O4_rohf.chk
max_memory 200000 MB (current use 142 MB)
num. doubly occ = 129  num. singly occ = 6


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -3356.40543035252
  HOMO = -0.503477689949118  LUMO = -0.187926384649986
cycle= 1 E= -3356.40543035252  delta_E= 3.64e-12  |g|= 5.57e-06  |ddm|= 1.29e-05
  HOMO = -0.503478743133949  LUMO = -0.187926419757097
Extra cycle  E= -3356.40543035251  delta_E= 7.28e-12  |g|= 7.18e-06  |ddm|= 1.68e-05
converged SCF energy = -3356.40543035251
nao =  609
nelec =  (135, 129)
imp_inds.shape (183,)
nimp =  183
act_inds =  [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 474, 475, 476, 477, 478, 479, 480, 481, 482, 483, 484, 485, 486, 487, 488, 489, 490, 491, 492, 493, 494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 530, 531, 532, 533, 534, 535, 536, 537, 538, 539, 540, 541, 542, 543, 544, 545, 546, 547, 548, 549, 550, 551, 552, 553, 554, 555, 556, 557, 558, 559, 560, 561, 562, 563, 564, 565, 566, 567, 568, 569, 570, 571, 572, 573, 574, 575, 576, 577, 578, 579, 580, 581, 582, 583, 584, 585, 586, 587, 588, 589, 590, 591, 592, 593, 594, 595, 596, 597, 598, 599, 600, 601, 602, 603, 604, 605, 606, 607, 608]
nao =  318
nelec =  (135, 129)


******** <class 'pyscf.x2c.sfx2c1e.sfX2C1eROHF'> ********
method = sfX2C1eROHF
initial guess = 1e
damping factor = 0
level_shift factor = 0.2
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
diis_damp = 0
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 1000
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /tmp/tmp4o8au67g
max_memory 200000 MB (current use 169497 MB)
num. doubly occ = 129  num. singly occ = 6


******** <class 'pyscf.x2c.sfx2c1e.SpinFreeX2CHelper'> ********
approx = 1e
xuncontract = 1
Set gradient conv threshold to 3.16228e-05
init E= -8025.93339630677

WARN: HOMO 0.485435307017484 >= LUMO 0.419195824864542

cycle= 1 E= -8303.98023378065  delta_E= -278  |g|= 6.49  |ddm|= 16.2

WARN: HOMO -0.790005020318322 >= LUMO -0.857703744947139

cycle= 2 E= -8091.85369611137  delta_E=  212  |g|= 30.1  |ddm|= 10.5

WARN: HOMO -0.558442238508205 >= LUMO -0.663467948498218

cycle= 3 E= -8225.22150259879  delta_E= -133  |g|= 21.2  |ddm|= 5.41

WARN: HOMO -0.558628152664002 >= LUMO -0.69141188065981

cycle= 4 E= -8273.38993000344  delta_E= -48.2  |g|= 15.5  |ddm|= 4.27

WARN: HOMO -0.540017698200921 >= LUMO -0.664715828332479

cycle= 5 E= -8294.90519064048  delta_E= -21.5  |g|= 11.8  |ddm|= 2.96
  HOMO = -0.557954304712018  LUMO = -0.485174328053475
cycle= 6 E= -8312.18364835479  delta_E= -17.3  |g|= 8.29  |ddm|=  2.5
  HOMO = -0.562708835526543  LUMO = -0.203795216086096
cycle= 7 E= -8323.58872353495  delta_E= -11.4  |g|= 3.74  |ddm|= 2.54

WARN: HOMO 0.0770841277703262 >= LUMO -0.293144928800968

cycle= 8 E= -8321.1183720653  delta_E= 2.47  |g|= 4.07  |ddm|= 3.73

WARN: HOMO -0.0927620501193285 >= LUMO -0.550849104449331

cycle= 9 E= -8325.99432795096  delta_E= -4.88  |g|= 2.59  |ddm|= 3.69

WARN: HOMO 0.133060489023301 >= LUMO -0.406049128880588

cycle= 10 E= -8325.05514488758  delta_E= 0.939  |g|= 2.71  |ddm|= 2.96

WARN: HOMO -0.169911600133333 >= LUMO -0.459475875675704

cycle= 11 E= -8326.15598807661  delta_E= -1.1  |g|= 2.34  |ddm|= 3.15

WARN: HOMO 0.0922068587213422 >= LUMO -0.408162948792132

cycle= 12 E= -8324.84264997162  delta_E= 1.31  |g|=  2.7  |ddm|= 3.15

WARN: HOMO -0.156422079751294 >= LUMO -0.461410617355153

cycle= 13 E= -8326.3394537517  delta_E= -1.5  |g|= 2.18  |ddm|= 3.13

WARN: HOMO -0.0805277868145531 >= LUMO -0.388824129278797

cycle= 14 E= -8326.29016636946  delta_E= 0.0493  |g|= 2.16  |ddm|=  2.8

WARN: HOMO 0.107768968895125 >= LUMO -0.342420755425381

cycle= 15 E= -8324.6591084926  delta_E= 1.63  |g|= 2.77  |ddm|= 3.15

WARN: HOMO 0.00715961658628281 >= LUMO -0.422461146090691

cycle= 16 E= -8324.80216282511  delta_E= -0.143  |g|= 2.66  |ddm|= 3.12

WARN: HOMO 0.00250746001865564 >= LUMO -0.298923036057531

cycle= 17 E= -8324.69144373698  delta_E= 0.111  |g|=  2.8  |ddm|= 3.12

WARN: HOMO -0.00518354673674899 >= LUMO -0.422634989322007

cycle= 18 E= -8325.0217839069  delta_E= -0.33  |g|= 2.58  |ddm|= 3.11

WARN: HOMO -0.103939471383907 >= LUMO -0.335361992742644

cycle= 19 E= -8326.33709693026  delta_E= -1.32  |g|= 2.09  |ddm|= 3.06

WARN: HOMO -0.0735531261931245 >= LUMO -0.413946302980299

cycle= 20 E= -8326.44166473333  delta_E= -0.105  |g|= 2.05  |ddm|= 2.81

WARN: HOMO -0.0804320454180911 >= LUMO -0.243776035823892

cycle= 21 E= -8326.37999823527  delta_E= 0.0617  |g|= 2.11  |ddm|= 2.79

WARN: HOMO -0.0811848856942307 >= LUMO -0.324706899316052

cycle= 22 E= -8327.14859384185  delta_E= -0.769  |g|= 1.52  |ddm|= 2.61

WARN: HOMO -0.0551467038420272 >= LUMO -0.292424933367095

cycle= 23 E= -8327.09243825748  delta_E= 0.0562  |g|= 1.68  |ddm|= 2.37

WARN: HOMO -0.091979006418947 >= LUMO -0.310748322347488

cycle= 24 E= -8327.25752247947  delta_E= -0.165  |g|= 1.46  |ddm|= 2.39

WARN: HOMO -0.060624012193561 >= LUMO -0.299816713639775

cycle= 25 E= -8327.56917280921  delta_E= -0.312  |g|= 0.945  |ddm|= 2.28

WARN: HOMO -0.177774786698385 >= LUMO -0.337295276762441

cycle= 26 E= -8327.77087049335  delta_E= -0.202  |g|= 0.933  |ddm|= 1.89

WARN: HOMO -0.135158257613534 >= LUMO -0.331875226911743

cycle= 27 E= -8327.75935487975  delta_E= 0.0115  |g|= 1.11  |ddm|=    2

WARN: HOMO -0.0360999918963129 >= LUMO -0.380626811776886

cycle= 28 E= -8326.60459956234  delta_E= 1.15  |g|= 1.95  |ddm|= 2.41

WARN: HOMO 0.000392056069390336 >= LUMO -0.355172429441993

cycle= 29 E= -8326.7585955069  delta_E= -0.154  |g|= 1.87  |ddm|= 2.72

WARN: HOMO -0.0364306910134108 >= LUMO -0.381345177696252

cycle= 30 E= -8326.99620264661  delta_E= -0.238  |g|= 1.65  |ddm|= 2.58

WARN: HOMO 0.00519788296175186 >= LUMO -0.364485891320564

cycle= 31 E= -8327.115627463  delta_E= -0.119  |g|= 1.58  |ddm|= 2.48

WARN: HOMO -0.0261918248145778 >= LUMO -0.363630413914183

cycle= 32 E= -8327.17930706315  delta_E= -0.0637  |g|= 1.47  |ddm|= 2.48

WARN: HOMO 0.0201120532442081 >= LUMO -0.35882336647198

cycle= 33 E= -8327.05654068933  delta_E= 0.123  |g|= 1.63  |ddm|= 2.54

WARN: HOMO -0.00915459051240232 >= LUMO -0.355297148331997

cycle= 34 E= -8327.26113430734  delta_E= -0.205  |g|= 1.29  |ddm|= 2.21

WARN: HOMO -0.00313612771559974 >= LUMO -0.389025594835256

cycle= 35 E= -8327.59913259218  delta_E= -0.338  |g|= 1.09  |ddm|= 2.29

WARN: HOMO -0.098283081293049 >= LUMO -0.309207176462707

cycle= 36 E= -8326.70021388752  delta_E= 0.899  |g|= 1.87  |ddm|= 2.39

WARN: HOMO -0.0651309813813617 >= LUMO -0.358226178140442

cycle= 37 E= -8326.91859149017  delta_E= -0.218  |g|= 1.72  |ddm|= 2.66

WARN: HOMO -0.0787468519736236 >= LUMO -0.319967942535953

cycle= 38 E= -8326.88948291632  delta_E= 0.0291  |g|= 1.73  |ddm|= 2.71

WARN: HOMO -0.0736017085125025 >= LUMO -0.35490752971619

cycle= 39 E= -8327.28052160494  delta_E= -0.391  |g|= 1.37  |ddm|= 2.44

WARN: HOMO -0.146776162274104 >= LUMO -0.283790186302009

cycle= 40 E= -8327.71377257256  delta_E= -0.433  |g|= 0.901  |ddm|= 2.35

WARN: HOMO -0.119797344613315 >= LUMO -0.276958326995298

cycle= 41 E= -8327.85332878704  delta_E= -0.14  |g|= 0.911  |ddm|= 1.98

WARN: HOMO -0.113869564509371 >= LUMO -0.280199574401836

cycle= 42 E= -8328.02372843879  delta_E= -0.17  |g|= 0.444  |ddm|= 1.48
  HOMO = -0.238783450853536  LUMO = -0.121517036474653
cycle= 43 E= -8328.09386558887  delta_E= -0.0701  |g|= 0.282  |ddm|= 0.289
  HOMO = -0.288074167828752  LUMO = -0.0723283488472442
cycle= 44 E= -8328.18534530348  delta_E= -0.0915  |g|= 0.119  |ddm|= 0.569
  HOMO = -0.304363353051537  LUMO = -0.0570470344652466
cycle= 45 E= -8328.19847144847  delta_E= -0.0131  |g|= 0.107  |ddm|= 0.188
  HOMO = -0.313451939135869  LUMO = -0.0515549291017999
cycle= 46 E= -8328.21007354523  delta_E= -0.0116  |g|= 0.0989  |ddm|= 0.184
  HOMO = -0.325430546957011  LUMO = -0.0384136616921038
cycle= 47 E= -8328.23035830192  delta_E= -0.0203  |g|= 0.0908  |ddm|= 0.227
  HOMO = -0.331146765325428  LUMO = -0.0320559367199542
cycle= 48 E= -8328.24873795656  delta_E= -0.0184  |g|= 0.0894  |ddm|= 0.195
  HOMO = -0.336476118520273  LUMO = -0.0262988315444306
cycle= 49 E= -8328.25020684719  delta_E= -0.00147  |g|= 0.0905  |ddm|= 0.0339
  HOMO = -0.350044887774418  LUMO = -0.0098761264639302
cycle= 50 E= -8328.24488921058  delta_E= 0.00532  |g|= 0.0854  |ddm|= 0.13
  HOMO = -0.356403250484275  LUMO = -0.012644070662079
cycle= 51 E= -8328.22608384829  delta_E= 0.0188  |g|= 0.0812  |ddm|= 0.261
  HOMO = -0.357021554785757  LUMO = -0.00148056620850001
cycle= 52 E= -8328.21605875619  delta_E= 0.01  |g|= 0.0725  |ddm|= 0.201
  HOMO = -0.358964074161854  LUMO = -0.0048630159612474
cycle= 53 E= -8328.21658167866  delta_E= -0.000523  |g|= 0.0659  |ddm|= 0.103
  HOMO = -0.340006158763067  LUMO = -0.016620962741015
cycle= 54 E= -8328.22260989375  delta_E= -0.00603  |g|= 0.0552  |ddm|= 0.206
  HOMO = -0.345713456785567  LUMO = -0.0133582886789079
cycle= 55 E= -8328.22778466103  delta_E= -0.00517  |g|= 0.056  |ddm|= 0.112
  HOMO = -0.353413092700558  LUMO = -0.00870516024257134
cycle= 56 E= -8328.22451276639  delta_E= 0.00327  |g|= 0.0598  |ddm|= 0.0553
  HOMO = -0.357057705971882  LUMO = -0.00617106515937934
cycle= 57 E= -8328.22877650577  delta_E= -0.00426  |g|= 0.0591  |ddm|= 0.0729
  HOMO = -0.361794956465969  LUMO = -0.00296249287519508
cycle= 58 E= -8328.23391604891  delta_E= -0.00514  |g|= 0.0599  |ddm|= 0.0827
  HOMO = -0.357937590514996  LUMO = -0.00604039246513728
cycle= 59 E= -8328.2363133998  delta_E= -0.0024  |g|= 0.0609  |ddm|= 0.0391
  HOMO = -0.343491711773535  LUMO = -0.0122730256088339
cycle= 60 E= -8328.23648180165  delta_E= -0.000168  |g|= 0.0598  |ddm|= 0.0332
  HOMO = -0.34452150036423  LUMO = -0.0148214836611468
cycle= 61 E= -8328.23631187041  delta_E= 0.00017  |g|= 0.0593  |ddm|= 0.0248
  HOMO = -0.346750949856719  LUMO = -0.0112520062804398
cycle= 62 E= -8328.23247637474  delta_E= 0.00384  |g|= 0.0594  |ddm|= 0.0869
  HOMO = -0.343309660025442  LUMO = -0.0142757190868982
cycle= 63 E= -8328.23338931576  delta_E= -0.000913  |g|= 0.057  |ddm|= 0.0325
  HOMO = -0.345336456416879  LUMO = -0.0116100750650708
cycle= 64 E= -8328.22656664942  delta_E= 0.00682  |g|= 0.0567  |ddm|= 0.204
  HOMO = -0.348487049314097  LUMO = -0.0102399260879785
cycle= 65 E= -8328.22353915938  delta_E= 0.00303  |g|= 0.0518  |ddm|= 0.141
  HOMO = -0.350082523381007  LUMO = -0.00843381561583767
cycle= 66 E= -8328.22401343622  delta_E= -0.000474  |g|= 0.0476  |ddm|= 0.105
  HOMO = -0.353001024782449  LUMO = -0.00751253159456971
cycle= 67 E= -8328.22619239183  delta_E= -0.00218  |g|= 0.0476  |ddm|= 0.161
  HOMO = -0.352241254532167  LUMO = -0.00757388260981804
cycle= 68 E= -8328.22849428441  delta_E= -0.0023  |g|= 0.0481  |ddm|= 0.0667
  HOMO = -0.356355307450421  LUMO = -0.00493091835060718
cycle= 69 E= -8328.22894671526  delta_E= -0.000452  |g|= 0.0492  |ddm|= 0.0317
  HOMO = -0.355027584766172  LUMO = -0.00390040763680511
cycle= 70 E= -8328.23172352591  delta_E= -0.00278  |g|= 0.0515  |ddm|= 0.0666
  HOMO = -0.35567899642978  LUMO = -0.00348737581104018
cycle= 71 E= -8328.23283095853  delta_E= -0.00111  |g|= 0.0534  |ddm|= 0.0241
  HOMO = -0.35013033512286  LUMO = -0.010154005574075
cycle= 72 E= -8328.22616262393  delta_E= 0.00667  |g|= 0.0486  |ddm|= 0.163
  HOMO = -0.356241353694283  LUMO = -0.00847150858098565
cycle= 73 E= -8328.21994286649  delta_E= 0.00622  |g|= 0.045  |ddm|= 0.21
  HOMO = -0.353460908026168  LUMO = -0.0115806180275475
cycle= 74 E= -8328.21805280677  delta_E= 0.00189  |g|= 0.0399  |ddm|= 0.132
  HOMO = -0.346048013205018  LUMO = -0.0193943029207455
cycle= 75 E= -8328.21841690202  delta_E= -0.000364  |g|= 0.0252  |ddm|= 0.0694
  HOMO = -0.349836038507275  LUMO = -0.0179453698165324
cycle= 76 E= -8328.21870106084  delta_E= -0.000284  |g|= 0.0194  |ddm|= 0.129
  HOMO = -0.350210162714404  LUMO = -0.0169630996922616
cycle= 77 E= -8328.2195343096  delta_E= -0.000833  |g|= 0.0176  |ddm|=  0.1
  HOMO = -0.350320912047424  LUMO = -0.0194601245457504
cycle= 78 E= -8328.22060888929  delta_E= -0.00107  |g|= 0.0164  |ddm|= 0.0653
  HOMO = -0.349556384809814  LUMO = -0.0200287844459183
cycle= 79 E= -8328.22089584706  delta_E= -0.000287  |g|= 0.0177  |ddm|= 0.0215
  HOMO = -0.35117084094614  LUMO = -0.0182902096073958
cycle= 80 E= -8328.22123290985  delta_E= -0.000337  |g|= 0.0186  |ddm|= 0.0185
  HOMO = -0.351222132986775  LUMO = -0.0187619153240003
cycle= 81 E= -8328.22146656334  delta_E= -0.000234  |g|= 0.019  |ddm|= 0.0135
  HOMO = -0.349582781900055  LUMO = -0.0195817638905881
cycle= 82 E= -8328.22053249107  delta_E= 0.000934  |g|= 0.0194  |ddm|= 0.052
  HOMO = -0.350013915715339  LUMO = -0.0192480772436386
cycle= 83 E= -8328.21990560054  delta_E= 0.000627  |g|= 0.0183  |ddm|= 0.0415
  HOMO = -0.350177341379702  LUMO = -0.0189970459777647
cycle= 84 E= -8328.21980369859  delta_E= 0.000102  |g|= 0.0168  |ddm|= 0.0128
  HOMO = -0.349181585138397  LUMO = -0.0199483282656414
cycle= 85 E= -8328.21967308972  delta_E= 0.000131  |g|= 0.0154  |ddm|= 0.0396
  HOMO = -0.350056624162074  LUMO = -0.0196118856023529
cycle= 86 E= -8328.21955705251  delta_E= 0.000116  |g|= 0.0143  |ddm|= 0.0392
  HOMO = -0.350072072145155  LUMO = -0.0194894978425319
cycle= 87 E= -8328.2197671989  delta_E= -0.00021  |g|= 0.0126  |ddm|= 0.0421
  HOMO = -0.350453414899681  LUMO = -0.0213035071546154
cycle= 88 E= -8328.22044369322  delta_E= -0.000676  |g|= 0.0104  |ddm|= 0.0613
  HOMO = -0.351337494759008  LUMO = -0.020839416575822
cycle= 89 E= -8328.22078824402  delta_E= -0.000345  |g|= 0.00877  |ddm|= 0.0553
  HOMO = -0.352436470062283  LUMO = -0.0207732777209122
cycle= 90 E= -8328.22116545591  delta_E= -0.000377  |g|= 0.00676  |ddm|= 0.0609
  HOMO = -0.353267554551605  LUMO = -0.0207853021609475
cycle= 91 E= -8328.22159361551  delta_E= -0.000428  |g|= 0.00512  |ddm|= 0.0765
  HOMO = -0.352763113664294  LUMO = -0.021414046455089
cycle= 92 E= -8328.22172961303  delta_E= -0.000136  |g|= 0.00435  |ddm|= 0.0265
  HOMO = -0.352801238199914  LUMO = -0.0217481077316358
cycle= 93 E= -8328.2218511751  delta_E= -0.000122  |g|= 0.0041  |ddm|= 0.0256
  HOMO = -0.352616040651311  LUMO = -0.0218294431959601
cycle= 94 E= -8328.22190307238  delta_E= -5.19e-05  |g|= 0.00408  |ddm|= 0.0124
  HOMO = -0.352857784550359  LUMO = -0.0220990922884815
cycle= 95 E= -8328.22197884856  delta_E= -7.58e-05  |g|= 0.00371  |ddm|= 0.0214
  HOMO = -0.352923434331846  LUMO = -0.0220575404246984
cycle= 96 E= -8328.22202731903  delta_E= -4.85e-05  |g|= 0.00394  |ddm|= 0.0137
  HOMO = -0.352895267384409  LUMO = -0.0220954938608731
cycle= 97 E= -8328.22202577998  delta_E= 1.54e-06  |g|= 0.00425  |ddm|= 0.0018
  HOMO = -0.352930614394656  LUMO = -0.0220556824345116
cycle= 98 E= -8328.22203275971  delta_E= -6.98e-06  |g|= 0.00428  |ddm|= 0.0017
  HOMO = -0.352919535503723  LUMO = -0.0220572418344439
cycle= 99 E= -8328.22202484549  delta_E= 7.91e-06  |g|= 0.00428  |ddm|= 0.00299
  HOMO = -0.352791992832658  LUMO = -0.0220007821854834
cycle= 100 E= -8328.2219981389  delta_E= 2.67e-05  |g|= 0.00426  |ddm|= 0.00723
  HOMO = -0.352835229667843  LUMO = -0.0220446685183695
cycle= 101 E= -8328.2220086951  delta_E= -1.06e-05  |g|= 0.00349  |ddm|= 0.0142
  HOMO = -0.352904868084298  LUMO = -0.0222062824543849
cycle= 102 E= -8328.22204222608  delta_E= -3.35e-05  |g|= 0.00295  |ddm|= 0.0161
  HOMO = -0.352766723648396  LUMO = -0.022318473657642
cycle= 103 E= -8328.22207922971  delta_E= -3.7e-05  |g|= 0.00265  |ddm|= 0.0142
  HOMO = -0.35293182422766  LUMO = -0.0224898163067474
cycle= 104 E= -8328.22211749354  delta_E= -3.83e-05  |g|= 0.00252  |ddm|= 0.0139
  HOMO = -0.352885454863078  LUMO = -0.0224536987444942
cycle= 105 E= -8328.22213708427  delta_E= -1.96e-05  |g|= 0.00267  |ddm|= 0.00742
  HOMO = -0.352863761681664  LUMO = -0.0223589579428699
cycle= 106 E= -8328.22212890408  delta_E= 8.18e-06  |g|= 0.00296  |ddm|= 0.005
  HOMO = -0.352867380451082  LUMO = -0.0223639582776688
cycle= 107 E= -8328.22212290181  delta_E= 6e-06  |g|= 0.00293  |ddm|= 0.00251
  HOMO = -0.352868937817057  LUMO = -0.0223934327671888
cycle= 108 E= -8328.22212316276  delta_E= -2.61e-07  |g|= 0.00288  |ddm|= 0.00279
  HOMO = -0.352856627555276  LUMO = -0.0223858432923303
cycle= 109 E= -8328.22212158902  delta_E= 1.57e-06  |g|= 0.0029  |ddm|= 0.00151
  HOMO = -0.352859218089772  LUMO = -0.0223908276859415
cycle= 110 E= -8328.22212288828  delta_E= -1.3e-06  |g|= 0.00288  |ddm|= 0.000649
  HOMO = -0.352830460688283  LUMO = -0.0223590195195693
cycle= 111 E= -8328.22211718145  delta_E= 5.71e-06  |g|= 0.003  |ddm|= 0.00287
  HOMO = -0.352787490593793  LUMO = -0.0223518318095534
cycle= 112 E= -8328.22212291114  delta_E= -5.73e-06  |g|= 0.00289  |ddm|= 0.00229
  HOMO = -0.35291032622962  LUMO = -0.0225224188063333
cycle= 113 E= -8328.22216259064  delta_E= -3.97e-05  |g|= 0.00278  |ddm|= 0.0139
  HOMO = -0.35297119952682  LUMO = -0.0225014634345876
cycle= 114 E= -8328.22217361163  delta_E= -1.1e-05  |g|= 0.00307  |ddm|= 0.0044
  HOMO = -0.352953152549721  LUMO = -0.0225246773096142
cycle= 115 E= -8328.22216871906  delta_E= 4.89e-06  |g|= 0.00324  |ddm|= 0.00198
  HOMO = -0.352959907945526  LUMO = -0.0225191911207914
cycle= 116 E= -8328.22216810884  delta_E= 6.1e-07  |g|= 0.00324  |ddm|= 0.000861
  HOMO = -0.352920060642163  LUMO = -0.0225566826189255
cycle= 117 E= -8328.22216035157  delta_E= 7.76e-06  |g|= 0.00327  |ddm|= 0.00705
  HOMO = -0.352974712253498  LUMO = -0.0225616951762005
cycle= 118 E= -8328.22216051787  delta_E= -1.66e-07  |g|= 0.00323  |ddm|= 0.00255
  HOMO = -0.353004946872872  LUMO = -0.0225420907146551
cycle= 119 E= -8328.22216121944  delta_E= -7.02e-07  |g|= 0.00332  |ddm|= 0.00487
  HOMO = -0.353021606823351  LUMO = -0.0225564437759964
cycle= 120 E= -8328.22215777182  delta_E= 3.45e-06  |g|= 0.00332  |ddm|= 0.00156
  HOMO = -0.352845679457426  LUMO = -0.0225084221813406
cycle= 121 E= -8328.22215602161  delta_E= 1.75e-06  |g|= 0.00298  |ddm|= 0.0066
  HOMO = -0.352931973180422  LUMO = -0.0226249939020429
cycle= 122 E= -8328.22216983426  delta_E= -1.38e-05  |g|= 0.0027  |ddm|= 0.00938
  HOMO = -0.352934528057174  LUMO = -0.0227346576174771
cycle= 123 E= -8328.22220062633  delta_E= -3.08e-05  |g|= 0.00264  |ddm|= 0.0173
  HOMO = -0.352948484195988  LUMO = -0.0227221891021714
cycle= 124 E= -8328.22220377915  delta_E= -3.15e-06  |g|= 0.00275  |ddm|= 0.00294
  HOMO = -0.352909003704887  LUMO = -0.0227799361273803
cycle= 125 E= -8328.2222143007  delta_E= -1.05e-05  |g|= 0.00271  |ddm|= 0.0123
  HOMO = -0.352911525903455  LUMO = -0.0227543743186892
cycle= 126 E= -8328.22221268707  delta_E= 1.61e-06  |g|= 0.00272  |ddm|= 0.000882
  HOMO = -0.352931464463245  LUMO = -0.0226988226778794
cycle= 127 E= -8328.22220750858  delta_E= 5.18e-06  |g|= 0.00273  |ddm|= 0.00468
  HOMO = -0.352909670557206  LUMO = -0.0226521622223798
cycle= 128 E= -8328.22220280388  delta_E= 4.7e-06  |g|= 0.00312  |ddm|= 0.0149
  HOMO = -0.352816035152328  LUMO = -0.0226026355767569
cycle= 129 E= -8328.22220273543  delta_E= 6.85e-08  |g|= 0.0032  |ddm|= 0.00587
  HOMO = -0.352729756886638  LUMO = -0.022549115267903
cycle= 130 E= -8328.22220640698  delta_E= -3.67e-06  |g|= 0.0032  |ddm|= 0.00217
  HOMO = -0.352836086732305  LUMO = -0.0226525767910165
cycle= 131 E= -8328.2221985895  delta_E= 7.82e-06  |g|= 0.00298  |ddm|= 0.00782
  HOMO = -0.352757717700469  LUMO = -0.0227110260067576
cycle= 132 E= -8328.22220934643  delta_E= -1.08e-05  |g|= 0.00276  |ddm|= 0.024
  HOMO = -0.352739777554021  LUMO = -0.0227726291988303
cycle= 133 E= -8328.22220962254  delta_E= -2.76e-07  |g|= 0.00251  |ddm|= 0.0108
  HOMO = -0.352758276557719  LUMO = -0.02295845318021
cycle= 134 E= -8328.22220468471  delta_E= 4.94e-06  |g|= 0.00278  |ddm|= 0.0198
  HOMO = -0.352793189114899  LUMO = -0.0229239332846039
cycle= 135 E= -8328.22220898129  delta_E= -4.3e-06  |g|= 0.00257  |ddm|= 0.00306
  HOMO = -0.352781528607833  LUMO = -0.0229154429404619
cycle= 136 E= -8328.22221192932  delta_E= -2.95e-06  |g|= 0.00265  |ddm|= 0.00189
  HOMO = -0.352780368972848  LUMO = -0.022877810083568
cycle= 137 E= -8328.22221260803  delta_E= -6.79e-07  |g|= 0.00268  |ddm|= 0.00723
  HOMO = -0.352880329234564  LUMO = -0.0229097813913813
cycle= 138 E= -8328.2221978146  delta_E= 1.48e-05  |g|= 0.00247  |ddm|= 0.00849
  HOMO = -0.352855777186904  LUMO = -0.0229017229234126
cycle= 139 E= -8328.22219839116  delta_E= -5.77e-07  |g|= 0.00228  |ddm|= 0.00588
  HOMO = -0.352715238359058  LUMO = -0.0228463174530342
cycle= 140 E= -8328.22220827211  delta_E= -9.88e-06  |g|= 0.00244  |ddm|= 0.0129
  HOMO = -0.352719572871633  LUMO = -0.0228521663352669
cycle= 141 E= -8328.22221208371  delta_E= -3.81e-06  |g|= 0.00253  |ddm|= 0.0037
  HOMO = -0.352793562966646  LUMO = -0.0229733379647684
cycle= 142 E= -8328.22220415699  delta_E= 7.93e-06  |g|= 0.00261  |ddm|= 0.0148
  HOMO = -0.352722766561154  LUMO = -0.0229818482142183
cycle= 143 E= -8328.22218947689  delta_E= 1.47e-05  |g|= 0.00253  |ddm|= 0.0171
  HOMO = -0.352781166112239  LUMO = -0.023010690930658
cycle= 144 E= -8328.22218149908  delta_E= 7.98e-06  |g|= 0.00214  |ddm|= 0.00613
  HOMO = -0.35278470980366  LUMO = -0.0230305032031231
cycle= 145 E= -8328.22217721655  delta_E= 4.28e-06  |g|= 0.00198  |ddm|= 0.00397
  HOMO = -0.35274969474981  LUMO = -0.0230081424670667
cycle= 146 E= -8328.2221808901  delta_E= -3.67e-06  |g|= 0.00174  |ddm|= 0.00436
  HOMO = -0.352724501573957  LUMO = -0.0229462092532069
cycle= 147 E= -8328.22218243898  delta_E= -1.55e-06  |g|= 0.00159  |ddm|= 0.0051
  HOMO = -0.352783108879543  LUMO = -0.0229317201753049
cycle= 148 E= -8328.22217722562  delta_E= 5.21e-06  |g|= 0.00152  |ddm|= 0.00751
  HOMO = -0.35266134299386  LUMO = -0.0229427501969573
cycle= 149 E= -8328.2221822301  delta_E= -5e-06  |g|= 0.00133  |ddm|= 0.00459
  HOMO = -0.352723291735363  LUMO = -0.0229582564264745
cycle= 150 E= -8328.22217590279  delta_E= 6.33e-06  |g|= 0.00149  |ddm|= 0.00773
  HOMO = -0.352704117813126  LUMO = -0.0229497424858734
cycle= 151 E= -8328.2221769293  delta_E= -1.03e-06  |g|= 0.00133  |ddm|= 0.0014
  HOMO = -0.352723189654481  LUMO = -0.0229576814395489
cycle= 152 E= -8328.22218109101  delta_E= -4.16e-06  |g|= 0.0013  |ddm|= 0.00357
  HOMO = -0.352725375055184  LUMO = -0.0229506134560233
cycle= 153 E= -8328.22218296747  delta_E= -1.88e-06  |g|= 0.00134  |ddm|= 0.00204
  HOMO = -0.352728095865655  LUMO = -0.0229527150844007
cycle= 154 E= -8328.22218316095  delta_E= -1.93e-07  |g|= 0.0014  |ddm|= 0.00112
  HOMO = -0.352736510447409  LUMO = -0.0229745707943161
cycle= 155 E= -8328.22218073917  delta_E= 2.42e-06  |g|= 0.00145  |ddm|= 0.00259
  HOMO = -0.352759901838516  LUMO = -0.0230248433037922
cycle= 156 E= -8328.22218117277  delta_E= -4.34e-07  |g|= 0.00149  |ddm|= 0.00261
  HOMO = -0.352761520504921  LUMO = -0.0230302174254633
cycle= 157 E= -8328.22218122659  delta_E= -5.38e-08  |g|= 0.00153  |ddm|= 0.00139
  HOMO = -0.352758092826696  LUMO = -0.0230062963567524
cycle= 158 E= -8328.22218203132  delta_E= -8.05e-07  |g|= 0.0015  |ddm|= 0.0017
  HOMO = -0.352784590073314  LUMO = -0.0229993064837743
cycle= 159 E= -8328.22218299928  delta_E= -9.68e-07  |g|= 0.00143  |ddm|= 0.00244
  HOMO = -0.352733174224157  LUMO = -0.02290062928307
cycle= 160 E= -8328.22217379571  delta_E= 9.2e-06  |g|= 0.00131  |ddm|= 0.00757
  HOMO = -0.352830996453634  LUMO = -0.0229012548045892
cycle= 161 E= -8328.22217865288  delta_E= -4.86e-06  |g|= 0.000967  |ddm|= 0.00788
  HOMO = -0.352802776086265  LUMO = -0.022789619606593
cycle= 162 E= -8328.22217885234  delta_E= -1.99e-07  |g|= 0.000814  |ddm|= 0.00615
  HOMO = -0.35282672271795  LUMO = -0.0227764239668222
cycle= 163 E= -8328.22218028657  delta_E= -1.43e-06  |g|= 0.000729  |ddm|= 0.00401
  HOMO = -0.352821585766655  LUMO = -0.0227729217995575
cycle= 164 E= -8328.22218132792  delta_E= -1.04e-06  |g|= 0.000763  |ddm|= 0.00142
  HOMO = -0.352805018204409  LUMO = -0.0227585540792266
cycle= 165 E= -8328.22218097317  delta_E= 3.55e-07  |g|= 0.000784  |ddm|= 0.00123
  HOMO = -0.35281223547622  LUMO = -0.022775602272607
cycle= 166 E= -8328.22218128323  delta_E= -3.1e-07  |g|= 0.000727  |ddm|= 0.00125
  HOMO = -0.352822993670653  LUMO = -0.0227647410518755
cycle= 167 E= -8328.22218032209  delta_E= 9.61e-07  |g|= 0.00067  |ddm|= 0.00218
  HOMO = -0.352775344250279  LUMO = -0.0227318568684378
cycle= 168 E= -8328.22218035685  delta_E= -3.48e-08  |g|= 0.000495  |ddm|= 0.00355
  HOMO = -0.352812959864211  LUMO = -0.022753776687506
cycle= 169 E= -8328.22218101611  delta_E= -6.59e-07  |g|= 0.000347  |ddm|= 0.00363
  HOMO = -0.352780465671184  LUMO = -0.0227347812250128
cycle= 170 E= -8328.22218163775  delta_E= -6.22e-07  |g|= 0.000284  |ddm|= 0.00207
  HOMO = -0.352795244539156  LUMO = -0.0227367481754809
cycle= 171 E= -8328.22218229592  delta_E= -6.58e-07  |g|= 0.000265  |ddm|= 0.00289
  HOMO = -0.352793409280549  LUMO = -0.0227301323586599
cycle= 172 E= -8328.2221825616  delta_E= -2.66e-07  |g|= 0.000259  |ddm|= 0.00179
  HOMO = -0.352789076266513  LUMO = -0.0227377722815584
cycle= 173 E= -8328.22218247402  delta_E= 8.76e-08  |g|= 0.000293  |ddm|= 0.000917
  HOMO = -0.352785636582571  LUMO = -0.0227353315865534
cycle= 174 E= -8328.22218248284  delta_E= -8.82e-09  |g|= 0.000288  |ddm|= 0.000185
  HOMO = -0.352785746125673  LUMO = -0.022735253239038
cycle= 175 E= -8328.2221824538  delta_E= 2.9e-08  |g|= 0.000293  |ddm|= 0.000164
  HOMO = -0.35278264538819  LUMO = -0.0227337819369542
cycle= 176 E= -8328.22218247812  delta_E= -2.43e-08  |g|= 0.00029  |ddm|= 0.000211
  HOMO = -0.352791050905583  LUMO = -0.0227376121181778
cycle= 177 E= -8328.22218247969  delta_E= -1.57e-09  |g|= 0.000288  |ddm|= 0.000421
  HOMO = -0.352791231510921  LUMO = -0.0227366646888378
cycle= 178 E= -8328.22218255307  delta_E= -7.34e-08  |g|= 0.00028  |ddm|= 0.000366
  HOMO = -0.352778336201944  LUMO = -0.022728529551817
cycle= 179 E= -8328.22218273867  delta_E= -1.86e-07  |g|= 0.00029  |ddm|= 0.00064
  HOMO = -0.352775697312531  LUMO = -0.022724457100341
cycle= 180 E= -8328.22218275794  delta_E= -1.93e-08  |g|= 0.000302  |ddm|= 0.000219
  HOMO = -0.35277502918218  LUMO = -0.0227293201164547
cycle= 181 E= -8328.2221829811  delta_E= -2.23e-07  |g|= 0.000329  |ddm|= 0.000746
  HOMO = -0.352789898003977  LUMO = -0.0227286915118485
cycle= 182 E= -8328.22218277489  delta_E= 2.06e-07  |g|= 0.000336  |ddm|= 0.000707
  HOMO = -0.352785241269875  LUMO = -0.0227185920236694
cycle= 183 E= -8328.22218238426  delta_E= 3.91e-07  |g|= 0.000297  |ddm|= 0.00139
  HOMO = -0.352779180083591  LUMO = -0.0227175539654157
cycle= 184 E= -8328.22218233753  delta_E= 4.67e-08  |g|= 0.000249  |ddm|= 0.000547
  HOMO = -0.352798595656457  LUMO = -0.0227219355005132
cycle= 185 E= -8328.22218233112  delta_E= 6.41e-09  |g|= 0.000207  |ddm|= 0.000914
  HOMO = -0.352784222691067  LUMO = -0.0227125469854468
cycle= 186 E= -8328.22218234979  delta_E= -1.87e-08  |g|= 0.000193  |ddm|= 0.000974
  HOMO = -0.35278304787452  LUMO = -0.0227127086987938
cycle= 187 E= -8328.22218243967  delta_E= -8.99e-08  |g|= 0.000189  |ddm|= 0.000547
  HOMO = -0.352783275059009  LUMO = -0.0227128546534233
cycle= 188 E= -8328.22218246281  delta_E= -2.31e-08  |g|= 0.000199  |ddm|= 0.000153
  HOMO = -0.352789547534279  LUMO = -0.0227165780226273
cycle= 189 E= -8328.22218247616  delta_E= -1.34e-08  |g|= 0.000203  |ddm|= 0.000195
  HOMO = -0.352787688199028  LUMO = -0.0227212916503116
cycle= 190 E= -8328.22218254905  delta_E= -7.29e-08  |g|= 0.000209  |ddm|= 0.000444
  HOMO = -0.352791693692991  LUMO = -0.0227225992436015
cycle= 191 E= -8328.22218252833  delta_E= 2.07e-08  |g|= 0.000215  |ddm|= 0.000133
  HOMO = -0.352793015853408  LUMO = -0.0227222107478739
cycle= 192 E= -8328.22218250274  delta_E= 2.56e-08  |g|= 0.000209  |ddm|= 0.000182
  HOMO = -0.352793570106644  LUMO = -0.0227186464470368
cycle= 193 E= -8328.22218245538  delta_E= 4.74e-08  |g|= 0.00019  |ddm|= 0.000709
  HOMO = -0.352801939265961  LUMO = -0.022724346808881
cycle= 194 E= -8328.22218240541  delta_E= 5e-08  |g|= 0.000153  |ddm|= 0.000844
  HOMO = -0.352799487507526  LUMO = -0.0227246604113401
cycle= 195 E= -8328.22218240798  delta_E= -2.57e-09  |g|= 0.000125  |ddm|= 0.000389
  HOMO = -0.352807689428124  LUMO = -0.0227316457258837
cycle= 196 E= -8328.2221824322  delta_E= -2.42e-08  |g|= 9.71e-05  |ddm|= 0.000893
  HOMO = -0.352800542809636  LUMO = -0.0227255249770211
cycle= 197 E= -8328.22218247748  delta_E= -4.53e-08  |g|= 7.21e-05  |ddm|= 0.000617
  HOMO = -0.35280414231098  LUMO = -0.0227257980449561
cycle= 198 E= -8328.2221825081  delta_E= -3.06e-08  |g|= 6.31e-05  |ddm|= 0.000386
  HOMO = -0.352803563892069  LUMO = -0.0227251778924377
cycle= 199 E= -8328.2221825333  delta_E= -2.52e-08  |g|= 6.18e-05  |ddm|= 0.000325
  HOMO = -0.352803825042613  LUMO = -0.0227247421543901
cycle= 200 E= -8328.22218254892  delta_E= -1.56e-08  |g|= 6.4e-05  |ddm|= 0.000212
  HOMO = -0.352803192844398  LUMO = -0.0227248503906195
cycle= 201 E= -8328.22218254921  delta_E= -2.91e-10  |g|= 7.05e-05  |ddm|= 4.93e-05
  HOMO = -0.352801698140063  LUMO = -0.022720907168511
cycle= 202 E= -8328.22218255176  delta_E= -2.55e-09  |g|= 6.61e-05  |ddm|= 0.000217
  HOMO = -0.352802994372159  LUMO = -0.0227205417890412
cycle= 203 E= -8328.22218256002  delta_E= -8.26e-09  |g|= 5.71e-05  |ddm|= 0.000189
  HOMO = -0.35280358270008  LUMO = -0.0227170863358781
cycle= 204 E= -8328.22218256966  delta_E= -9.64e-09  |g|= 4.83e-05  |ddm|= 0.000318
  HOMO = -0.352804615466196  LUMO = -0.0227145572498887
cycle= 205 E= -8328.22218258148  delta_E= -1.18e-08  |g|= 4.1e-05  |ddm|= 0.000378
  HOMO = -0.35280449483996  LUMO = -0.022712081487308
cycle= 206 E= -8328.22218259272  delta_E= -1.12e-08  |g|= 3.8e-05  |ddm|= 0.0003
  HOMO = -0.352805237569732  LUMO = -0.0227124050148239
cycle= 207 E= -8328.22218259702  delta_E= -4.3e-09  |g|= 4.18e-05  |ddm|= 0.000101
  HOMO = -0.352805796854783  LUMO = -0.0227125686807496
cycle= 208 E= -8328.22218260132  delta_E= -4.3e-09  |g|= 4.29e-05  |ddm|= 0.000104
  HOMO = -0.352805893546133  LUMO = -0.022713617047596
cycle= 209 E= -8328.2221826023  delta_E= -9.82e-10  |g|= 4.47e-05  |ddm|= 9.02e-05
  HOMO = -0.352805922454207  LUMO = -0.022713819409809
cycle= 210 E= -8328.2221826016  delta_E= 6.97e-10  |g|= 4.58e-05  |ddm|= 2.94e-05
  HOMO = -0.352805428014276  LUMO = -0.0227135152029602
cycle= 211 E= -8328.22218259961  delta_E= 1.99e-09  |g|= 4.63e-05  |ddm|= 7.8e-05
  HOMO = -0.352805616776153  LUMO = -0.0227138969031012
cycle= 212 E= -8328.2221825989  delta_E= 7.08e-10  |g|= 4.57e-05  |ddm|= 2.8e-05
  HOMO = -0.352805142866072  LUMO = -0.0227136110769448
cycle= 213 E= -8328.22218259699  delta_E= 1.91e-09  |g|= 4.58e-05  |ddm|= 4.96e-05
  HOMO = -0.352805590195371  LUMO = -0.022712922005085
cycle= 214 E= -8328.22218259777  delta_E= -7.8e-10  |g|= 4.36e-05  |ddm|= 6.33e-05
  HOMO = -0.352804256175903  LUMO = -0.0227099112993112
cycle= 215 E= -8328.22218259682  delta_E= 9.53e-10  |g|= 4.43e-05  |ddm|= 0.00014
  HOMO = -0.352804521665514  LUMO = -0.0227100111846076
cycle= 216 E= -8328.2221825968  delta_E= 1.64e-11  |g|= 4.39e-05  |ddm|= 4.18e-05
  HOMO = -0.352804702228733  LUMO = -0.0227103244466028
cycle= 217 E= -8328.22218259782  delta_E= -1.02e-09  |g|= 4.35e-05  |ddm|= 3.54e-05
  HOMO = -0.352803251257304  LUMO = -0.0227064839674623
cycle= 218 E= -8328.22218259924  delta_E= -1.41e-09  |g|= 4.65e-05  |ddm|= 0.000151
  HOMO = -0.352803293642739  LUMO = -0.0227069661929062
cycle= 219 E= -8328.22218260056  delta_E= -1.32e-09  |g|= 4.68e-05  |ddm|= 3.07e-05
  HOMO = -0.352804146123425  LUMO = -0.0227086361594345
cycle= 220 E= -8328.22218260566  delta_E= -5.11e-09  |g|= 4.58e-05  |ddm|= 0.000132
  HOMO = -0.352804601175373  LUMO = -0.0227090899536693
cycle= 221 E= -8328.22218260818  delta_E= -2.52e-09  |g|= 4.83e-05  |ddm|= 6.28e-05
  HOMO = -0.35280427545358  LUMO = -0.0227104543338345
cycle= 222 E= -8328.22218259705  delta_E= 1.11e-08  |g|= 5.17e-05  |ddm|= 0.000257
  HOMO = -0.352804113270515  LUMO = -0.0227102784647216
cycle= 223 E= -8328.22218259265  delta_E= 4.4e-09  |g|= 4.45e-05  |ddm|= 0.00016
  HOMO = -0.35280293472063  LUMO = -0.0227094468055506
cycle= 224 E= -8328.22218259477  delta_E= -2.12e-09  |g|= 3.71e-05  |ddm|= 9.63e-05
  HOMO = -0.352803810212245  LUMO = -0.0227108441813457
cycle= 225 E= -8328.2221825984  delta_E= -3.63e-09  |g|= 3.34e-05  |ddm|= 0.000112
  HOMO = -0.352803452904853  LUMO = -0.0227105865255544
cycle= 226 E= -8328.22218260407  delta_E= -5.67e-09  |g|= 3.3e-05  |ddm|= 0.000177
  HOMO = -0.352803757056445  LUMO = -0.0227106585987695
cycle= 227 E= -8328.22218260675  delta_E= -2.68e-09  |g|= 3.52e-05  |ddm|= 9.08e-05
  HOMO = -0.352803428065178  LUMO = -0.022711638942972
cycle= 228 E= -8328.22218260511  delta_E= 1.63e-09  |g|= 3.77e-05  |ddm|= 9.57e-05
  HOMO = -0.352803515575318  LUMO = -0.02271236102097
cycle= 229 E= -8328.22218260476  delta_E= 3.49e-10  |g|= 3.63e-05  |ddm|= 5.65e-05
  HOMO = -0.352803807320406  LUMO = -0.0227127394284855
cycle= 230 E= -8328.22218260465  delta_E= 1.16e-10  |g|= 3.57e-05  |ddm|= 4.96e-05
  HOMO = -0.352803542533231  LUMO = -0.0227124954370539
cycle= 231 E= -8328.22218260384  delta_E= 8.11e-10  |g|= 3.58e-05  |ddm|= 2.49e-05
  HOMO = -0.352802757234603  LUMO = -0.0227143711218956
cycle= 232 E= -8328.2221826053  delta_E= -1.47e-09  |g|= 3.26e-05  |ddm|= 0.000145
  HOMO = -0.352803780989209  LUMO = -0.022714384317607
cycle= 233 E= -8328.22218260401  delta_E= 1.3e-09  |g|= 3.48e-05  |ddm|= 7.06e-05
  HOMO = -0.352803158730298  LUMO = -0.0227162560193334
cycle= 234 E= -8328.22218260632  delta_E= -2.31e-09  |g|= 3.19e-05  |ddm|= 0.000133
  HOMO = -0.352802825435921  LUMO = -0.0227174348032265
cycle= 235 E= -8328.22218261056  delta_E= -4.24e-09  |g|= 3.25e-05  |ddm|= 0.00016
  HOMO = -0.352803139967267  LUMO = -0.0227193432016691
cycle= 236 E= -8328.22218261015  delta_E= 4.11e-10  |g|= 3.65e-05  |ddm|= 0.000122
  HOMO = -0.352803398891223  LUMO = -0.0227173529071566
cycle= 237 E= -8328.2221826086  delta_E= 1.55e-09  |g|= 3.65e-05  |ddm|= 8.77e-05
  HOMO = -0.352803861798736  LUMO = -0.0227160479294578
cycle= 238 E= -8328.22218260929  delta_E= -6.89e-10  |g|= 3.67e-05  |ddm|= 0.000128
  HOMO = -0.352802787690029  LUMO = -0.0227135005087588
cycle= 239 E= -8328.22218260991  delta_E= -6.22e-10  |g|= 3.68e-05  |ddm|= 0.000124
  HOMO = -0.352803187413876  LUMO = -0.0227164056043694
cycle= 240 E= -8328.22218261121  delta_E= -1.31e-09  |g|= 3.77e-05  |ddm|= 0.000192
  HOMO = -0.352803067829148  LUMO = -0.0227167688997728
cycle= 241 E= -8328.22218261126  delta_E= -4.55e-11  |g|= 3.85e-05  |ddm|= 7.01e-05
  HOMO = -0.352802647760682  LUMO = -0.0227149603513032
cycle= 242 E= -8328.22218260977  delta_E= 1.49e-09  |g|= 3.8e-05  |ddm|= 8.32e-05
  HOMO = -0.352802564769703  LUMO = -0.0227135873116848
cycle= 243 E= -8328.22218260776  delta_E= 2.01e-09  |g|= 3.49e-05  |ddm|= 0.000105
  HOMO = -0.352802198047937  LUMO = -0.0227124079308831
cycle= 244 E= -8328.22218260492  delta_E= 2.84e-09  |g|= 2.66e-05  |ddm|= 0.00026
  HOMO = -0.352802661468627  LUMO = -0.0227133653749337
cycle= 245 E= -8328.22218260602  delta_E= -1.1e-09  |g|= 1.73e-05  |ddm|= 0.000137
  HOMO = -0.352802329207627  LUMO = -0.0227147253796917
cycle= 246 E= -8328.22218260767  delta_E= -1.66e-09  |g|= 1.34e-05  |ddm|= 0.000115
  HOMO = -0.352802970368043  LUMO = -0.0227159969155761
cycle= 247 E= -8328.22218260822  delta_E= -5.44e-10  |g|= 1.35e-05  |ddm|= 7.52e-05
  HOMO = -0.452802129918558  LUMO = -0.222715517560575
Extra cycle  E= -8328.2221826089  delta_E= -6.86e-10  |g|= 1.48e-05  |ddm|= 4.62e-05
converged SCF energy = -8328.2221826089
mo_cas.shape =  (609, 19)
sodm1.shape =  (609, 609)
xdmao.shape =  (1150, 1150)
Initializing 4c-HF with Gaunt with gauge for H atom.
Maximum memory cost (2e part) in SCF and amfi calculation: 4.57764e-05 GB.
1e-integrals time (CPU/WALL): 0.00/0.00 seconds.
2e-Coulomb-integrals time (CPU/WALL): 2.22/0.07 seconds.
2e-Gaunt-integrals time (CPU/WALL): 0.85/0.03 seconds.
2e-gauge-integrals time (CPU/WALL): 1.53/0.06 seconds.

Start Dirac Hartree-Fock iterations...
with SCF convergence = 1e-09

Special treatment for fractional occupation of H atom.

SCF converges after 1 iterations.

Final DHF energy is -0.340081496312782 hartree.
DHF iterations time (CPU/WALL): 0.20/0.01 seconds.
2e-SO Coulomb integrals time (CPU/WALL): 0.22/0.01 seconds.
Initializing 4c-HF with Gaunt with gauge for CR atom.
Maximum memory cost (2e part) in SCF and amfi calculation: 0.0711967349052429 GB.
1e-integrals time (CPU/WALL): 0.00/0.00 seconds.
2e-Coulomb-integrals time (CPU/WALL): 2.94/0.10 seconds.
2e-Gaunt-integrals time (CPU/WALL): 2.43/0.08 seconds.
2e-gauge-integrals time (CPU/WALL): 6.21/0.20 seconds.

Start Dirac Hartree-Fock iterations...
with SCF convergence = 1e-09


SCF converges after 21 iterations.

Final DHF energy is -1048.37272881635 hartree.
DHF iterations time (CPU/WALL): 40.13/1.43 seconds.
2e-SO Coulomb integrals time (CPU/WALL): 4.82/0.15 seconds.
Initializing 4c-HF with Gaunt with gauge for C atom.
Maximum memory cost (2e part) in SCF and amfi calculation: 0.00321078300476074 GB.
1e-integrals time (CPU/WALL): 0.00/0.00 seconds.
2e-Coulomb-integrals time (CPU/WALL): 0.09/0.01 seconds.
2e-Gaunt-integrals time (CPU/WALL): 0.38/0.01 seconds.
2e-gauge-integrals time (CPU/WALL): 0.90/0.03 seconds.

Start Dirac Hartree-Fock iterations...
with SCF convergence = 1e-09


SCF converges after 10 iterations.

Final DHF energy is -37.3324964757747 hartree.
DHF iterations time (CPU/WALL): 1.41/0.05 seconds.
2e-SO Coulomb integrals time (CPU/WALL): 0.26/0.01 seconds.
Initializing 4c-HF with Gaunt with gauge for N atom.
Maximum memory cost (2e part) in SCF and amfi calculation: 0.00321078300476074 GB.
1e-integrals time (CPU/WALL): 0.00/0.00 seconds.
2e-Coulomb-integrals time (CPU/WALL): 0.11/0.01 seconds.
2e-Gaunt-integrals time (CPU/WALL): 0.38/0.01 seconds.
2e-gauge-integrals time (CPU/WALL): 0.90/0.03 seconds.

Start Dirac Hartree-Fock iterations...
with SCF convergence = 1e-09


SCF converges after 10 iterations.

Final DHF energy is -53.8528938424878 hartree.
DHF iterations time (CPU/WALL): 1.54/0.05 seconds.
2e-SO Coulomb integrals time (CPU/WALL): 0.26/0.01 seconds.
Initializing 4c-HF with Gaunt with gauge for O atom.
Maximum memory cost (2e part) in SCF and amfi calculation: 0.00736874341964722 GB.
1e-integrals time (CPU/WALL): 0.00/0.00 seconds.
2e-Coulomb-integrals time (CPU/WALL): 0.48/0.02 seconds.
2e-Gaunt-integrals time (CPU/WALL): 0.64/0.02 seconds.
2e-gauge-integrals time (CPU/WALL): 1.79/0.06 seconds.

Start Dirac Hartree-Fock iterations...
with SCF convergence = 1e-09


SCF converges after 12 iterations.

Final DHF energy is -74.3428623370862 hartree.
DHF iterations time (CPU/WALL): 2.91/0.09 seconds.
2e-SO Coulomb integrals time (CPU/WALL): 0.38/0.01 seconds.
hso1e.shape =  (3, 609, 609)
hso2e.shape =  (3, 609, 609)
hso.shape =  (3, 19, 19)
